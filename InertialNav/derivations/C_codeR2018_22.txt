float SF[14][1];
SF[0] = dvz - dvz_b;
SF[1] = 2*SF[0]*q3 + 2*dvx*q1 + 2*dvy*q2;
SF[2] = 2*dvx*q3 - 2*SF[0]*q1 + 2*dvy*q0;
SF[3] = 2*SF[0]*q2 + 2*dvx*q0 - 2*dvy*q3;
SF[4] = day/2 - day_b/2;
SF[5] = daz/2 - daz_b/2;
SF[6] = dax/2 - dax_b/2;
SF[7] = q1/2;
SF[8] = q2/2;
SF[9] = q3/2;
SF[10] = 2*dvy*q1;
SF[11] = 2*SF[0]*q0;
SF[12] = 2*dvx*q2;
SF[13] = SF[10] + SF[11] - SF[12];
float SG[10][1];
SG[0] = q0/2;
SG[1] = sq(q3);
SG[2] = sq(q2);
SG[3] = sq(q1);
SG[4] = sq(q0);
SG[5] = 2*q2*q3;
SG[6] = 2*q1*q3;
SG[7] = 2*q1*q2;
SG[8] = q2/2;
SG[9] = 2*q0*q2;
float SQ[24][1];
SQ[0] = dvxCov*(SG[6] - SG[9])*(SG[7] + 2*q0*q3) - dvyCov*(SG[5] + 2*q0*q1)*(SG[1] - SG[2] + SG[3] - SG[4]) + dvzCov*(SG[5] - 2*q0*q1)*(SG[1] - SG[2] - SG[3] + SG[4]);
SQ[1] = dvzCov*(SG[6] + SG[9])*(SG[1] - SG[2] - SG[3] + SG[4]) - dvxCov*(SG[6] - SG[9])*(SG[1] + SG[2] - SG[3] - SG[4]) + dvyCov*(SG[5] + 2*q0*q1)*(SG[7] - 2*q0*q3);
SQ[2] = dvzCov*(SG[6] + SG[9])*(SG[5] - 2*q0*q1) - dvyCov*(SG[7] - 2*q0*q3)*(SG[1] - SG[2] + SG[3] - SG[4]) - dvxCov*(SG[7] + 2*q0*q3)*(SG[1] + SG[2] - SG[3] - SG[4]);
SQ[3] = (SG[0]*dayCov*q1)/2 - (SG[8]*daxCov*q3)/2 - (SG[0]*dazCov*q1)/2;
SQ[4] = (SG[8]*daxCov*q1)/2 - (SG[8]*dayCov*q1)/2 - (SG[0]*dazCov*q3)/2;
SQ[5] = (SG[0]*daxCov*q3)/2 - (SG[0]*dayCov*q3)/2 - (SG[8]*dazCov*q1)/2;
SQ[6] = (SG[8]*dayCov*q3)/2 - (SG[0]*daxCov*q1)/2 - (SG[8]*dazCov*q3)/2;
SQ[7] = (dazCov*q1*q3)/4 - (daxCov*q1*q3)/4 - SG[0]*SG[8]*dayCov;
SQ[8] = SG[0]*SG[8]*dazCov - SG[0]*SG[8]*daxCov - (dayCov*q1*q3)/4;
SQ[9] = sq(q1);
SQ[10] = sq(SG[0]);
SQ[11] = sq(q3);
SQ[12] = sq(SG[8]);
SQ[13] = 2*q0*q1;
SQ[14] = 2*q0*q3;
SQ[15] = SG[1] - SG[2] - SG[3] + SG[4];
SQ[16] = SG[6] - SG[9];
SQ[17] = SG[5] + SQ[13];
SQ[18] = SG[1] - SG[2] + SG[3] - SG[4];
SQ[19] = SG[5] - SQ[13];
SQ[20] = SG[7] + SQ[14];
SQ[21] = SG[1] + SG[2] - SG[3] - SG[4];
SQ[22] = SG[7] - SQ[14];
SQ[23] = SG[6] + SG[9];
float SPP[59][1];
SPP[0] = sq(q0) - sq(q1) - sq(q2) + sq(q3);
SPP[1] = 2*q0*q1 - 2*q2*q3;
SPP[2] = 2*q0*q2 + 2*q1*q3;
SPP[3] = P[3][1] + P[0][1]*SF[5] + P[1][1]*SF[4] - P[2][1]*SF[6] + P[10][1]*SF[8] - P[11][1]*SF[7] - (P[12][1]*q0)/2;
SPP[4] = P[3][0] + P[0][0]*SF[5] + P[1][0]*SF[4] - P[2][0]*SF[6] + P[10][0]*SF[8] - P[11][0]*SF[7] - (P[12][0]*q0)/2;
SPP[5] = P[3][3] + P[0][3]*SF[5] + P[1][3]*SF[4] - P[2][3]*SF[6] + P[10][3]*SF[8] - P[11][3]*SF[7] - (P[12][3]*q0)/2;
SPP[6] = P[3][2] + P[0][2]*SF[5] + P[1][2]*SF[4] - P[2][2]*SF[6] + P[10][2]*SF[8] - P[11][2]*SF[7] - (P[12][2]*q0)/2;
SPP[7] = P[2][1] + P[0][1]*SF[4] - P[1][1]*SF[5] + P[3][1]*SF[6] - P[10][1]*SF[9] + P[12][1]*SF[7] - (P[11][1]*q0)/2;
SPP[8] = P[2][0] + P[0][0]*SF[4] - P[1][0]*SF[5] + P[3][0]*SF[6] - P[10][0]*SF[9] + P[12][0]*SF[7] - (P[11][0]*q0)/2;
SPP[9] = P[2][3] + P[0][3]*SF[4] - P[1][3]*SF[5] + P[3][3]*SF[6] - P[10][3]*SF[9] + P[12][3]*SF[7] - (P[11][3]*q0)/2;
SPP[10] = P[2][2] + P[0][2]*SF[4] - P[1][2]*SF[5] + P[3][2]*SF[6] - P[10][2]*SF[9] + P[12][2]*SF[7] - (P[11][2]*q0)/2;
SPP[11] = P[1][1] + P[0][1]*SF[6] + P[2][1]*SF[5] - P[3][1]*SF[4] + P[11][1]*SF[9] - P[12][1]*SF[8] - (P[10][1]*q0)/2;
SPP[12] = P[1][0] + P[0][0]*SF[6] + P[2][0]*SF[5] - P[3][0]*SF[4] + P[11][0]*SF[9] - P[12][0]*SF[8] - (P[10][0]*q0)/2;
SPP[13] = P[1][3] + P[0][3]*SF[6] + P[2][3]*SF[5] - P[3][3]*SF[4] + P[11][3]*SF[9] - P[12][3]*SF[8] - (P[10][3]*q0)/2;
SPP[14] = P[1][2] + P[0][2]*SF[6] + P[2][2]*SF[5] - P[3][2]*SF[4] + P[11][2]*SF[9] - P[12][2]*SF[8] - (P[10][2]*q0)/2;
SPP[15] = P[0][1] - P[1][1]*SF[6] - P[2][1]*SF[4] - P[3][1]*SF[5] + P[10][1]*SF[7] + P[11][1]*SF[8] + P[12][1]*SF[9];
SPP[16] = P[0][0] - P[1][0]*SF[6] - P[2][0]*SF[4] - P[3][0]*SF[5] + P[10][0]*SF[7] + P[11][0]*SF[8] + P[12][0]*SF[9];
SPP[17] = P[0][3] - P[1][3]*SF[6] - P[2][3]*SF[4] - P[3][3]*SF[5] + P[10][3]*SF[7] + P[11][3]*SF[8] + P[12][3]*SF[9];
SPP[18] = P[0][2] - P[1][2]*SF[6] - P[2][2]*SF[4] - P[3][2]*SF[5] + P[10][2]*SF[7] + P[11][2]*SF[8] + P[12][2]*SF[9];
SPP[19] = P[3][10] + P[0][10]*SF[5] + P[1][10]*SF[4] - P[2][10]*SF[6] + P[10][10]*SF[8] - P[11][10]*SF[7] - (P[12][10]*q0)/2;
SPP[20] = P[3][12] + P[0][12]*SF[5] + P[1][12]*SF[4] - P[2][12]*SF[6] + P[10][12]*SF[8] - P[11][12]*SF[7] - (P[12][12]*q0)/2;
SPP[21] = P[3][11] + P[0][11]*SF[5] + P[1][11]*SF[4] - P[2][11]*SF[6] + P[10][11]*SF[8] - P[11][11]*SF[7] - (P[12][11]*q0)/2;
SPP[22] = P[2][10] + P[0][10]*SF[4] - P[1][10]*SF[5] + P[3][10]*SF[6] - P[10][10]*SF[9] + P[12][10]*SF[7] - (P[11][10]*q0)/2;
SPP[23] = P[2][12] + P[0][12]*SF[4] - P[1][12]*SF[5] + P[3][12]*SF[6] - P[10][12]*SF[9] + P[12][12]*SF[7] - (P[11][12]*q0)/2;
SPP[24] = P[2][11] + P[0][11]*SF[4] - P[1][11]*SF[5] + P[3][11]*SF[6] - P[10][11]*SF[9] + P[12][11]*SF[7] - (P[11][11]*q0)/2;
SPP[25] = P[1][10] + P[0][10]*SF[6] + P[2][10]*SF[5] - P[3][10]*SF[4] + P[11][10]*SF[9] - P[12][10]*SF[8] - (P[10][10]*q0)/2;
SPP[26] = P[1][12] + P[0][12]*SF[6] + P[2][12]*SF[5] - P[3][12]*SF[4] + P[11][12]*SF[9] - P[12][12]*SF[8] - (P[10][12]*q0)/2;
SPP[27] = P[1][11] + P[0][11]*SF[6] + P[2][11]*SF[5] - P[3][11]*SF[4] + P[11][11]*SF[9] - P[12][11]*SF[8] - (P[10][11]*q0)/2;
SPP[28] = P[6][1] + P[1][1]*SF[2] + P[0][1]*SF[13] - P[2][1]*SF[3] + P[3][1]*SF[1] - P[13][1]*SPP[0];
SPP[29] = P[6][0] + P[1][0]*SF[2] + P[0][0]*SF[13] - P[2][0]*SF[3] + P[3][0]*SF[1] - P[13][0]*SPP[0];
SPP[30] = P[6][3] + P[1][3]*SF[2] + P[0][3]*SF[13] - P[2][3]*SF[3] + P[3][3]*SF[1] - P[13][3]*SPP[0];
SPP[31] = P[6][2] + P[1][2]*SF[2] + P[0][2]*SF[13] - P[2][2]*SF[3] + P[3][2]*SF[1] - P[13][2]*SPP[0];
SPP[32] = P[4][1] + P[0][1]*SF[3] + P[1][1]*SF[1] - P[3][1]*SF[2] + P[2][1]*SF[13] - P[13][1]*SPP[2];
SPP[33] = P[4][0] + P[0][0]*SF[3] + P[1][0]*SF[1] - P[3][0]*SF[2] + P[2][0]*SF[13] - P[13][0]*SPP[2];
SPP[34] = P[4][3] + P[0][3]*SF[3] + P[1][3]*SF[1] - P[3][3]*SF[2] + P[2][3]*SF[13] - P[13][3]*SPP[2];
SPP[35] = P[4][2] + P[0][2]*SF[3] + P[1][2]*SF[1] - P[3][2]*SF[2] + P[2][2]*SF[13] - P[13][2]*SPP[2];
SPP[36] = P[0][10] - P[1][10]*SF[6] - P[2][10]*SF[4] - P[3][10]*SF[5] + P[10][10]*SF[7] + P[11][10]*SF[8] + P[12][10]*SF[9];
SPP[37] = P[0][12] - P[1][12]*SF[6] - P[2][12]*SF[4] - P[3][12]*SF[5] + P[10][12]*SF[7] + P[11][12]*SF[8] + P[12][12]*SF[9];
SPP[38] = P[0][11] - P[1][11]*SF[6] - P[2][11]*SF[4] - P[3][11]*SF[5] + P[10][11]*SF[7] + P[11][11]*SF[8] + P[12][11]*SF[9];
SPP[39] = P[5][1] + P[0][1]*SF[2] + P[2][1]*SF[1] - P[1][1]*SF[13] + P[3][1]*SF[3] + P[13][1]*SPP[1];
SPP[40] = P[5][0] + P[0][0]*SF[2] + P[2][0]*SF[1] - P[1][0]*SF[13] + P[3][0]*SF[3] + P[13][0]*SPP[1];
SPP[41] = P[5][3] + P[0][3]*SF[2] + P[2][3]*SF[1] - P[1][3]*SF[13] + P[3][3]*SF[3] + P[13][3]*SPP[1];
SPP[42] = P[5][2] + P[0][2]*SF[2] + P[2][2]*SF[1] - P[1][2]*SF[13] + P[3][2]*SF[3] + P[13][2]*SPP[1];
SPP[43] = P[3][13] + P[0][13]*SF[5] + P[1][13]*SF[4] - P[2][13]*SF[6] + P[10][13]*SF[8] - P[11][13]*SF[7] - (P[12][13]*q0)/2;
SPP[44] = P[2][13] + P[0][13]*SF[4] - P[1][13]*SF[5] + P[3][13]*SF[6] - P[10][13]*SF[9] + P[12][13]*SF[7] - (P[11][13]*q0)/2;
SPP[45] = P[1][13] + P[0][13]*SF[6] + P[2][13]*SF[5] - P[3][13]*SF[4] + P[11][13]*SF[9] - P[12][13]*SF[8] - (P[10][13]*q0)/2;
SPP[46] = P[6][10] + P[0][10]*SF[13] + P[1][10]*SF[2] - P[2][10]*SF[3] + P[3][10]*SF[1] - P[13][10]*SPP[0];
SPP[47] = P[6][12] + P[0][12]*SF[13] + P[1][12]*SF[2] - P[2][12]*SF[3] + P[3][12]*SF[1] - P[13][12]*SPP[0];
SPP[48] = P[6][11] + P[0][11]*SF[13] + P[1][11]*SF[2] - P[2][11]*SF[3] + P[3][11]*SF[1] - P[13][11]*SPP[0];
SPP[49] = P[4][10] + P[0][10]*SF[3] + P[1][10]*SF[1] + P[2][10]*SF[13] - P[3][10]*SF[2] - P[13][10]*SPP[2];
SPP[50] = P[4][12] + P[0][12]*SF[3] + P[1][12]*SF[1] + P[2][12]*SF[13] - P[3][12]*SF[2] - P[13][12]*SPP[2];
SPP[51] = P[4][11] + P[0][11]*SF[3] + P[1][11]*SF[1] + P[2][11]*SF[13] - P[3][11]*SF[2] - P[13][11]*SPP[2];
SPP[52] = P[0][13] - P[1][13]*SF[6] - P[2][13]*SF[4] - P[3][13]*SF[5] + P[10][13]*SF[7] + P[11][13]*SF[8] + P[12][13]*SF[9];
SPP[53] = P[5][10] + P[0][10]*SF[2] - P[1][10]*SF[13] + P[2][10]*SF[1] + P[3][10]*SF[3] + P[13][10]*SPP[1];
SPP[54] = P[5][12] + P[0][12]*SF[2] - P[1][12]*SF[13] + P[2][12]*SF[1] + P[3][12]*SF[3] + P[13][12]*SPP[1];
SPP[55] = P[5][11] + P[0][11]*SF[2] - P[1][11]*SF[13] + P[2][11]*SF[1] + P[3][11]*SF[3] + P[13][11]*SPP[1];
SPP[56] = P[6][13] + P[0][13]*SF[13] + P[1][13]*SF[2] - P[2][13]*SF[3] + P[3][13]*SF[1] - P[13][13]*SPP[0];
SPP[57] = P[4][13] + P[0][13]*SF[3] + P[1][13]*SF[1] + P[2][13]*SF[13] - P[3][13]*SF[2] - P[13][13]*SPP[2];
SPP[58] = P[5][13] + P[0][13]*SF[2] - P[1][13]*SF[13] + P[2][13]*SF[1] + P[3][13]*SF[3] + P[13][13]*SPP[1];
float nextP[22][22];
nextP[0][0] = SPP[16] - SF[6]*SPP[15] - SF[4]*SPP[18] - SF[5]*SPP[17] + SF[7]*SPP[36] + SF[8]*SPP[38] + SF[9]*SPP[37] + (SQ[9]*daxCov)/4 + SQ[12]*dayCov + (SQ[11]*dazCov)/4;
nextP[0][1] = SPP[15] + SQ[6] - SF[4]*SPP[17] + SF[6]*SPP[16] + SF[5]*SPP[18] - SF[8]*SPP[37] + SF[9]*SPP[38] - (SPP[36]*q0)/2;
nextP[1][1] = SPP[11] - SF[4]*SPP[13] + SF[6]*SPP[12] + SF[5]*SPP[14] - SF[8]*SPP[26] + SF[9]*SPP[27] + SQ[10]*daxCov + (SQ[11]*dayCov)/4 + SQ[12]*dazCov - (SPP[25]*q0)/2;
nextP[0][2] = SPP[18] + SQ[7] + SF[4]*SPP[16] - SF[5]*SPP[15] + SF[6]*SPP[17] + SF[7]*SPP[37] - SF[9]*SPP[36] - (SPP[38]*q0)/2;
nextP[1][2] = SPP[14] + SQ[5] + SF[4]*SPP[12] - SF[5]*SPP[11] + SF[6]*SPP[13] + SF[7]*SPP[26] - SF[9]*SPP[25] - (SPP[27]*q0)/2;
nextP[2][2] = SPP[10] + SF[4]*SPP[8] - SF[5]*SPP[7] + SF[6]*SPP[9] + SF[7]*SPP[23] - SF[9]*SPP[22] + (SQ[11]*daxCov)/4 + SQ[10]*dayCov + (SQ[9]*dazCov)/4 - (SPP[24]*q0)/2;
nextP[0][3] = SPP[17] + SQ[4] + SF[4]*SPP[15] + SF[5]*SPP[16] - SF[6]*SPP[18] + SF[8]*SPP[36] - SF[7]*SPP[38] - (SPP[37]*q0)/2;
nextP[1][3] = SPP[13] + SQ[8] + SF[4]*SPP[11] + SF[5]*SPP[12] - SF[6]*SPP[14] + SF[8]*SPP[25] - SF[7]*SPP[27] - (SPP[26]*q0)/2;
nextP[2][3] = SPP[9] + SQ[3] + SF[4]*SPP[7] + SF[5]*SPP[8] - SF[6]*SPP[10] + SF[8]*SPP[22] - SF[7]*SPP[24] - (SPP[23]*q0)/2;
nextP[3][3] = SPP[5] + SF[4]*SPP[3] + SF[5]*SPP[4] - SF[6]*SPP[6] + SF[8]*SPP[19] - SF[7]*SPP[21] + SQ[12]*daxCov + (SQ[9]*dayCov)/4 + SQ[10]*dazCov - (SPP[20]*q0)/2;
nextP[0][4] = P[0][4] - P[1][4]*SF[6] - P[2][4]*SF[4] - P[3][4]*SF[5] + P[10][4]*SF[7] + P[11][4]*SF[8] + P[12][4]*SF[9] + SF[1]*SPP[15] - SF[2]*SPP[17] + SF[3]*SPP[16] + SF[13]*SPP[18] - SPP[2]*SPP[52];
nextP[1][4] = P[1][4] + P[0][4]*SF[6] + P[2][4]*SF[5] - P[3][4]*SF[4] + P[11][4]*SF[9] - P[12][4]*SF[8] + SF[1]*SPP[11] - SF[2]*SPP[13] + SF[3]*SPP[12] + SF[13]*SPP[14] - SPP[2]*SPP[45] - (P[10][4]*q0)/2;
nextP[2][4] = P[2][4] + P[0][4]*SF[4] - P[1][4]*SF[5] + P[3][4]*SF[6] - P[10][4]*SF[9] + P[12][4]*SF[7] + SF[1]*SPP[7] - SF[2]*SPP[9] + SF[3]*SPP[8] + SF[13]*SPP[10] - SPP[2]*SPP[44] - (P[11][4]*q0)/2;
nextP[3][4] = P[3][4] + P[0][4]*SF[5] + P[1][4]*SF[4] - P[2][4]*SF[6] + P[10][4]*SF[8] - P[11][4]*SF[7] + SF[1]*SPP[3] - SF[2]*SPP[5] + SF[3]*SPP[4] + SF[13]*SPP[6] - SPP[2]*SPP[43] - (P[12][4]*q0)/2;
nextP[4][4] = P[4][4] + P[0][4]*SF[3] + P[1][4]*SF[1] - P[3][4]*SF[2] + P[2][4]*SF[13] - P[13][4]*SPP[2] + SF[1]*SPP[32] - SF[2]*SPP[34] + SF[3]*SPP[33] + SF[13]*SPP[35] - SPP[2]*SPP[57] + sq(SQ[21])*dvxCov + SQ[22]sq()*dvyCov + SQ[23]sq()*dvzCov;
nextP[0][5] = P[0][5] - P[1][5]*SF[6] - P[2][5]*SF[4] - P[3][5]*SF[5] + P[10][5]*SF[7] + P[11][5]*SF[8] + P[12][5]*SF[9] + SF[2]*SPP[16] + SF[1]*SPP[18] + SF[3]*SPP[17] - SF[13]*SPP[15] + SPP[1]*SPP[52];
nextP[1][5] = P[1][5] + P[0][5]*SF[6] + P[2][5]*SF[5] - P[3][5]*SF[4] + P[11][5]*SF[9] - P[12][5]*SF[8] + SF[2]*SPP[12] + SF[1]*SPP[14] + SF[3]*SPP[13] - SF[13]*SPP[11] + SPP[1]*SPP[45] - (P[10][5]*q0)/2;
nextP[2][5] = P[2][5] + P[0][5]*SF[4] - P[1][5]*SF[5] + P[3][5]*SF[6] - P[10][5]*SF[9] + P[12][5]*SF[7] + SF[2]*SPP[8] + SF[1]*SPP[10] + SF[3]*SPP[9] - SF[13]*SPP[7] + SPP[1]*SPP[44] - (P[11][5]*q0)/2;
nextP[3][5] = P[3][5] + P[0][5]*SF[5] + P[1][5]*SF[4] - P[2][5]*SF[6] + P[10][5]*SF[8] - P[11][5]*SF[7] + SF[2]*SPP[4] + SF[1]*SPP[6] + SF[3]*SPP[5] - SF[13]*SPP[3] + SPP[1]*SPP[43] - (P[12][5]*q0)/2;
nextP[4][5] = P[4][5] + SQ[2] + P[0][5]*SF[3] + P[1][5]*SF[1] - P[3][5]*SF[2] + P[2][5]*SF[13] - P[13][5]*SPP[2] + SF[2]*SPP[33] + SF[1]*SPP[35] + SF[3]*SPP[34] - SF[13]*SPP[32] + SPP[1]*SPP[57];
nextP[5][5] = P[5][5] + P[0][5]*SF[2] + P[2][5]*SF[1] - P[1][5]*SF[13] + P[3][5]*SF[3] + P[13][5]*SPP[1] + SF[2]*SPP[40] + SF[1]*SPP[42] + SF[3]*SPP[41] - SF[13]*SPP[39] + SPP[1]*SPP[58] + sq(SQ[20])*dvxCov + SQ[18]sq()*dvyCov + SQ[19]sq()*dvzCov;
nextP[0][6] = P[0][6] - P[1][6]*SF[6] - P[2][6]*SF[4] - P[3][6]*SF[5] + P[10][6]*SF[7] + P[11][6]*SF[8] + P[12][6]*SF[9] + SF[2]*SPP[15] + SF[1]*SPP[17] - SF[3]*SPP[18] + SF[13]*SPP[16] - SPP[0]*SPP[52];
nextP[1][6] = P[1][6] + P[0][6]*SF[6] + P[2][6]*SF[5] - P[3][6]*SF[4] + P[11][6]*SF[9] - P[12][6]*SF[8] + SF[2]*SPP[11] + SF[1]*SPP[13] - SF[3]*SPP[14] + SF[13]*SPP[12] - SPP[0]*SPP[45] - (P[10][6]*q0)/2;
nextP[2][6] = P[2][6] + P[0][6]*SF[4] - P[1][6]*SF[5] + P[3][6]*SF[6] - P[10][6]*SF[9] + P[12][6]*SF[7] + SF[2]*SPP[7] + SF[1]*SPP[9] - SF[3]*SPP[10] + SF[13]*SPP[8] - SPP[0]*SPP[44] - (P[11][6]*q0)/2;
nextP[3][6] = P[3][6] + P[0][6]*SF[5] + P[1][6]*SF[4] - P[2][6]*SF[6] + P[10][6]*SF[8] - P[11][6]*SF[7] + SF[2]*SPP[3] + SF[1]*SPP[5] - SF[3]*SPP[6] + SF[13]*SPP[4] - SPP[0]*SPP[43] - (P[12][6]*q0)/2;
nextP[4][6] = P[4][6] + SQ[1] + P[0][6]*SF[3] + P[1][6]*SF[1] - P[3][6]*SF[2] + P[2][6]*SF[13] - P[13][6]*SPP[2] + SF[2]*SPP[32] + SF[1]*SPP[34] - SF[3]*SPP[35] + SF[13]*SPP[33] - SPP[0]*SPP[57];
nextP[5][6] = P[5][6] + SQ[0] + P[0][6]*SF[2] + P[2][6]*SF[1] - P[1][6]*SF[13] + P[3][6]*SF[3] + P[13][6]*SPP[1] + SF[2]*SPP[39] + SF[1]*SPP[41] - SF[3]*SPP[42] + SF[13]*SPP[40] - SPP[0]*SPP[58];
nextP[6][6] = P[6][6] + P[1][6]*SF[2] + P[0][6]*SF[13] - P[2][6]*SF[3] + P[3][6]*SF[1] - P[13][6]*SPP[0] + SF[2]*SPP[28] + SF[1]*SPP[30] - SF[3]*SPP[31] + SF[13]*SPP[29] - SPP[0]*SPP[56] + sq(SQ[16])*dvxCov + SQ[17]sq()*dvyCov + SQ[15]sq()*dvzCov;
nextP[0][7] = P[0][7] - P[1][7]*SF[6] - P[2][7]*SF[4] - P[3][7]*SF[5] + P[10][7]*SF[7] + P[11][7]*SF[8] + P[12][7]*SF[9] + dt*(P[0][4] - P[1][4]*SF[6] - P[2][4]*SF[4] - P[3][4]*SF[5] + P[10][4]*SF[7] + P[11][4]*SF[8] + P[12][4]*SF[9]);
nextP[1][7] = P[1][7] + P[0][7]*SF[6] + P[2][7]*SF[5] - P[3][7]*SF[4] + P[11][7]*SF[9] - P[12][7]*SF[8] - (P[10][7]*q0)/2 + dt*(P[1][4] + P[0][4]*SF[6] + P[2][4]*SF[5] - P[3][4]*SF[4] + P[11][4]*SF[9] - P[12][4]*SF[8] - (P[10][4]*q0)/2);
nextP[2][7] = P[2][7] + P[0][7]*SF[4] - P[1][7]*SF[5] + P[3][7]*SF[6] - P[10][7]*SF[9] + P[12][7]*SF[7] - (P[11][7]*q0)/2 + dt*(P[2][4] + P[0][4]*SF[4] - P[1][4]*SF[5] + P[3][4]*SF[6] - P[10][4]*SF[9] + P[12][4]*SF[7] - (P[11][4]*q0)/2);
nextP[3][7] = P[3][7] + P[0][7]*SF[5] + P[1][7]*SF[4] - P[2][7]*SF[6] + P[10][7]*SF[8] - P[11][7]*SF[7] - (P[12][7]*q0)/2 + dt*(P[3][4] + P[0][4]*SF[5] + P[1][4]*SF[4] - P[2][4]*SF[6] + P[10][4]*SF[8] - P[11][4]*SF[7] - (P[12][4]*q0)/2);
nextP[4][7] = P[4][7] + P[0][7]*SF[3] + P[1][7]*SF[1] - P[3][7]*SF[2] + P[2][7]*SF[13] - P[13][7]*SPP[2] + dt*(P[4][4] + P[0][4]*SF[3] + P[1][4]*SF[1] - P[3][4]*SF[2] + P[2][4]*SF[13] - P[13][4]*SPP[2]);
nextP[5][7] = P[5][7] + P[0][7]*SF[2] + P[2][7]*SF[1] - P[1][7]*SF[13] + P[3][7]*SF[3] + P[13][7]*SPP[1] + dt*(P[5][4] + P[0][4]*SF[2] + P[2][4]*SF[1] - P[1][4]*SF[13] + P[3][4]*SF[3] + P[13][4]*SPP[1]);
nextP[6][7] = P[6][7] + P[1][7]*SF[2] + P[0][7]*SF[13] - P[2][7]*SF[3] + P[3][7]*SF[1] - P[13][7]*SPP[0] + dt*(P[6][4] + P[1][4]*SF[2] + P[0][4]*SF[13] - P[2][4]*SF[3] + P[3][4]*SF[1] - P[13][4]*SPP[0]);
nextP[7][7] = P[7][7] + P[4][7]*dt + dt*(P[7][4] + P[4][4]*dt);
nextP[0][8] = P[0][8] - P[1][8]*SF[6] - P[2][8]*SF[4] - P[3][8]*SF[5] + P[10][8]*SF[7] + P[11][8]*SF[8] + P[12][8]*SF[9] + dt*(P[0][5] - P[1][5]*SF[6] - P[2][5]*SF[4] - P[3][5]*SF[5] + P[10][5]*SF[7] + P[11][5]*SF[8] + P[12][5]*SF[9]);
nextP[1][8] = P[1][8] + P[0][8]*SF[6] + P[2][8]*SF[5] - P[3][8]*SF[4] + P[11][8]*SF[9] - P[12][8]*SF[8] - (P[10][8]*q0)/2 + dt*(P[1][5] + P[0][5]*SF[6] + P[2][5]*SF[5] - P[3][5]*SF[4] + P[11][5]*SF[9] - P[12][5]*SF[8] - (P[10][5]*q0)/2);
nextP[2][8] = P[2][8] + P[0][8]*SF[4] - P[1][8]*SF[5] + P[3][8]*SF[6] - P[10][8]*SF[9] + P[12][8]*SF[7] - (P[11][8]*q0)/2 + dt*(P[2][5] + P[0][5]*SF[4] - P[1][5]*SF[5] + P[3][5]*SF[6] - P[10][5]*SF[9] + P[12][5]*SF[7] - (P[11][5]*q0)/2);
nextP[3][8] = P[3][8] + P[0][8]*SF[5] + P[1][8]*SF[4] - P[2][8]*SF[6] + P[10][8]*SF[8] - P[11][8]*SF[7] - (P[12][8]*q0)/2 + dt*(P[3][5] + P[0][5]*SF[5] + P[1][5]*SF[4] - P[2][5]*SF[6] + P[10][5]*SF[8] - P[11][5]*SF[7] - (P[12][5]*q0)/2);
nextP[4][8] = P[4][8] + P[0][8]*SF[3] + P[1][8]*SF[1] - P[3][8]*SF[2] + P[2][8]*SF[13] - P[13][8]*SPP[2] + dt*(P[4][5] + P[0][5]*SF[3] + P[1][5]*SF[1] - P[3][5]*SF[2] + P[2][5]*SF[13] - P[13][5]*SPP[2]);
nextP[5][8] = P[5][8] + P[0][8]*SF[2] + P[2][8]*SF[1] - P[1][8]*SF[13] + P[3][8]*SF[3] + P[13][8]*SPP[1] + dt*(P[5][5] + P[0][5]*SF[2] + P[2][5]*SF[1] - P[1][5]*SF[13] + P[3][5]*SF[3] + P[13][5]*SPP[1]);
nextP[6][8] = P[6][8] + P[1][8]*SF[2] + P[0][8]*SF[13] - P[2][8]*SF[3] + P[3][8]*SF[1] - P[13][8]*SPP[0] + dt*(P[6][5] + P[1][5]*SF[2] + P[0][5]*SF[13] - P[2][5]*SF[3] + P[3][5]*SF[1] - P[13][5]*SPP[0]);
nextP[7][8] = P[7][8] + P[4][8]*dt + dt*(P[7][5] + P[4][5]*dt);
nextP[8][8] = P[8][8] + P[5][8]*dt + dt*(P[8][5] + P[5][5]*dt);
nextP[0][9] = P[0][9] - P[1][9]*SF[6] - P[2][9]*SF[4] - P[3][9]*SF[5] + P[10][9]*SF[7] + P[11][9]*SF[8] + P[12][9]*SF[9] + dt*(P[0][6] - P[1][6]*SF[6] - P[2][6]*SF[4] - P[3][6]*SF[5] + P[10][6]*SF[7] + P[11][6]*SF[8] + P[12][6]*SF[9]);
nextP[1][9] = P[1][9] + P[0][9]*SF[6] + P[2][9]*SF[5] - P[3][9]*SF[4] + P[11][9]*SF[9] - P[12][9]*SF[8] - (P[10][9]*q0)/2 + dt*(P[1][6] + P[0][6]*SF[6] + P[2][6]*SF[5] - P[3][6]*SF[4] + P[11][6]*SF[9] - P[12][6]*SF[8] - (P[10][6]*q0)/2);
nextP[2][9] = P[2][9] + P[0][9]*SF[4] - P[1][9]*SF[5] + P[3][9]*SF[6] - P[10][9]*SF[9] + P[12][9]*SF[7] - (P[11][9]*q0)/2 + dt*(P[2][6] + P[0][6]*SF[4] - P[1][6]*SF[5] + P[3][6]*SF[6] - P[10][6]*SF[9] + P[12][6]*SF[7] - (P[11][6]*q0)/2);
nextP[3][9] = P[3][9] + P[0][9]*SF[5] + P[1][9]*SF[4] - P[2][9]*SF[6] + P[10][9]*SF[8] - P[11][9]*SF[7] - (P[12][9]*q0)/2 + dt*(P[3][6] + P[0][6]*SF[5] + P[1][6]*SF[4] - P[2][6]*SF[6] + P[10][6]*SF[8] - P[11][6]*SF[7] - (P[12][6]*q0)/2);
nextP[4][9] = P[4][9] + P[0][9]*SF[3] + P[1][9]*SF[1] + P[2][9]*SF[13] - P[3][9]*SF[2] - P[13][9]*SPP[2] + dt*(P[4][6] + P[0][6]*SF[3] + P[1][6]*SF[1] - P[3][6]*SF[2] + P[2][6]*SF[13] - P[13][6]*SPP[2]);
nextP[5][9] = P[5][9] + P[0][9]*SF[2] - P[1][9]*SF[13] + P[2][9]*SF[1] + P[3][9]*SF[3] + P[13][9]*SPP[1] + dt*(P[5][6] + P[0][6]*SF[2] + P[2][6]*SF[1] - P[1][6]*SF[13] + P[3][6]*SF[3] + P[13][6]*SPP[1]);
nextP[6][9] = P[6][9] + P[0][9]*SF[13] + P[1][9]*SF[2] - P[2][9]*SF[3] + P[3][9]*SF[1] - P[13][9]*SPP[0] + dt*(P[6][6] + P[1][6]*SF[2] + P[0][6]*SF[13] - P[2][6]*SF[3] + P[3][6]*SF[1] - P[13][6]*SPP[0]);
nextP[7][9] = P[7][9] + P[4][9]*dt + dt*(P[7][6] + P[4][6]*dt);
nextP[8][9] = P[8][9] + P[5][9]*dt + dt*(P[8][6] + P[5][6]*dt);
nextP[9][9] = P[9][9] + P[6][9]*dt + dt*(P[9][6] + P[6][6]*dt);
nextP[0][10] = SPP[36];
nextP[1][10] = SPP[25];
nextP[2][10] = SPP[22];
nextP[3][10] = SPP[19];
nextP[4][10] = SPP[49];
nextP[5][10] = SPP[53];
nextP[6][10] = SPP[46];
nextP[7][10] = P[7][10] + P[4][10]*dt;
nextP[8][10] = P[8][10] + P[5][10]*dt;
nextP[9][10] = P[9][10] + P[6][10]*dt;
nextP[10][10] = P[10][10];
nextP[0][11] = SPP[38];
nextP[1][11] = SPP[27];
nextP[2][11] = SPP[24];
nextP[3][11] = SPP[21];
nextP[4][11] = SPP[51];
nextP[5][11] = SPP[55];
nextP[6][11] = SPP[48];
nextP[7][11] = P[7][11] + P[4][11]*dt;
nextP[8][11] = P[8][11] + P[5][11]*dt;
nextP[9][11] = P[9][11] + P[6][11]*dt;
nextP[10][11] = P[10][11];
nextP[11][11] = P[11][11];
nextP[0][12] = SPP[37];
nextP[1][12] = SPP[26];
nextP[2][12] = SPP[23];
nextP[3][12] = SPP[20];
nextP[4][12] = SPP[50];
nextP[5][12] = SPP[54];
nextP[6][12] = SPP[47];
nextP[7][12] = P[7][12] + P[4][12]*dt;
nextP[8][12] = P[8][12] + P[5][12]*dt;
nextP[9][12] = P[9][12] + P[6][12]*dt;
nextP[10][12] = P[10][12];
nextP[11][12] = P[11][12];
nextP[12][12] = P[12][12];
nextP[0][13] = SPP[52];
nextP[1][13] = SPP[45];
nextP[2][13] = SPP[44];
nextP[3][13] = SPP[43];
nextP[4][13] = SPP[57];
nextP[5][13] = SPP[58];
nextP[6][13] = SPP[56];
nextP[7][13] = P[7][13] + P[4][13]*dt;
nextP[8][13] = P[8][13] + P[5][13]*dt;
nextP[9][13] = P[9][13] + P[6][13]*dt;
nextP[10][13] = P[10][13];
nextP[11][13] = P[11][13];
nextP[12][13] = P[12][13];
nextP[13][13] = P[13][13];
nextP[0][14] = P[0][14] - P[1][14]*SF[6] - P[2][14]*SF[4] - P[3][14]*SF[5] + P[10][14]*SF[7] + P[11][14]*SF[8] + P[12][14]*SF[9];
nextP[1][14] = P[1][14] + P[0][14]*SF[6] + P[2][14]*SF[5] - P[3][14]*SF[4] + P[11][14]*SF[9] - P[12][14]*SF[8] - (P[10][14]*q0)/2;
nextP[2][14] = P[2][14] + P[0][14]*SF[4] - P[1][14]*SF[5] + P[3][14]*SF[6] - P[10][14]*SF[9] + P[12][14]*SF[7] - (P[11][14]*q0)/2;
nextP[3][14] = P[3][14] + P[0][14]*SF[5] + P[1][14]*SF[4] - P[2][14]*SF[6] + P[10][14]*SF[8] - P[11][14]*SF[7] - (P[12][14]*q0)/2;
nextP[4][14] = P[4][14] + P[0][14]*SF[3] + P[1][14]*SF[1] + P[2][14]*SF[13] - P[3][14]*SF[2] - P[13][14]*SPP[2];
nextP[5][14] = P[5][14] + P[0][14]*SF[2] - P[1][14]*SF[13] + P[2][14]*SF[1] + P[3][14]*SF[3] + P[13][14]*SPP[1];
nextP[6][14] = P[6][14] + P[0][14]*SF[13] + P[1][14]*SF[2] - P[2][14]*SF[3] + P[3][14]*SF[1] - P[13][14]*SPP[0];
nextP[7][14] = P[7][14] + P[4][14]*dt;
nextP[8][14] = P[8][14] + P[5][14]*dt;
nextP[9][14] = P[9][14] + P[6][14]*dt;
nextP[10][14] = P[10][14];
nextP[11][14] = P[11][14];
nextP[12][14] = P[12][14];
nextP[13][14] = P[13][14];
nextP[14][14] = P[14][14];
nextP[0][15] = P[0][15] - P[1][15]*SF[6] - P[2][15]*SF[4] - P[3][15]*SF[5] + P[10][15]*SF[7] + P[11][15]*SF[8] + P[12][15]*SF[9];
nextP[1][15] = P[1][15] + P[0][15]*SF[6] + P[2][15]*SF[5] - P[3][15]*SF[4] + P[11][15]*SF[9] - P[12][15]*SF[8] - (P[10][15]*q0)/2;
nextP[2][15] = P[2][15] + P[0][15]*SF[4] - P[1][15]*SF[5] + P[3][15]*SF[6] - P[10][15]*SF[9] + P[12][15]*SF[7] - (P[11][15]*q0)/2;
nextP[3][15] = P[3][15] + P[0][15]*SF[5] + P[1][15]*SF[4] - P[2][15]*SF[6] + P[10][15]*SF[8] - P[11][15]*SF[7] - (P[12][15]*q0)/2;
nextP[4][15] = P[4][15] + P[0][15]*SF[3] + P[1][15]*SF[1] + P[2][15]*SF[13] - P[3][15]*SF[2] - P[13][15]*SPP[2];
nextP[5][15] = P[5][15] + P[0][15]*SF[2] - P[1][15]*SF[13] + P[2][15]*SF[1] + P[3][15]*SF[3] + P[13][15]*SPP[1];
nextP[6][15] = P[6][15] + P[0][15]*SF[13] + P[1][15]*SF[2] - P[2][15]*SF[3] + P[3][15]*SF[1] - P[13][15]*SPP[0];
nextP[7][15] = P[7][15] + P[4][15]*dt;
nextP[8][15] = P[8][15] + P[5][15]*dt;
nextP[9][15] = P[9][15] + P[6][15]*dt;
nextP[10][15] = P[10][15];
nextP[11][15] = P[11][15];
nextP[12][15] = P[12][15];
nextP[13][15] = P[13][15];
nextP[14][15] = P[14][15];
nextP[15][15] = P[15][15];
nextP[0][16] = P[0][16] - P[1][16]*SF[6] - P[2][16]*SF[4] - P[3][16]*SF[5] + P[10][16]*SF[7] + P[11][16]*SF[8] + P[12][16]*SF[9];
nextP[1][16] = P[1][16] + P[0][16]*SF[6] + P[2][16]*SF[5] - P[3][16]*SF[4] + P[11][16]*SF[9] - P[12][16]*SF[8] - (P[10][16]*q0)/2;
nextP[2][16] = P[2][16] + P[0][16]*SF[4] - P[1][16]*SF[5] + P[3][16]*SF[6] - P[10][16]*SF[9] + P[12][16]*SF[7] - (P[11][16]*q0)/2;
nextP[3][16] = P[3][16] + P[0][16]*SF[5] + P[1][16]*SF[4] - P[2][16]*SF[6] + P[10][16]*SF[8] - P[11][16]*SF[7] - (P[12][16]*q0)/2;
nextP[4][16] = P[4][16] + P[0][16]*SF[3] + P[1][16]*SF[1] + P[2][16]*SF[13] - P[3][16]*SF[2] - P[13][16]*SPP[2];
nextP[5][16] = P[5][16] + P[0][16]*SF[2] - P[1][16]*SF[13] + P[2][16]*SF[1] + P[3][16]*SF[3] + P[13][16]*SPP[1];
nextP[6][16] = P[6][16] + P[0][16]*SF[13] + P[1][16]*SF[2] - P[2][16]*SF[3] + P[3][16]*SF[1] - P[13][16]*SPP[0];
nextP[7][16] = P[7][16] + P[4][16]*dt;
nextP[8][16] = P[8][16] + P[5][16]*dt;
nextP[9][16] = P[9][16] + P[6][16]*dt;
nextP[10][16] = P[10][16];
nextP[11][16] = P[11][16];
nextP[12][16] = P[12][16];
nextP[13][16] = P[13][16];
nextP[14][16] = P[14][16];
nextP[15][16] = P[15][16];
nextP[16][16] = P[16][16];
nextP[0][17] = P[0][17] - P[1][17]*SF[6] - P[2][17]*SF[4] - P[3][17]*SF[5] + P[10][17]*SF[7] + P[11][17]*SF[8] + P[12][17]*SF[9];
nextP[1][17] = P[1][17] + P[0][17]*SF[6] + P[2][17]*SF[5] - P[3][17]*SF[4] + P[11][17]*SF[9] - P[12][17]*SF[8] - (P[10][17]*q0)/2;
nextP[2][17] = P[2][17] + P[0][17]*SF[4] - P[1][17]*SF[5] + P[3][17]*SF[6] - P[10][17]*SF[9] + P[12][17]*SF[7] - (P[11][17]*q0)/2;
nextP[3][17] = P[3][17] + P[0][17]*SF[5] + P[1][17]*SF[4] - P[2][17]*SF[6] + P[10][17]*SF[8] - P[11][17]*SF[7] - (P[12][17]*q0)/2;
nextP[4][17] = P[4][17] + P[0][17]*SF[3] + P[1][17]*SF[1] + P[2][17]*SF[13] - P[3][17]*SF[2] - P[13][17]*SPP[2];
nextP[5][17] = P[5][17] + P[0][17]*SF[2] - P[1][17]*SF[13] + P[2][17]*SF[1] + P[3][17]*SF[3] + P[13][17]*SPP[1];
nextP[6][17] = P[6][17] + P[0][17]*SF[13] + P[1][17]*SF[2] - P[2][17]*SF[3] + P[3][17]*SF[1] - P[13][17]*SPP[0];
nextP[7][17] = P[7][17] + P[4][17]*dt;
nextP[8][17] = P[8][17] + P[5][17]*dt;
nextP[9][17] = P[9][17] + P[6][17]*dt;
nextP[10][17] = P[10][17];
nextP[11][17] = P[11][17];
nextP[12][17] = P[12][17];
nextP[13][17] = P[13][17];
nextP[14][17] = P[14][17];
nextP[15][17] = P[15][17];
nextP[16][17] = P[16][17];
nextP[17][17] = P[17][17];
nextP[0][18] = P[0][18] - P[1][18]*SF[6] - P[2][18]*SF[4] - P[3][18]*SF[5] + P[10][18]*SF[7] + P[11][18]*SF[8] + P[12][18]*SF[9];
nextP[1][18] = P[1][18] + P[0][18]*SF[6] + P[2][18]*SF[5] - P[3][18]*SF[4] + P[11][18]*SF[9] - P[12][18]*SF[8] - (P[10][18]*q0)/2;
nextP[2][18] = P[2][18] + P[0][18]*SF[4] - P[1][18]*SF[5] + P[3][18]*SF[6] - P[10][18]*SF[9] + P[12][18]*SF[7] - (P[11][18]*q0)/2;
nextP[3][18] = P[3][18] + P[0][18]*SF[5] + P[1][18]*SF[4] - P[2][18]*SF[6] + P[10][18]*SF[8] - P[11][18]*SF[7] - (P[12][18]*q0)/2;
nextP[4][18] = P[4][18] + P[0][18]*SF[3] + P[1][18]*SF[1] + P[2][18]*SF[13] - P[3][18]*SF[2] - P[13][18]*SPP[2];
nextP[5][18] = P[5][18] + P[0][18]*SF[2] - P[1][18]*SF[13] + P[2][18]*SF[1] + P[3][18]*SF[3] + P[13][18]*SPP[1];
nextP[6][18] = P[6][18] + P[0][18]*SF[13] + P[1][18]*SF[2] - P[2][18]*SF[3] + P[3][18]*SF[1] - P[13][18]*SPP[0];
nextP[7][18] = P[7][18] + P[4][18]*dt;
nextP[8][18] = P[8][18] + P[5][18]*dt;
nextP[9][18] = P[9][18] + P[6][18]*dt;
nextP[10][18] = P[10][18];
nextP[11][18] = P[11][18];
nextP[12][18] = P[12][18];
nextP[13][18] = P[13][18];
nextP[14][18] = P[14][18];
nextP[15][18] = P[15][18];
nextP[16][18] = P[16][18];
nextP[17][18] = P[17][18];
nextP[18][18] = P[18][18];
nextP[0][19] = P[0][19] - P[1][19]*SF[6] - P[2][19]*SF[4] - P[3][19]*SF[5] + P[10][19]*SF[7] + P[11][19]*SF[8] + P[12][19]*SF[9];
nextP[1][19] = P[1][19] + P[0][19]*SF[6] + P[2][19]*SF[5] - P[3][19]*SF[4] + P[11][19]*SF[9] - P[12][19]*SF[8] - (P[10][19]*q0)/2;
nextP[2][19] = P[2][19] + P[0][19]*SF[4] - P[1][19]*SF[5] + P[3][19]*SF[6] - P[10][19]*SF[9] + P[12][19]*SF[7] - (P[11][19]*q0)/2;
nextP[3][19] = P[3][19] + P[0][19]*SF[5] + P[1][19]*SF[4] - P[2][19]*SF[6] + P[10][19]*SF[8] - P[11][19]*SF[7] - (P[12][19]*q0)/2;
nextP[4][19] = P[4][19] + P[0][19]*SF[3] + P[1][19]*SF[1] + P[2][19]*SF[13] - P[3][19]*SF[2] - P[13][19]*SPP[2];
nextP[5][19] = P[5][19] + P[0][19]*SF[2] - P[1][19]*SF[13] + P[2][19]*SF[1] + P[3][19]*SF[3] + P[13][19]*SPP[1];
nextP[6][19] = P[6][19] + P[0][19]*SF[13] + P[1][19]*SF[2] - P[2][19]*SF[3] + P[3][19]*SF[1] - P[13][19]*SPP[0];
nextP[7][19] = P[7][19] + P[4][19]*dt;
nextP[8][19] = P[8][19] + P[5][19]*dt;
nextP[9][19] = P[9][19] + P[6][19]*dt;
nextP[10][19] = P[10][19];
nextP[11][19] = P[11][19];
nextP[12][19] = P[12][19];
nextP[13][19] = P[13][19];
nextP[14][19] = P[14][19];
nextP[15][19] = P[15][19];
nextP[16][19] = P[16][19];
nextP[17][19] = P[17][19];
nextP[18][19] = P[18][19];
nextP[19][19] = P[19][19];
nextP[0][20] = P[0][20] - P[1][20]*SF[6] - P[2][20]*SF[4] - P[3][20]*SF[5] + P[10][20]*SF[7] + P[11][20]*SF[8] + P[12][20]*SF[9];
nextP[1][20] = P[1][20] + P[0][20]*SF[6] + P[2][20]*SF[5] - P[3][20]*SF[4] + P[11][20]*SF[9] - P[12][20]*SF[8] - (P[10][20]*q0)/2;
nextP[2][20] = P[2][20] + P[0][20]*SF[4] - P[1][20]*SF[5] + P[3][20]*SF[6] - P[10][20]*SF[9] + P[12][20]*SF[7] - (P[11][20]*q0)/2;
nextP[3][20] = P[3][20] + P[0][20]*SF[5] + P[1][20]*SF[4] - P[2][20]*SF[6] + P[10][20]*SF[8] - P[11][20]*SF[7] - (P[12][20]*q0)/2;
nextP[4][20] = P[4][20] + P[0][20]*SF[3] + P[1][20]*SF[1] + P[2][20]*SF[13] - P[3][20]*SF[2] - P[13][20]*SPP[2];
nextP[5][20] = P[5][20] + P[0][20]*SF[2] - P[1][20]*SF[13] + P[2][20]*SF[1] + P[3][20]*SF[3] + P[13][20]*SPP[1];
nextP[6][20] = P[6][20] + P[0][20]*SF[13] + P[1][20]*SF[2] - P[2][20]*SF[3] + P[3][20]*SF[1] - P[13][20]*SPP[0];
nextP[7][20] = P[7][20] + P[4][20]*dt;
nextP[8][20] = P[8][20] + P[5][20]*dt;
nextP[9][20] = P[9][20] + P[6][20]*dt;
nextP[10][20] = P[10][20];
nextP[11][20] = P[11][20];
nextP[12][20] = P[12][20];
nextP[13][20] = P[13][20];
nextP[14][20] = P[14][20];
nextP[15][20] = P[15][20];
nextP[16][20] = P[16][20];
nextP[17][20] = P[17][20];
nextP[18][20] = P[18][20];
nextP[19][20] = P[19][20];
nextP[20][20] = P[20][20];
nextP[0][21] = P[0][21] - P[1][21]*SF[6] - P[2][21]*SF[4] - P[3][21]*SF[5] + P[10][21]*SF[7] + P[11][21]*SF[8] + P[12][21]*SF[9];
nextP[1][21] = P[1][21] + P[0][21]*SF[6] + P[2][21]*SF[5] - P[3][21]*SF[4] + P[11][21]*SF[9] - P[12][21]*SF[8] - (P[10][21]*q0)/2;
nextP[2][21] = P[2][21] + P[0][21]*SF[4] - P[1][21]*SF[5] + P[3][21]*SF[6] - P[10][21]*SF[9] + P[12][21]*SF[7] - (P[11][21]*q0)/2;
nextP[3][21] = P[3][21] + P[0][21]*SF[5] + P[1][21]*SF[4] - P[2][21]*SF[6] + P[10][21]*SF[8] - P[11][21]*SF[7] - (P[12][21]*q0)/2;
nextP[4][21] = P[4][21] + P[0][21]*SF[3] + P[1][21]*SF[1] + P[2][21]*SF[13] - P[3][21]*SF[2] - P[13][21]*SPP[2];
nextP[5][21] = P[5][21] + P[0][21]*SF[2] - P[1][21]*SF[13] + P[2][21]*SF[1] + P[3][21]*SF[3] + P[13][21]*SPP[1];
nextP[6][21] = P[6][21] + P[0][21]*SF[13] + P[1][21]*SF[2] - P[2][21]*SF[3] + P[3][21]*SF[1] - P[13][21]*SPP[0];
nextP[7][21] = P[7][21] + P[4][21]*dt;
nextP[8][21] = P[8][21] + P[5][21]*dt;
nextP[9][21] = P[9][21] + P[6][21]*dt;
nextP[10][21] = P[10][21];
nextP[11][21] = P[11][21];
nextP[12][21] = P[12][21];
nextP[13][21] = P[13][21];
nextP[14][21] = P[14][21];
nextP[15][21] = P[15][21];
nextP[16][21] = P[16][21];
nextP[17][21] = P[17][21];
nextP[18][21] = P[18][21];
nextP[19][21] = P[19][21];
nextP[20][21] = P[20][21];
nextP[21][21] = P[21][21];
float H_VP[6][22];
H_VP[0][4] = 1;
H_VP[1][5] = 1;
H_VP[2][6] = 1;
H_VP[3][7] = 1;
H_VP[4][8] = 1;
H_VP[5][9] = 1;
float SK_VP[6][1];
SK_VP[0][0] = 1/(P[9][9] + R_PD);
SK_VP[1][0] = 1/(P[8][8] + R_PE);
SK_VP[2][0] = 1/(P[7][7] + R_PN);
SK_VP[3][0] = 1/(P[6][6] + R_VD);
SK_VP[4][0] = 1/(P[5][5] + R_VE);
SK_VP[5][0] = 1/(P[4][4] + R_VN);
float Kfusion[22][6];
Kfusion[0][0] = P[0][4]*SK_VP[5];
Kfusion[0][1] = P[0][5]*SK_VP[4];
Kfusion[0][2] = P[0][6]*SK_VP[3];
Kfusion[0][3] = P[0][7]*SK_VP[2];
Kfusion[0][4] = P[0][8]*SK_VP[1];
Kfusion[0][5] = P[0][9]*SK_VP[0];
Kfusion[1][0] = P[1][4]*SK_VP[5];
Kfusion[1][1] = P[1][5]*SK_VP[4];
Kfusion[1][2] = P[1][6]*SK_VP[3];
Kfusion[1][3] = P[1][7]*SK_VP[2];
Kfusion[1][4] = P[1][8]*SK_VP[1];
Kfusion[1][5] = P[1][9]*SK_VP[0];
Kfusion[2][0] = P[2][4]*SK_VP[5];
Kfusion[2][1] = P[2][5]*SK_VP[4];
Kfusion[2][2] = P[2][6]*SK_VP[3];
Kfusion[2][3] = P[2][7]*SK_VP[2];
Kfusion[2][4] = P[2][8]*SK_VP[1];
Kfusion[2][5] = P[2][9]*SK_VP[0];
Kfusion[3][0] = P[3][4]*SK_VP[5];
Kfusion[3][1] = P[3][5]*SK_VP[4];
Kfusion[3][2] = P[3][6]*SK_VP[3];
Kfusion[3][3] = P[3][7]*SK_VP[2];
Kfusion[3][4] = P[3][8]*SK_VP[1];
Kfusion[3][5] = P[3][9]*SK_VP[0];
Kfusion[4][0] = P[4][4]*SK_VP[5];
Kfusion[4][1] = P[4][5]*SK_VP[4];
Kfusion[4][2] = P[4][6]*SK_VP[3];
Kfusion[4][3] = P[4][7]*SK_VP[2];
Kfusion[4][4] = P[4][8]*SK_VP[1];
Kfusion[4][5] = P[4][9]*SK_VP[0];
Kfusion[5][0] = P[5][4]*SK_VP[5];
Kfusion[5][1] = P[5][5]*SK_VP[4];
Kfusion[5][2] = P[5][6]*SK_VP[3];
Kfusion[5][3] = P[5][7]*SK_VP[2];
Kfusion[5][4] = P[5][8]*SK_VP[1];
Kfusion[5][5] = P[5][9]*SK_VP[0];
Kfusion[6][0] = P[6][4]*SK_VP[5];
Kfusion[6][1] = P[6][5]*SK_VP[4];
Kfusion[6][2] = P[6][6]*SK_VP[3];
Kfusion[6][3] = P[6][7]*SK_VP[2];
Kfusion[6][4] = P[6][8]*SK_VP[1];
Kfusion[6][5] = P[6][9]*SK_VP[0];
Kfusion[7][0] = P[7][4]*SK_VP[5];
Kfusion[7][1] = P[7][5]*SK_VP[4];
Kfusion[7][2] = P[7][6]*SK_VP[3];
Kfusion[7][3] = P[7][7]*SK_VP[2];
Kfusion[7][4] = P[7][8]*SK_VP[1];
Kfusion[7][5] = P[7][9]*SK_VP[0];
Kfusion[8][0] = P[8][4]*SK_VP[5];
Kfusion[8][1] = P[8][5]*SK_VP[4];
Kfusion[8][2] = P[8][6]*SK_VP[3];
Kfusion[8][3] = P[8][7]*SK_VP[2];
Kfusion[8][4] = P[8][8]*SK_VP[1];
Kfusion[8][5] = P[8][9]*SK_VP[0];
Kfusion[9][0] = P[9][4]*SK_VP[5];
Kfusion[9][1] = P[9][5]*SK_VP[4];
Kfusion[9][2] = P[9][6]*SK_VP[3];
Kfusion[9][3] = P[9][7]*SK_VP[2];
Kfusion[9][4] = P[9][8]*SK_VP[1];
Kfusion[9][5] = P[9][9]*SK_VP[0];
Kfusion[10][0] = P[10][4]*SK_VP[5];
Kfusion[10][1] = P[10][5]*SK_VP[4];
Kfusion[10][2] = P[10][6]*SK_VP[3];
Kfusion[10][3] = P[10][7]*SK_VP[2];
Kfusion[10][4] = P[10][8]*SK_VP[1];
Kfusion[10][5] = P[10][9]*SK_VP[0];
Kfusion[11][0] = P[11][4]*SK_VP[5];
Kfusion[11][1] = P[11][5]*SK_VP[4];
Kfusion[11][2] = P[11][6]*SK_VP[3];
Kfusion[11][3] = P[11][7]*SK_VP[2];
Kfusion[11][4] = P[11][8]*SK_VP[1];
Kfusion[11][5] = P[11][9]*SK_VP[0];
Kfusion[12][0] = P[12][4]*SK_VP[5];
Kfusion[12][1] = P[12][5]*SK_VP[4];
Kfusion[12][2] = P[12][6]*SK_VP[3];
Kfusion[12][3] = P[12][7]*SK_VP[2];
Kfusion[12][4] = P[12][8]*SK_VP[1];
Kfusion[12][5] = P[12][9]*SK_VP[0];
Kfusion[13][0] = P[13][4]*SK_VP[5];
Kfusion[13][1] = P[13][5]*SK_VP[4];
Kfusion[13][2] = P[13][6]*SK_VP[3];
Kfusion[13][3] = P[13][7]*SK_VP[2];
Kfusion[13][4] = P[13][8]*SK_VP[1];
Kfusion[13][5] = P[13][9]*SK_VP[0];
Kfusion[14][0] = P[14][4]*SK_VP[5];
Kfusion[14][1] = P[14][5]*SK_VP[4];
Kfusion[14][2] = P[14][6]*SK_VP[3];
Kfusion[14][3] = P[14][7]*SK_VP[2];
Kfusion[14][4] = P[14][8]*SK_VP[1];
Kfusion[14][5] = P[14][9]*SK_VP[0];
Kfusion[15][0] = P[15][4]*SK_VP[5];
Kfusion[15][1] = P[15][5]*SK_VP[4];
Kfusion[15][2] = P[15][6]*SK_VP[3];
Kfusion[15][3] = P[15][7]*SK_VP[2];
Kfusion[15][4] = P[15][8]*SK_VP[1];
Kfusion[15][5] = P[15][9]*SK_VP[0];
Kfusion[16][0] = P[16][4]*SK_VP[5];
Kfusion[16][1] = P[16][5]*SK_VP[4];
Kfusion[16][2] = P[16][6]*SK_VP[3];
Kfusion[16][3] = P[16][7]*SK_VP[2];
Kfusion[16][4] = P[16][8]*SK_VP[1];
Kfusion[16][5] = P[16][9]*SK_VP[0];
Kfusion[17][0] = P[17][4]*SK_VP[5];
Kfusion[17][1] = P[17][5]*SK_VP[4];
Kfusion[17][2] = P[17][6]*SK_VP[3];
Kfusion[17][3] = P[17][7]*SK_VP[2];
Kfusion[17][4] = P[17][8]*SK_VP[1];
Kfusion[17][5] = P[17][9]*SK_VP[0];
Kfusion[18][0] = P[18][4]*SK_VP[5];
Kfusion[18][1] = P[18][5]*SK_VP[4];
Kfusion[18][2] = P[18][6]*SK_VP[3];
Kfusion[18][3] = P[18][7]*SK_VP[2];
Kfusion[18][4] = P[18][8]*SK_VP[1];
Kfusion[18][5] = P[18][9]*SK_VP[0];
Kfusion[19][0] = P[19][4]*SK_VP[5];
Kfusion[19][1] = P[19][5]*SK_VP[4];
Kfusion[19][2] = P[19][6]*SK_VP[3];
Kfusion[19][3] = P[19][7]*SK_VP[2];
Kfusion[19][4] = P[19][8]*SK_VP[1];
Kfusion[19][5] = P[19][9]*SK_VP[0];
Kfusion[20][0] = P[20][4]*SK_VP[5];
Kfusion[20][1] = P[20][5]*SK_VP[4];
Kfusion[20][2] = P[20][6]*SK_VP[3];
Kfusion[20][3] = P[20][7]*SK_VP[2];
Kfusion[20][4] = P[20][8]*SK_VP[1];
Kfusion[20][5] = P[20][9]*SK_VP[0];
Kfusion[21][0] = P[21][4]*SK_VP[5];
Kfusion[21][1] = P[21][5]*SK_VP[4];
Kfusion[21][2] = P[21][6]*SK_VP[3];
Kfusion[21][3] = P[21][7]*SK_VP[2];
Kfusion[21][4] = P[21][8]*SK_VP[1];
Kfusion[21][5] = P[21][9]*SK_VP[0];
float SH_TAS[3][1];
SH_TAS[0] = 1/(sqrt(sq(ve - vwe) + sq(vn - vwn) + sq(vd)));
SH_TAS[1] = (SH_TAS[0]*(2*ve - 2*vwe))/2;
SH_TAS[2] = (SH_TAS[0]*(2*vn - 2*vwn))/2;
float H_TAS[1][22];
H_TAS[0][4] = SH_TAS[2];
H_TAS[0][5] = SH_TAS[1];
H_TAS[0][6] = SH_TAS[0]*vd;
H_TAS[0][14] = -SH_TAS[2];
H_TAS[0][15] = -SH_TAS[1];
float SK_TAS[1][1];
SK_TAS[0] = 1/(R_TAS + SH_TAS[2]*(P[4][4]*SH_TAS[2] + P[5][4]*SH_TAS[1] - P[14][4]*SH_TAS[2] - P[15][4]*SH_TAS[1] + P[6][4]*SH_TAS[0]*vd) + SH_TAS[1]*(P[4][5]*SH_TAS[2] + P[5][5]*SH_TAS[1] - P[14][5]*SH_TAS[2] - P[15][5]*SH_TAS[1] + P[6][5]*SH_TAS[0]*vd) - SH_TAS[2]*(P[4][14]*SH_TAS[2] + P[5][14]*SH_TAS[1] - P[14][14]*SH_TAS[2] - P[15][14]*SH_TAS[1] + P[6][14]*SH_TAS[0]*vd) - SH_TAS[1]*(P[4][15]*SH_TAS[2] + P[5][15]*SH_TAS[1] - P[14][15]*SH_TAS[2] - P[15][15]*SH_TAS[1] + P[6][15]*SH_TAS[0]*vd) + SH_TAS[0]*vd*(P[4][6]*SH_TAS[2] + P[5][6]*SH_TAS[1] - P[14][6]*SH_TAS[2] - P[15][6]*SH_TAS[1] + P[6][6]*SH_TAS[0]*vd));
float Kfusion[22][1];
float Kfusion[1][1];
Kfusion[0] = SK_TAS[0]*(P[0][4]*SH_TAS[2] + P[0][5]*SH_TAS[1] - P[0][14]*SH_TAS[2] - P[0][15]*SH_TAS[1] + P[0][6]*SH_TAS[0]*vd);
Kfusion[1] = SK_TAS[0]*(P[1][4]*SH_TAS[2] + P[1][5]*SH_TAS[1] - P[1][14]*SH_TAS[2] - P[1][15]*SH_TAS[1] + P[1][6]*SH_TAS[0]*vd);
Kfusion[2] = SK_TAS[0]*(P[2][4]*SH_TAS[2] + P[2][5]*SH_TAS[1] - P[2][14]*SH_TAS[2] - P[2][15]*SH_TAS[1] + P[2][6]*SH_TAS[0]*vd);
Kfusion[3] = SK_TAS[0]*(P[3][4]*SH_TAS[2] + P[3][5]*SH_TAS[1] - P[3][14]*SH_TAS[2] - P[3][15]*SH_TAS[1] + P[3][6]*SH_TAS[0]*vd);
Kfusion[4] = SK_TAS[0]*(P[4][4]*SH_TAS[2] + P[4][5]*SH_TAS[1] - P[4][14]*SH_TAS[2] - P[4][15]*SH_TAS[1] + P[4][6]*SH_TAS[0]*vd);
Kfusion[5] = SK_TAS[0]*(P[5][4]*SH_TAS[2] + P[5][5]*SH_TAS[1] - P[5][14]*SH_TAS[2] - P[5][15]*SH_TAS[1] + P[5][6]*SH_TAS[0]*vd);
Kfusion[6] = SK_TAS[0]*(P[6][4]*SH_TAS[2] + P[6][5]*SH_TAS[1] - P[6][14]*SH_TAS[2] - P[6][15]*SH_TAS[1] + P[6][6]*SH_TAS[0]*vd);
Kfusion[7] = SK_TAS[0]*(P[7][4]*SH_TAS[2] + P[7][5]*SH_TAS[1] - P[7][14]*SH_TAS[2] - P[7][15]*SH_TAS[1] + P[7][6]*SH_TAS[0]*vd);
Kfusion[8] = SK_TAS[0]*(P[8][4]*SH_TAS[2] + P[8][5]*SH_TAS[1] - P[8][14]*SH_TAS[2] - P[8][15]*SH_TAS[1] + P[8][6]*SH_TAS[0]*vd);
Kfusion[9] = SK_TAS[0]*(P[9][4]*SH_TAS[2] + P[9][5]*SH_TAS[1] - P[9][14]*SH_TAS[2] - P[9][15]*SH_TAS[1] + P[9][6]*SH_TAS[0]*vd);
Kfusion[10] = SK_TAS[0]*(P[10][4]*SH_TAS[2] + P[10][5]*SH_TAS[1] - P[10][14]*SH_TAS[2] - P[10][15]*SH_TAS[1] + P[10][6]*SH_TAS[0]*vd);
Kfusion[11] = SK_TAS[0]*(P[11][4]*SH_TAS[2] + P[11][5]*SH_TAS[1] - P[11][14]*SH_TAS[2] - P[11][15]*SH_TAS[1] + P[11][6]*SH_TAS[0]*vd);
Kfusion[12] = SK_TAS[0]*(P[12][4]*SH_TAS[2] + P[12][5]*SH_TAS[1] - P[12][14]*SH_TAS[2] - P[12][15]*SH_TAS[1] + P[12][6]*SH_TAS[0]*vd);
Kfusion[13] = SK_TAS[0]*(P[13][4]*SH_TAS[2] + P[13][5]*SH_TAS[1] - P[13][14]*SH_TAS[2] - P[13][15]*SH_TAS[1] + P[13][6]*SH_TAS[0]*vd);
Kfusion[14] = SK_TAS[0]*(P[14][4]*SH_TAS[2] + P[14][5]*SH_TAS[1] - P[14][14]*SH_TAS[2] - P[14][15]*SH_TAS[1] + P[14][6]*SH_TAS[0]*vd);
Kfusion[15] = SK_TAS[0]*(P[15][4]*SH_TAS[2] + P[15][5]*SH_TAS[1] - P[15][14]*SH_TAS[2] - P[15][15]*SH_TAS[1] + P[15][6]*SH_TAS[0]*vd);
Kfusion[16] = SK_TAS[0]*(P[16][4]*SH_TAS[2] + P[16][5]*SH_TAS[1] - P[16][14]*SH_TAS[2] - P[16][15]*SH_TAS[1] + P[16][6]*SH_TAS[0]*vd);
Kfusion[17] = SK_TAS[0]*(P[17][4]*SH_TAS[2] + P[17][5]*SH_TAS[1] - P[17][14]*SH_TAS[2] - P[17][15]*SH_TAS[1] + P[17][6]*SH_TAS[0]*vd);
Kfusion[18] = SK_TAS[0]*(P[18][4]*SH_TAS[2] + P[18][5]*SH_TAS[1] - P[18][14]*SH_TAS[2] - P[18][15]*SH_TAS[1] + P[18][6]*SH_TAS[0]*vd);
Kfusion[19] = SK_TAS[0]*(P[19][4]*SH_TAS[2] + P[19][5]*SH_TAS[1] - P[19][14]*SH_TAS[2] - P[19][15]*SH_TAS[1] + P[19][6]*SH_TAS[0]*vd);
Kfusion[20] = SK_TAS[0]*(P[20][4]*SH_TAS[2] + P[20][5]*SH_TAS[1] - P[20][14]*SH_TAS[2] - P[20][15]*SH_TAS[1] + P[20][6]*SH_TAS[0]*vd);
Kfusion[21] = SK_TAS[0]*(P[21][4]*SH_TAS[2] + P[21][5]*SH_TAS[1] - P[21][14]*SH_TAS[2] - P[21][15]*SH_TAS[1] + P[21][6]*SH_TAS[0]*vd);
float SH_MAG[16][1];
SH_MAG[0] = 2*magD*q3 + 2*magE*q2 + 2*magN*q1;
SH_MAG[1] = 2*magD*q0 - 2*magE*q1 + 2*magN*q2;
SH_MAG[2] = 2*magD*q1 + 2*magE*q0 - 2*magN*q3;
SH_MAG[3] = sq(q3);
SH_MAG[4] = sq(q2);
SH_MAG[5] = sq(q1);
SH_MAG[6] = sq(q0);
SH_MAG[7] = 2*magN*q0;
SH_MAG[8] = 2*magE*q3;
SH_MAG[9] = 2*q2*q3;
SH_MAG[10] = 2*q1*q3;
SH_MAG[11] = 2*q1*q2;
SH_MAG[12] = 2*q0*q1;
SH_MAG[13] = 2*magD*q2;
SH_MAG[14] = SH_MAG[7] + SH_MAG[8] - SH_MAG[13];
SH_MAG[15] = 2*q0*q3;
float H_MAG[1][22];
H_MAG[0] = SH_MAG[14];
H_MAG[1] = SH_MAG[0];
H_MAG[2] = -SH_MAG[1];
H_MAG[3] = SH_MAG[2];
H_MAG[16] = SH_MAG[5] - SH_MAG[4] - SH_MAG[3] + SH_MAG[6];
H_MAG[17] = SH_MAG[11] + SH_MAG[15];
H_MAG[18] = SH_MAG[10] - 2*q0*q2;
H_MAG[19] = 1;
float SK_MX[4][1];
SK_MX[0] = 1/(P[19][19] + R_MAG + P[0][19]*SH_MAG[14] + P[1][19]*SH_MAG[0] - P[2][19]*SH_MAG[1] + P[3][19]*SH_MAG[2] - P[16][19]*(SH_MAG[3] + SH_MAG[4] - SH_MAG[5] - SH_MAG[6]) + (SH_MAG[10] - 2*q0*q2)*(P[19][18] + P[0][18]*SH_MAG[14] + P[1][18]*SH_MAG[0] - P[2][18]*SH_MAG[1] + P[3][18]*SH_MAG[2] - P[16][18]*(SH_MAG[3] + SH_MAG[4] - SH_MAG[5] - SH_MAG[6]) + P[18][18]*(SH_MAG[10] - 2*q0*q2) + P[17][18]*(SH_MAG[11] + SH_MAG[15])) + (SH_MAG[11] + SH_MAG[15])*(P[19][17] + P[0][17]*SH_MAG[14] + P[1][17]*SH_MAG[0] - P[2][17]*SH_MAG[1] + P[3][17]*SH_MAG[2] - P[16][17]*(SH_MAG[3] + SH_MAG[4] - SH_MAG[5] - SH_MAG[6]) + P[18][17]*(SH_MAG[10] - 2*q0*q2) + P[17][17]*(SH_MAG[11] + SH_MAG[15])) + P[18][19]*(SH_MAG[10] - 2*q0*q2) + P[17][19]*(SH_MAG[11] + SH_MAG[15]) + SH_MAG[0]*(P[19][1] + P[1][1]*SH_MAG[0] + P[0][1]*SH_MAG[14] - P[2][1]*SH_MAG[1] + P[3][1]*SH_MAG[2] - P[16][1]*(SH_MAG[3] + SH_MAG[4] - SH_MAG[5] - SH_MAG[6]) + P[18][1]*(SH_MAG[10] - 2*q0*q2) + P[17][1]*(SH_MAG[11] + SH_MAG[15])) + SH_MAG[14]*(P[19][0] + P[1][0]*SH_MAG[0] + P[0][0]*SH_MAG[14] - P[2][0]*SH_MAG[1] + P[3][0]*SH_MAG[2] - P[16][0]*(SH_MAG[3] + SH_MAG[4] - SH_MAG[5] - SH_MAG[6]) + P[18][0]*(SH_MAG[10] - 2*q0*q2) + P[17][0]*(SH_MAG[11] + SH_MAG[15])) - SH_MAG[1]*(P[19][2] + P[1][2]*SH_MAG[0] + P[0][2]*SH_MAG[14] - P[2][2]*SH_MAG[1] + P[3][2]*SH_MAG[2] - P[16][2]*(SH_MAG[3] + SH_MAG[4] - SH_MAG[5] - SH_MAG[6]) + P[18][2]*(SH_MAG[10] - 2*q0*q2) + P[17][2]*(SH_MAG[11] + SH_MAG[15])) + SH_MAG[2]*(P[19][3] + P[1][3]*SH_MAG[0] + P[0][3]*SH_MAG[14] - P[2][3]*SH_MAG[1] + P[3][3]*SH_MAG[2] - P[16][3]*(SH_MAG[3] + SH_MAG[4] - SH_MAG[5] - SH_MAG[6]) + P[18][3]*(SH_MAG[10] - 2*q0*q2) + P[17][3]*(SH_MAG[11] + SH_MAG[15])) - (SH_MAG[3] + SH_MAG[4] - SH_MAG[5] - SH_MAG[6])*(P[19][16] + P[0][16]*SH_MAG[14] + P[1][16]*SH_MAG[0] - P[2][16]*SH_MAG[1] + P[3][16]*SH_MAG[2] - P[16][16]*(SH_MAG[3] + SH_MAG[4] - SH_MAG[5] - SH_MAG[6]) + P[18][16]*(SH_MAG[10] - 2*q0*q2) + P[17][16]*(SH_MAG[11] + SH_MAG[15])));
SK_MX[1] = SH_MAG[3] + SH_MAG[4] - SH_MAG[5] - SH_MAG[6];
SK_MX[2] = SH_MAG[10] - 2*q0*q2;
SK_MX[3] = SH_MAG[11] + SH_MAG[15];
float Kfusion[22][1];
float Kfusion[1][1];
Kfusion[0] = SK_MX[0]*(P[0][19] + P[0][1]*SH_MAG[0] - P[0][2]*SH_MAG[1] + P[0][3]*SH_MAG[2] + P[0][0]*SH_MAG[14] - P[0][16]*SK_MX[1] + P[0][17]*SK_MX[3] + P[0][18]*SK_MX[2]);
Kfusion[1] = SK_MX[0]*(P[1][19] + P[1][1]*SH_MAG[0] - P[1][2]*SH_MAG[1] + P[1][3]*SH_MAG[2] + P[1][0]*SH_MAG[14] - P[1][16]*SK_MX[1] + P[1][17]*SK_MX[3] + P[1][18]*SK_MX[2]);
Kfusion[2] = SK_MX[0]*(P[2][19] + P[2][1]*SH_MAG[0] - P[2][2]*SH_MAG[1] + P[2][3]*SH_MAG[2] + P[2][0]*SH_MAG[14] - P[2][16]*SK_MX[1] + P[2][17]*SK_MX[3] + P[2][18]*SK_MX[2]);
Kfusion[3] = SK_MX[0]*(P[3][19] + P[3][1]*SH_MAG[0] - P[3][2]*SH_MAG[1] + P[3][3]*SH_MAG[2] + P[3][0]*SH_MAG[14] - P[3][16]*SK_MX[1] + P[3][17]*SK_MX[3] + P[3][18]*SK_MX[2]);
Kfusion[4] = SK_MX[0]*(P[4][19] + P[4][1]*SH_MAG[0] - P[4][2]*SH_MAG[1] + P[4][3]*SH_MAG[2] + P[4][0]*SH_MAG[14] - P[4][16]*SK_MX[1] + P[4][17]*SK_MX[3] + P[4][18]*SK_MX[2]);
Kfusion[5] = SK_MX[0]*(P[5][19] + P[5][1]*SH_MAG[0] - P[5][2]*SH_MAG[1] + P[5][3]*SH_MAG[2] + P[5][0]*SH_MAG[14] - P[5][16]*SK_MX[1] + P[5][17]*SK_MX[3] + P[5][18]*SK_MX[2]);
Kfusion[6] = SK_MX[0]*(P[6][19] + P[6][1]*SH_MAG[0] - P[6][2]*SH_MAG[1] + P[6][3]*SH_MAG[2] + P[6][0]*SH_MAG[14] - P[6][16]*SK_MX[1] + P[6][17]*SK_MX[3] + P[6][18]*SK_MX[2]);
Kfusion[7] = SK_MX[0]*(P[7][19] + P[7][1]*SH_MAG[0] - P[7][2]*SH_MAG[1] + P[7][3]*SH_MAG[2] + P[7][0]*SH_MAG[14] - P[7][16]*SK_MX[1] + P[7][17]*SK_MX[3] + P[7][18]*SK_MX[2]);
Kfusion[8] = SK_MX[0]*(P[8][19] + P[8][1]*SH_MAG[0] - P[8][2]*SH_MAG[1] + P[8][3]*SH_MAG[2] + P[8][0]*SH_MAG[14] - P[8][16]*SK_MX[1] + P[8][17]*SK_MX[3] + P[8][18]*SK_MX[2]);
Kfusion[9] = SK_MX[0]*(P[9][19] + P[9][1]*SH_MAG[0] - P[9][2]*SH_MAG[1] + P[9][3]*SH_MAG[2] + P[9][0]*SH_MAG[14] - P[9][16]*SK_MX[1] + P[9][17]*SK_MX[3] + P[9][18]*SK_MX[2]);
Kfusion[10] = SK_MX[0]*(P[10][19] + P[10][1]*SH_MAG[0] - P[10][2]*SH_MAG[1] + P[10][3]*SH_MAG[2] + P[10][0]*SH_MAG[14] - P[10][16]*SK_MX[1] + P[10][17]*SK_MX[3] + P[10][18]*SK_MX[2]);
Kfusion[11] = SK_MX[0]*(P[11][19] + P[11][1]*SH_MAG[0] - P[11][2]*SH_MAG[1] + P[11][3]*SH_MAG[2] + P[11][0]*SH_MAG[14] - P[11][16]*SK_MX[1] + P[11][17]*SK_MX[3] + P[11][18]*SK_MX[2]);
Kfusion[12] = SK_MX[0]*(P[12][19] + P[12][1]*SH_MAG[0] - P[12][2]*SH_MAG[1] + P[12][3]*SH_MAG[2] + P[12][0]*SH_MAG[14] - P[12][16]*SK_MX[1] + P[12][17]*SK_MX[3] + P[12][18]*SK_MX[2]);
Kfusion[13] = SK_MX[0]*(P[13][19] + P[13][1]*SH_MAG[0] - P[13][2]*SH_MAG[1] + P[13][3]*SH_MAG[2] + P[13][0]*SH_MAG[14] - P[13][16]*SK_MX[1] + P[13][17]*SK_MX[3] + P[13][18]*SK_MX[2]);
Kfusion[14] = SK_MX[0]*(P[14][19] + P[14][1]*SH_MAG[0] - P[14][2]*SH_MAG[1] + P[14][3]*SH_MAG[2] + P[14][0]*SH_MAG[14] - P[14][16]*SK_MX[1] + P[14][17]*SK_MX[3] + P[14][18]*SK_MX[2]);
Kfusion[15] = SK_MX[0]*(P[15][19] + P[15][1]*SH_MAG[0] - P[15][2]*SH_MAG[1] + P[15][3]*SH_MAG[2] + P[15][0]*SH_MAG[14] - P[15][16]*SK_MX[1] + P[15][17]*SK_MX[3] + P[15][18]*SK_MX[2]);
Kfusion[16] = SK_MX[0]*(P[16][19] + P[16][1]*SH_MAG[0] - P[16][2]*SH_MAG[1] + P[16][3]*SH_MAG[2] + P[16][0]*SH_MAG[14] - P[16][16]*SK_MX[1] + P[16][17]*SK_MX[3] + P[16][18]*SK_MX[2]);
Kfusion[17] = SK_MX[0]*(P[17][19] + P[17][1]*SH_MAG[0] - P[17][2]*SH_MAG[1] + P[17][3]*SH_MAG[2] + P[17][0]*SH_MAG[14] - P[17][16]*SK_MX[1] + P[17][17]*SK_MX[3] + P[17][18]*SK_MX[2]);
Kfusion[18] = SK_MX[0]*(P[18][19] + P[18][1]*SH_MAG[0] - P[18][2]*SH_MAG[1] + P[18][3]*SH_MAG[2] + P[18][0]*SH_MAG[14] - P[18][16]*SK_MX[1] + P[18][17]*SK_MX[3] + P[18][18]*SK_MX[2]);
Kfusion[19] = SK_MX[0]*(P[19][19] + P[19][1]*SH_MAG[0] - P[19][2]*SH_MAG[1] + P[19][3]*SH_MAG[2] + P[19][0]*SH_MAG[14] - P[19][16]*SK_MX[1] + P[19][17]*SK_MX[3] + P[19][18]*SK_MX[2]);
Kfusion[20] = SK_MX[0]*(P[20][19] + P[20][1]*SH_MAG[0] - P[20][2]*SH_MAG[1] + P[20][3]*SH_MAG[2] + P[20][0]*SH_MAG[14] - P[20][16]*SK_MX[1] + P[20][17]*SK_MX[3] + P[20][18]*SK_MX[2]);
Kfusion[21] = SK_MX[0]*(P[21][19] + P[21][1]*SH_MAG[0] - P[21][2]*SH_MAG[1] + P[21][3]*SH_MAG[2] + P[21][0]*SH_MAG[14] - P[21][16]*SK_MX[1] + P[21][17]*SK_MX[3] + P[21][18]*SK_MX[2]);
float H_MAG[1][22];
H_MAG[0] = SH_MAG[2];
H_MAG[1] = SH_MAG[1];
H_MAG[2] = SH_MAG[0];
H_MAG[3] = -SH_MAG[14];
H_MAG[16] = SH_MAG[11] - SH_MAG[15];
H_MAG[17] = SH_MAG[4] - SH_MAG[3] - SH_MAG[5] + SH_MAG[6];
H_MAG[18] = SH_MAG[9] + SH_MAG[12];
H_MAG[20] = 1;
float SK_MY[4][1];
SK_MY[0] = 1/(P[20][20] + R_MAG + P[0][20]*SH_MAG[2] + P[1][20]*SH_MAG[1] + P[2][20]*SH_MAG[0] - P[3][20]*SH_MAG[14] + P[16][20]*(SH_MAG[11] - SH_MAG[15]) - P[17][20]*(SH_MAG[3] - SH_MAG[4] + SH_MAG[5] - SH_MAG[6]) + SH_MAG[2]*(P[20][0] + P[0][0]*SH_MAG[2] + P[1][0]*SH_MAG[1] + P[2][0]*SH_MAG[0] - P[3][0]*SH_MAG[14] + P[16][0]*(SH_MAG[11] - SH_MAG[15]) - P[17][0]*(SH_MAG[3] - SH_MAG[4] + SH_MAG[5] - SH_MAG[6]) + P[18][0]*(SH_MAG[9] + SH_MAG[12])) + SH_MAG[1]*(P[20][1] + P[0][1]*SH_MAG[2] + P[1][1]*SH_MAG[1] + P[2][1]*SH_MAG[0] - P[3][1]*SH_MAG[14] + P[16][1]*(SH_MAG[11] - SH_MAG[15]) - P[17][1]*(SH_MAG[3] - SH_MAG[4] + SH_MAG[5] - SH_MAG[6]) + P[18][1]*(SH_MAG[9] + SH_MAG[12])) + SH_MAG[0]*(P[20][2] + P[0][2]*SH_MAG[2] + P[1][2]*SH_MAG[1] + P[2][2]*SH_MAG[0] - P[3][2]*SH_MAG[14] + P[16][2]*(SH_MAG[11] - SH_MAG[15]) - P[17][2]*(SH_MAG[3] - SH_MAG[4] + SH_MAG[5] - SH_MAG[6]) + P[18][2]*(SH_MAG[9] + SH_MAG[12])) - SH_MAG[14]*(P[20][3] + P[0][3]*SH_MAG[2] + P[1][3]*SH_MAG[1] + P[2][3]*SH_MAG[0] - P[3][3]*SH_MAG[14] + P[16][3]*(SH_MAG[11] - SH_MAG[15]) - P[17][3]*(SH_MAG[3] - SH_MAG[4] + SH_MAG[5] - SH_MAG[6]) + P[18][3]*(SH_MAG[9] + SH_MAG[12])) + (SH_MAG[11] - SH_MAG[15])*(P[20][16] + P[0][16]*SH_MAG[2] + P[1][16]*SH_MAG[1] + P[2][16]*SH_MAG[0] - P[3][16]*SH_MAG[14] + P[16][16]*(SH_MAG[11] - SH_MAG[15]) - P[17][16]*(SH_MAG[3] - SH_MAG[4] + SH_MAG[5] - SH_MAG[6]) + P[18][16]*(SH_MAG[9] + SH_MAG[12])) - (SH_MAG[3] - SH_MAG[4] + SH_MAG[5] - SH_MAG[6])*(P[20][17] + P[0][17]*SH_MAG[2] + P[1][17]*SH_MAG[1] + P[2][17]*SH_MAG[0] - P[3][17]*SH_MAG[14] + P[16][17]*(SH_MAG[11] - SH_MAG[15]) - P[17][17]*(SH_MAG[3] - SH_MAG[4] + SH_MAG[5] - SH_MAG[6]) + P[18][17]*(SH_MAG[9] + SH_MAG[12])) + P[18][20]*(SH_MAG[9] + SH_MAG[12]) + (SH_MAG[9] + SH_MAG[12])*(P[20][18] + P[0][18]*SH_MAG[2] + P[1][18]*SH_MAG[1] + P[2][18]*SH_MAG[0] - P[3][18]*SH_MAG[14] + P[16][18]*(SH_MAG[11] - SH_MAG[15]) - P[17][18]*(SH_MAG[3] - SH_MAG[4] + SH_MAG[5] - SH_MAG[6]) + P[18][18]*(SH_MAG[9] + SH_MAG[12])));
SK_MY[1] = SH_MAG[3] - SH_MAG[4] + SH_MAG[5] - SH_MAG[6];
SK_MY[2] = SH_MAG[11] - SH_MAG[15];
SK_MY[3] = SH_MAG[9] + SH_MAG[12];
float Kfusion[22][1];
float Kfusion[1][1];
Kfusion[0] = SK_MY[0]*(P[0][20] + P[0][0]*SH_MAG[2] + P[0][1]*SH_MAG[1] + P[0][2]*SH_MAG[0] - P[0][3]*SH_MAG[14] + P[0][16]*SK_MY[2] - P[0][17]*SK_MY[1] + P[0][18]*SK_MY[3]);
Kfusion[1] = SK_MY[0]*(P[1][20] + P[1][0]*SH_MAG[2] + P[1][1]*SH_MAG[1] + P[1][2]*SH_MAG[0] - P[1][3]*SH_MAG[14] + P[1][16]*SK_MY[2] - P[1][17]*SK_MY[1] + P[1][18]*SK_MY[3]);
Kfusion[2] = SK_MY[0]*(P[2][20] + P[2][0]*SH_MAG[2] + P[2][1]*SH_MAG[1] + P[2][2]*SH_MAG[0] - P[2][3]*SH_MAG[14] + P[2][16]*SK_MY[2] - P[2][17]*SK_MY[1] + P[2][18]*SK_MY[3]);
Kfusion[3] = SK_MY[0]*(P[3][20] + P[3][0]*SH_MAG[2] + P[3][1]*SH_MAG[1] + P[3][2]*SH_MAG[0] - P[3][3]*SH_MAG[14] + P[3][16]*SK_MY[2] - P[3][17]*SK_MY[1] + P[3][18]*SK_MY[3]);
Kfusion[4] = SK_MY[0]*(P[4][20] + P[4][0]*SH_MAG[2] + P[4][1]*SH_MAG[1] + P[4][2]*SH_MAG[0] - P[4][3]*SH_MAG[14] + P[4][16]*SK_MY[2] - P[4][17]*SK_MY[1] + P[4][18]*SK_MY[3]);
Kfusion[5] = SK_MY[0]*(P[5][20] + P[5][0]*SH_MAG[2] + P[5][1]*SH_MAG[1] + P[5][2]*SH_MAG[0] - P[5][3]*SH_MAG[14] + P[5][16]*SK_MY[2] - P[5][17]*SK_MY[1] + P[5][18]*SK_MY[3]);
Kfusion[6] = SK_MY[0]*(P[6][20] + P[6][0]*SH_MAG[2] + P[6][1]*SH_MAG[1] + P[6][2]*SH_MAG[0] - P[6][3]*SH_MAG[14] + P[6][16]*SK_MY[2] - P[6][17]*SK_MY[1] + P[6][18]*SK_MY[3]);
Kfusion[7] = SK_MY[0]*(P[7][20] + P[7][0]*SH_MAG[2] + P[7][1]*SH_MAG[1] + P[7][2]*SH_MAG[0] - P[7][3]*SH_MAG[14] + P[7][16]*SK_MY[2] - P[7][17]*SK_MY[1] + P[7][18]*SK_MY[3]);
Kfusion[8] = SK_MY[0]*(P[8][20] + P[8][0]*SH_MAG[2] + P[8][1]*SH_MAG[1] + P[8][2]*SH_MAG[0] - P[8][3]*SH_MAG[14] + P[8][16]*SK_MY[2] - P[8][17]*SK_MY[1] + P[8][18]*SK_MY[3]);
Kfusion[9] = SK_MY[0]*(P[9][20] + P[9][0]*SH_MAG[2] + P[9][1]*SH_MAG[1] + P[9][2]*SH_MAG[0] - P[9][3]*SH_MAG[14] + P[9][16]*SK_MY[2] - P[9][17]*SK_MY[1] + P[9][18]*SK_MY[3]);
Kfusion[10] = SK_MY[0]*(P[10][20] + P[10][0]*SH_MAG[2] + P[10][1]*SH_MAG[1] + P[10][2]*SH_MAG[0] - P[10][3]*SH_MAG[14] + P[10][16]*SK_MY[2] - P[10][17]*SK_MY[1] + P[10][18]*SK_MY[3]);
Kfusion[11] = SK_MY[0]*(P[11][20] + P[11][0]*SH_MAG[2] + P[11][1]*SH_MAG[1] + P[11][2]*SH_MAG[0] - P[11][3]*SH_MAG[14] + P[11][16]*SK_MY[2] - P[11][17]*SK_MY[1] + P[11][18]*SK_MY[3]);
Kfusion[12] = SK_MY[0]*(P[12][20] + P[12][0]*SH_MAG[2] + P[12][1]*SH_MAG[1] + P[12][2]*SH_MAG[0] - P[12][3]*SH_MAG[14] + P[12][16]*SK_MY[2] - P[12][17]*SK_MY[1] + P[12][18]*SK_MY[3]);
Kfusion[13] = SK_MY[0]*(P[13][20] + P[13][0]*SH_MAG[2] + P[13][1]*SH_MAG[1] + P[13][2]*SH_MAG[0] - P[13][3]*SH_MAG[14] + P[13][16]*SK_MY[2] - P[13][17]*SK_MY[1] + P[13][18]*SK_MY[3]);
Kfusion[14] = SK_MY[0]*(P[14][20] + P[14][0]*SH_MAG[2] + P[14][1]*SH_MAG[1] + P[14][2]*SH_MAG[0] - P[14][3]*SH_MAG[14] + P[14][16]*SK_MY[2] - P[14][17]*SK_MY[1] + P[14][18]*SK_MY[3]);
Kfusion[15] = SK_MY[0]*(P[15][20] + P[15][0]*SH_MAG[2] + P[15][1]*SH_MAG[1] + P[15][2]*SH_MAG[0] - P[15][3]*SH_MAG[14] + P[15][16]*SK_MY[2] - P[15][17]*SK_MY[1] + P[15][18]*SK_MY[3]);
Kfusion[16] = SK_MY[0]*(P[16][20] + P[16][0]*SH_MAG[2] + P[16][1]*SH_MAG[1] + P[16][2]*SH_MAG[0] - P[16][3]*SH_MAG[14] + P[16][16]*SK_MY[2] - P[16][17]*SK_MY[1] + P[16][18]*SK_MY[3]);
Kfusion[17] = SK_MY[0]*(P[17][20] + P[17][0]*SH_MAG[2] + P[17][1]*SH_MAG[1] + P[17][2]*SH_MAG[0] - P[17][3]*SH_MAG[14] + P[17][16]*SK_MY[2] - P[17][17]*SK_MY[1] + P[17][18]*SK_MY[3]);
Kfusion[18] = SK_MY[0]*(P[18][20] + P[18][0]*SH_MAG[2] + P[18][1]*SH_MAG[1] + P[18][2]*SH_MAG[0] - P[18][3]*SH_MAG[14] + P[18][16]*SK_MY[2] - P[18][17]*SK_MY[1] + P[18][18]*SK_MY[3]);
Kfusion[19] = SK_MY[0]*(P[19][20] + P[19][0]*SH_MAG[2] + P[19][1]*SH_MAG[1] + P[19][2]*SH_MAG[0] - P[19][3]*SH_MAG[14] + P[19][16]*SK_MY[2] - P[19][17]*SK_MY[1] + P[19][18]*SK_MY[3]);
Kfusion[20] = SK_MY[0]*(P[20][20] + P[20][0]*SH_MAG[2] + P[20][1]*SH_MAG[1] + P[20][2]*SH_MAG[0] - P[20][3]*SH_MAG[14] + P[20][16]*SK_MY[2] - P[20][17]*SK_MY[1] + P[20][18]*SK_MY[3]);
Kfusion[21] = SK_MY[0]*(P[21][20] + P[21][0]*SH_MAG[2] + P[21][1]*SH_MAG[1] + P[21][2]*SH_MAG[0] - P[21][3]*SH_MAG[14] + P[21][16]*SK_MY[2] - P[21][17]*SK_MY[1] + P[21][18]*SK_MY[3]);
float H_MAG[1][22];
H_MAG[0] = SH_MAG[1];
H_MAG[1] = -SH_MAG[2];
H_MAG[2] = SH_MAG[14];
H_MAG[3] = SH_MAG[0];
H_MAG[16] = SH_MAG[10] + 2*q0*q2;
H_MAG[17] = SH_MAG[9] - SH_MAG[12];
H_MAG[18] = SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6];
H_MAG[21] = 1;
float SK_MZ[4][1];
SK_MZ[0] = 1/(P[21][21] + R_MAG + P[0][21]*SH_MAG[1] - P[1][21]*SH_MAG[2] + P[2][21]*SH_MAG[14] + P[3][21]*SH_MAG[0] + P[17][21]*(SH_MAG[9] - SH_MAG[12]) + P[18][21]*(SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6]) + SH_MAG[1]*(P[21][0] + P[0][0]*SH_MAG[1] - P[1][0]*SH_MAG[2] + P[3][0]*SH_MAG[0] + P[2][0]*SH_MAG[14] + P[17][0]*(SH_MAG[9] - SH_MAG[12]) + P[18][0]*(SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6]) + P[16][0]*(SH_MAG[10] + 2*q0*q2)) - SH_MAG[2]*(P[21][1] + P[0][1]*SH_MAG[1] - P[1][1]*SH_MAG[2] + P[3][1]*SH_MAG[0] + P[2][1]*SH_MAG[14] + P[17][1]*(SH_MAG[9] - SH_MAG[12]) + P[18][1]*(SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6]) + P[16][1]*(SH_MAG[10] + 2*q0*q2)) + SH_MAG[0]*(P[21][3] + P[0][3]*SH_MAG[1] - P[1][3]*SH_MAG[2] + P[3][3]*SH_MAG[0] + P[2][3]*SH_MAG[14] + P[17][3]*(SH_MAG[9] - SH_MAG[12]) + P[18][3]*(SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6]) + P[16][3]*(SH_MAG[10] + 2*q0*q2)) + SH_MAG[14]*(P[21][2] + P[0][2]*SH_MAG[1] - P[1][2]*SH_MAG[2] + P[3][2]*SH_MAG[0] + P[2][2]*SH_MAG[14] + P[17][2]*(SH_MAG[9] - SH_MAG[12]) + P[18][2]*(SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6]) + P[16][2]*(SH_MAG[10] + 2*q0*q2)) + (SH_MAG[9] - SH_MAG[12])*(P[21][17] + P[0][17]*SH_MAG[1] - P[1][17]*SH_MAG[2] + P[2][17]*SH_MAG[14] + P[3][17]*SH_MAG[0] + P[17][17]*(SH_MAG[9] - SH_MAG[12]) + P[18][17]*(SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6]) + P[16][17]*(SH_MAG[10] + 2*q0*q2)) + (SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6])*(P[21][18] + P[0][18]*SH_MAG[1] - P[1][18]*SH_MAG[2] + P[2][18]*SH_MAG[14] + P[3][18]*SH_MAG[0] + P[17][18]*(SH_MAG[9] - SH_MAG[12]) + P[18][18]*(SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6]) + P[16][18]*(SH_MAG[10] + 2*q0*q2)) + P[16][21]*(SH_MAG[10] + 2*q0*q2) + (SH_MAG[10] + 2*q0*q2)*(P[21][16] + P[0][16]*SH_MAG[1] - P[1][16]*SH_MAG[2] + P[2][16]*SH_MAG[14] + P[3][16]*SH_MAG[0] + P[17][16]*(SH_MAG[9] - SH_MAG[12]) + P[18][16]*(SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6]) + P[16][16]*(SH_MAG[10] + 2*q0*q2)));
SK_MZ[1] = SH_MAG[3] - SH_MAG[4] - SH_MAG[5] + SH_MAG[6];
SK_MZ[2] = SH_MAG[10] + 2*q0*q2;
SK_MZ[3] = SH_MAG[9] - SH_MAG[12];
float Kfusion[22][1];
float Kfusion[1][1];
Kfusion[0] = SK_MZ[0]*(P[0][21] + P[0][0]*SH_MAG[1] - P[0][1]*SH_MAG[2] + P[0][3]*SH_MAG[0] + P[0][2]*SH_MAG[14] + P[0][16]*SK_MZ[2] + P[0][18]*SK_MZ[1] + P[0][17]*SK_MZ[3]);
Kfusion[1] = SK_MZ[0]*(P[1][21] + P[1][0]*SH_MAG[1] - P[1][1]*SH_MAG[2] + P[1][3]*SH_MAG[0] + P[1][2]*SH_MAG[14] + P[1][16]*SK_MZ[2] + P[1][18]*SK_MZ[1] + P[1][17]*SK_MZ[3]);
Kfusion[2] = SK_MZ[0]*(P[2][21] + P[2][0]*SH_MAG[1] - P[2][1]*SH_MAG[2] + P[2][3]*SH_MAG[0] + P[2][2]*SH_MAG[14] + P[2][16]*SK_MZ[2] + P[2][18]*SK_MZ[1] + P[2][17]*SK_MZ[3]);
Kfusion[3] = SK_MZ[0]*(P[3][21] + P[3][0]*SH_MAG[1] - P[3][1]*SH_MAG[2] + P[3][3]*SH_MAG[0] + P[3][2]*SH_MAG[14] + P[3][16]*SK_MZ[2] + P[3][18]*SK_MZ[1] + P[3][17]*SK_MZ[3]);
Kfusion[4] = SK_MZ[0]*(P[4][21] + P[4][0]*SH_MAG[1] - P[4][1]*SH_MAG[2] + P[4][3]*SH_MAG[0] + P[4][2]*SH_MAG[14] + P[4][16]*SK_MZ[2] + P[4][18]*SK_MZ[1] + P[4][17]*SK_MZ[3]);
Kfusion[5] = SK_MZ[0]*(P[5][21] + P[5][0]*SH_MAG[1] - P[5][1]*SH_MAG[2] + P[5][3]*SH_MAG[0] + P[5][2]*SH_MAG[14] + P[5][16]*SK_MZ[2] + P[5][18]*SK_MZ[1] + P[5][17]*SK_MZ[3]);
Kfusion[6] = SK_MZ[0]*(P[6][21] + P[6][0]*SH_MAG[1] - P[6][1]*SH_MAG[2] + P[6][3]*SH_MAG[0] + P[6][2]*SH_MAG[14] + P[6][16]*SK_MZ[2] + P[6][18]*SK_MZ[1] + P[6][17]*SK_MZ[3]);
Kfusion[7] = SK_MZ[0]*(P[7][21] + P[7][0]*SH_MAG[1] - P[7][1]*SH_MAG[2] + P[7][3]*SH_MAG[0] + P[7][2]*SH_MAG[14] + P[7][16]*SK_MZ[2] + P[7][18]*SK_MZ[1] + P[7][17]*SK_MZ[3]);
Kfusion[8] = SK_MZ[0]*(P[8][21] + P[8][0]*SH_MAG[1] - P[8][1]*SH_MAG[2] + P[8][3]*SH_MAG[0] + P[8][2]*SH_MAG[14] + P[8][16]*SK_MZ[2] + P[8][18]*SK_MZ[1] + P[8][17]*SK_MZ[3]);
Kfusion[9] = SK_MZ[0]*(P[9][21] + P[9][0]*SH_MAG[1] - P[9][1]*SH_MAG[2] + P[9][3]*SH_MAG[0] + P[9][2]*SH_MAG[14] + P[9][16]*SK_MZ[2] + P[9][18]*SK_MZ[1] + P[9][17]*SK_MZ[3]);
Kfusion[10] = SK_MZ[0]*(P[10][21] + P[10][0]*SH_MAG[1] - P[10][1]*SH_MAG[2] + P[10][3]*SH_MAG[0] + P[10][2]*SH_MAG[14] + P[10][16]*SK_MZ[2] + P[10][18]*SK_MZ[1] + P[10][17]*SK_MZ[3]);
Kfusion[11] = SK_MZ[0]*(P[11][21] + P[11][0]*SH_MAG[1] - P[11][1]*SH_MAG[2] + P[11][3]*SH_MAG[0] + P[11][2]*SH_MAG[14] + P[11][16]*SK_MZ[2] + P[11][18]*SK_MZ[1] + P[11][17]*SK_MZ[3]);
Kfusion[12] = SK_MZ[0]*(P[12][21] + P[12][0]*SH_MAG[1] - P[12][1]*SH_MAG[2] + P[12][3]*SH_MAG[0] + P[12][2]*SH_MAG[14] + P[12][16]*SK_MZ[2] + P[12][18]*SK_MZ[1] + P[12][17]*SK_MZ[3]);
Kfusion[13] = SK_MZ[0]*(P[13][21] + P[13][0]*SH_MAG[1] - P[13][1]*SH_MAG[2] + P[13][3]*SH_MAG[0] + P[13][2]*SH_MAG[14] + P[13][16]*SK_MZ[2] + P[13][18]*SK_MZ[1] + P[13][17]*SK_MZ[3]);
Kfusion[14] = SK_MZ[0]*(P[14][21] + P[14][0]*SH_MAG[1] - P[14][1]*SH_MAG[2] + P[14][3]*SH_MAG[0] + P[14][2]*SH_MAG[14] + P[14][16]*SK_MZ[2] + P[14][18]*SK_MZ[1] + P[14][17]*SK_MZ[3]);
Kfusion[15] = SK_MZ[0]*(P[15][21] + P[15][0]*SH_MAG[1] - P[15][1]*SH_MAG[2] + P[15][3]*SH_MAG[0] + P[15][2]*SH_MAG[14] + P[15][16]*SK_MZ[2] + P[15][18]*SK_MZ[1] + P[15][17]*SK_MZ[3]);
Kfusion[16] = SK_MZ[0]*(P[16][21] + P[16][0]*SH_MAG[1] - P[16][1]*SH_MAG[2] + P[16][3]*SH_MAG[0] + P[16][2]*SH_MAG[14] + P[16][16]*SK_MZ[2] + P[16][18]*SK_MZ[1] + P[16][17]*SK_MZ[3]);
Kfusion[17] = SK_MZ[0]*(P[17][21] + P[17][0]*SH_MAG[1] - P[17][1]*SH_MAG[2] + P[17][3]*SH_MAG[0] + P[17][2]*SH_MAG[14] + P[17][16]*SK_MZ[2] + P[17][18]*SK_MZ[1] + P[17][17]*SK_MZ[3]);
Kfusion[18] = SK_MZ[0]*(P[18][21] + P[18][0]*SH_MAG[1] - P[18][1]*SH_MAG[2] + P[18][3]*SH_MAG[0] + P[18][2]*SH_MAG[14] + P[18][16]*SK_MZ[2] + P[18][18]*SK_MZ[1] + P[18][17]*SK_MZ[3]);
Kfusion[19] = SK_MZ[0]*(P[19][21] + P[19][0]*SH_MAG[1] - P[19][1]*SH_MAG[2] + P[19][3]*SH_MAG[0] + P[19][2]*SH_MAG[14] + P[19][16]*SK_MZ[2] + P[19][18]*SK_MZ[1] + P[19][17]*SK_MZ[3]);
Kfusion[20] = SK_MZ[0]*(P[20][21] + P[20][0]*SH_MAG[1] - P[20][1]*SH_MAG[2] + P[20][3]*SH_MAG[0] + P[20][2]*SH_MAG[14] + P[20][16]*SK_MZ[2] + P[20][18]*SK_MZ[1] + P[20][17]*SK_MZ[3]);
Kfusion[21] = SK_MZ[0]*(P[21][21] + P[21][0]*SH_MAG[1] - P[21][1]*SH_MAG[2] + P[21][3]*SH_MAG[0] + P[21][2]*SH_MAG[14] + P[21][16]*SK_MZ[2] + P[21][18]*SK_MZ[1] + P[21][17]*SK_MZ[3]);
float SH_LOS[14][1];
SH_LOS[0] = sq(q0) - sq(q1) - sq(q2) + sq(q3);
SH_LOS[1] = vn*(sq(q0) + sq(q1) - sq(q2) - sq(q3)) - vd*(2*q0*q2 - 2*q1*q3) + ve*(2*q0*q3 + 2*q1*q2);
SH_LOS[2] = ve*(sq(q0) - sq(q1) + sq(q2) - sq(q3)) + vd*(2*q0*q1 + 2*q2*q3) - vn*(2*q0*q3 - 2*q1*q2);
SH_LOS[3] = 1/(pd - ptd);
SH_LOS[4] = SH_LOS[0]*SH_LOS[3]*(2*q3*ve - 2*q2*vd + 2*q0*vn);
SH_LOS[5] = 2*q1*vd + 2*q0*ve - 2*q3*vn;
SH_LOS[6] = 2*q0*vd - 2*q1*ve + 2*q2*vn;
SH_LOS[7] = 2*q3*vd + 2*q2*ve + 2*q1*vn;
SH_LOS[8] = sq(q1);
SH_LOS[9] = 2*q0*q3;
SH_LOS[10] = sq(SH_LOS[3]);
SH_LOS[11] = sq(q3);
SH_LOS[12] = sq(q2);
SH_LOS[13] = sq(q0);
float H_LOS[1][22];
H_LOS[0] = - SH_LOS[0]*SH_LOS[3]*SH_LOS[5] - 2*SH_LOS[2]*SH_LOS[3]*q0;
H_LOS[1] = 2*SH_LOS[2]*SH_LOS[3]*q1 - SH_LOS[0]*SH_LOS[3]*SH_LOS[6];
H_LOS[2] = 2*SH_LOS[2]*SH_LOS[3]*q2 - SH_LOS[0]*SH_LOS[3]*SH_LOS[7];
H_LOS[3] = SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3;
H_LOS[4] = SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2);
H_LOS[5] = SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]);
H_LOS[6] = -SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3);
H_LOS[9] = SH_LOS[0]*SH_LOS[2]*SH_LOS[10];
float H_LOS[1][22];
H_LOS[0] = SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0;
H_LOS[1] = SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1;
H_LOS[2] = - SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[1]*SH_LOS[3]*q2;
H_LOS[3] = SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3;
H_LOS[4] = SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]);
H_LOS[5] = SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2);
H_LOS[6] = -SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3);
H_LOS[9] = -SH_LOS[0]*SH_LOS[1]*SH_LOS[10];
float SK_LOS[16][1];
SK_LOS[0] = 1/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
SK_LOS[1] = 1/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
SK_LOS[2] = SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13];
SK_LOS[3] = SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1;
SK_LOS[4] = SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13];
SK_LOS[5] = 2*q0*q2 - 2*q1*q3;
SK_LOS[6] = SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3;
SK_LOS[7] = SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2;
SK_LOS[8] = 2*q0*q1 + 2*q2*q3;
SK_LOS[9] = SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2;
SK_LOS[10] = SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1;
SK_LOS[11] = SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0;
SK_LOS[12] = SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3;
SK_LOS[13] = SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0;
SK_LOS[14] = SH_LOS[9] - 2*q1*q2;
SK_LOS[15] = SH_LOS[9] + 2*q1*q2;
float Kfusion[22][1];
float Kfusion[1][1];
Kfusion[0] = (P[0][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[0][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[0][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[0][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[0][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
Kfusion[1] = (P[1][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[1][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[1][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[1][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[1][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
Kfusion[2] = (P[2][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[2][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[2][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[2][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[2][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
Kfusion[3] = (P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[3][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[3][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[3][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[3][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
Kfusion[4] = (P[4][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[4][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[4][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[4][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[4][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[4][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
Kfusion[5] = (P[5][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[5][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[5][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[5][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[5][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[5][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
Kfusion[6] = (P[6][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[6][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[6][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[6][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[6][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[6][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[6][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
Kfusion[7] = (P[7][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[7][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[7][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[7][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[7][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[7][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[7][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[7][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
Kfusion[8] = (P[8][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[8][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[8][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[8][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[8][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[8][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[8][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[8][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
Kfusion[9] = (P[9][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[9][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[9][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[9][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[9][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[9][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[9][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
Kfusion[10] = (P[10][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[10][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[10][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[10][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[10][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[10][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[10][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[10][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
Kfusion[11] = (P[11][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[11][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[11][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[11][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[11][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[11][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[11][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[11][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
Kfusion[12] = (P[12][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[12][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[12][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[12][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[12][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[12][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[12][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[12][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
Kfusion[13] = (P[13][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[13][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[13][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[13][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[13][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[13][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[13][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[13][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
Kfusion[14] = (P[14][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[14][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[14][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[14][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[14][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[14][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[14][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[14][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
Kfusion[15] = (P[15][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[15][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[15][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[15][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[15][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[15][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[15][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[15][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
Kfusion[16] = (P[16][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[16][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[16][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[16][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[16][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[16][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[16][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[16][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
Kfusion[17] = (P[17][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[17][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[17][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[17][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[17][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[17][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[17][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[17][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
Kfusion[18] = (P[18][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[18][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[18][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[18][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[18][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[18][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[18][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[18][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
Kfusion[19] = (P[19][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[19][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[19][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[19][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[19][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[19][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[19][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[19][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
Kfusion[20] = (P[20][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[20][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[20][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[20][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[20][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[20][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[20][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[20][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
Kfusion[21] = (P[21][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[21][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[21][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[21][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[21][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[21][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[21][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[21][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13]))/(R_LOS + (SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3)*(P[3][3]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][3]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0)*(P[3][0]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][0]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1)*(P[3][1]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][1]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2)*(P[3][2]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][2]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[2]*SH_LOS[10]*(P[3][9]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][9]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])*(P[3][5]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][5]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3)*(P[3][6]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][6]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2)*(P[3][4]*(SH_LOS[4] - 2*SH_LOS[2]*SH_LOS[3]*q3) - P[0][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[2]*SH_LOS[3]*q0) - P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] - 2*SH_LOS[2]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[2]*SH_LOS[3]*q2) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q1 + 2*q2*q3) + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] - 2*q1*q2) + P[9][4]*SH_LOS[0]*SH_LOS[2]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] + SH_LOS[11] - SH_LOS[12] - SH_LOS[13])));
float Kfusion[22][1];
float Kfusion[1][1];
Kfusion[0] = (P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[0][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[0][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[0][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[0][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[0][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[0][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[0][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
Kfusion[1] = (P[1][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[1][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[1][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[1][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[1][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
Kfusion[2] = (P[2][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[2][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[2][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[2][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[2][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
Kfusion[3] = (P[3][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[3][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[3][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[3][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[3][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
Kfusion[4] = (P[4][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[4][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[4][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[4][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[4][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[4][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
Kfusion[5] = (P[5][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[5][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[5][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[5][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[5][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[5][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
Kfusion[6] = (P[6][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[6][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[6][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[6][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[6][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[6][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[6][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
Kfusion[7] = (P[7][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[7][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[7][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[7][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[7][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[7][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[7][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[7][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
Kfusion[8] = (P[8][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[8][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[8][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[8][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[8][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[8][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[8][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[8][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
Kfusion[9] = (P[9][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[9][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[9][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[9][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[9][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[9][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[9][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
Kfusion[10] = (P[10][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[10][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[10][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[10][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[10][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[10][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[10][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[10][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
Kfusion[11] = (P[11][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[11][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[11][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[11][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[11][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[11][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[11][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[11][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
Kfusion[12] = (P[12][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[12][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[12][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[12][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[12][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[12][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[12][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[12][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
Kfusion[13] = (P[13][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[13][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[13][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[13][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[13][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[13][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[13][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[13][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
Kfusion[14] = (P[14][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[14][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[14][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[14][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[14][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[14][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[14][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[14][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
Kfusion[15] = (P[15][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[15][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[15][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[15][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[15][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[15][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[15][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[15][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
Kfusion[16] = (P[16][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[16][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[16][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[16][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[16][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[16][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[16][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[16][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
Kfusion[17] = (P[17][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[17][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[17][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[17][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[17][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[17][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[17][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[17][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
Kfusion[18] = (P[18][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[18][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[18][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[18][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[18][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[18][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[18][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[18][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
Kfusion[19] = (P[19][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[19][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[19][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[19][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[19][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[19][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[19][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[19][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
Kfusion[20] = (P[20][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[20][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[20][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[20][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[20][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[20][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[20][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[20][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
Kfusion[21] = (P[21][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[21][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[21][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[21][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[21][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[21][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[21][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[21][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13]))/(R_LOS + (SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0)*(P[0][0]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][0]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][0]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][0]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][0]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1)*(P[0][1]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][1]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][1]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][1]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][1]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - (SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2)*(P[0][2]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][2]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][2]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][2]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][2]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + (SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3)*(P[0][3]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][3]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][3]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][3]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][3]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[1]*SH_LOS[10]*(P[0][9]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][9]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][9]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][9]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][9]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])*(P[0][4]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][4]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][4]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][4]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][4]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) - SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3)*(P[0][6]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][6]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][6]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][6]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][6]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])) + SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2)*(P[0][5]*(SH_LOS[4] + 2*SH_LOS[1]*SH_LOS[3]*q0) + P[1][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[7] - 2*SH_LOS[1]*SH_LOS[3]*q1) - P[2][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[6] + 2*SH_LOS[1]*SH_LOS[3]*q2) + P[3][5]*(SH_LOS[0]*SH_LOS[3]*SH_LOS[5] + 2*SH_LOS[1]*SH_LOS[3]*q3) - P[6][5]*SH_LOS[0]*SH_LOS[3]*(2*q0*q2 - 2*q1*q3) + P[5][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[9] + 2*q1*q2) - P[9][5]*SH_LOS[0]*SH_LOS[1]*SH_LOS[10] + P[4][5]*SH_LOS[0]*SH_LOS[3]*(SH_LOS[8] - SH_LOS[11] - SH_LOS[12] + SH_LOS[13])));
float SH_RNG[3][1];
SH_RNG[0] = sq(q0) - sq(q1) - sq(q2) + sq(q3);
SH_RNG[1] = pd - ptd;
SH_RNG[2] = 1/sq(SH_RNG[0]);
float H_RNG[1][22];
H_RNG[0][0] = 2*SH_RNG[1]*SH_RNG[2]*q0;
H_RNG[0][1] = -2*SH_RNG[1]*SH_RNG[2]*q1;
H_RNG[0][2] = -2*SH_RNG[1]*SH_RNG[2]*q2;
H_RNG[0][3] = 2*SH_RNG[1]*SH_RNG[2]*q3;
H_RNG[0][9] = -1/SH_RNG[0];
float SK_RNG[2][1];
SK_RNG[0] = 1/(R_RNG + (P[9][9]/SH_RNG[0] - 2*P[0][9]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[1][9]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[2][9]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[3][9]*SH_RNG[1]*SH_RNG[2]*q3)/SH_RNG[0] - 2*SH_RNG[1]*SH_RNG[2]*q0*(P[9][0]/SH_RNG[0] - 2*P[0][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[1][0]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[2][0]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[3][0]*SH_RNG[1]*SH_RNG[2]*q3) + 2*SH_RNG[1]*SH_RNG[2]*q1*(P[9][1]/SH_RNG[0] - 2*P[0][1]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[1][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[2][1]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[3][1]*SH_RNG[1]*SH_RNG[2]*q3) + 2*SH_RNG[1]*SH_RNG[2]*q2*(P[9][2]/SH_RNG[0] - 2*P[0][2]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[1][2]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[2][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[3][2]*SH_RNG[1]*SH_RNG[2]*q3) - 2*SH_RNG[1]*SH_RNG[2]*q3*(P[9][3]/SH_RNG[0] - 2*P[0][3]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[1][3]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[2][3]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[3][3]*SH_RNG[1]*SH_RNG[2]*q3));
SK_RNG[1] = 1/SH_RNG[0];
float Kfusion[22][1];
float Kfusion[1][1];
Kfusion[0] = -SK_RNG[0]*(P[0][9]*SK_RNG[1] - 2*P[0][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[0][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[0][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[0][3]*SH_RNG[1]*SH_RNG[2]*q3);
Kfusion[1] = -SK_RNG[0]*(P[1][9]*SK_RNG[1] - 2*P[1][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[1][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[1][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[1][3]*SH_RNG[1]*SH_RNG[2]*q3);
Kfusion[2] = -SK_RNG[0]*(P[2][9]*SK_RNG[1] - 2*P[2][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[2][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[2][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[2][3]*SH_RNG[1]*SH_RNG[2]*q3);
Kfusion[3] = -SK_RNG[0]*(P[3][9]*SK_RNG[1] - 2*P[3][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[3][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[3][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[3][3]*SH_RNG[1]*SH_RNG[2]*q3);
Kfusion[4] = -SK_RNG[0]*(P[4][9]*SK_RNG[1] - 2*P[4][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[4][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[4][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[4][3]*SH_RNG[1]*SH_RNG[2]*q3);
Kfusion[5] = -SK_RNG[0]*(P[5][9]*SK_RNG[1] - 2*P[5][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[5][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[5][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[5][3]*SH_RNG[1]*SH_RNG[2]*q3);
Kfusion[6] = -SK_RNG[0]*(P[6][9]*SK_RNG[1] - 2*P[6][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[6][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[6][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[6][3]*SH_RNG[1]*SH_RNG[2]*q3);
Kfusion[7] = -SK_RNG[0]*(P[7][9]*SK_RNG[1] - 2*P[7][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[7][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[7][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[7][3]*SH_RNG[1]*SH_RNG[2]*q3);
Kfusion[8] = -SK_RNG[0]*(P[8][9]*SK_RNG[1] - 2*P[8][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[8][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[8][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[8][3]*SH_RNG[1]*SH_RNG[2]*q3);
Kfusion[9] = -SK_RNG[0]*(P[9][9]*SK_RNG[1] - 2*P[9][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[9][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[9][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[9][3]*SH_RNG[1]*SH_RNG[2]*q3);
Kfusion[10] = -SK_RNG[0]*(P[10][9]*SK_RNG[1] - 2*P[10][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[10][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[10][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[10][3]*SH_RNG[1]*SH_RNG[2]*q3);
Kfusion[11] = -SK_RNG[0]*(P[11][9]*SK_RNG[1] - 2*P[11][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[11][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[11][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[11][3]*SH_RNG[1]*SH_RNG[2]*q3);
Kfusion[12] = -SK_RNG[0]*(P[12][9]*SK_RNG[1] - 2*P[12][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[12][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[12][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[12][3]*SH_RNG[1]*SH_RNG[2]*q3);
Kfusion[13] = -SK_RNG[0]*(P[13][9]*SK_RNG[1] - 2*P[13][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[13][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[13][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[13][3]*SH_RNG[1]*SH_RNG[2]*q3);
Kfusion[14] = -SK_RNG[0]*(P[14][9]*SK_RNG[1] - 2*P[14][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[14][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[14][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[14][3]*SH_RNG[1]*SH_RNG[2]*q3);
Kfusion[15] = -SK_RNG[0]*(P[15][9]*SK_RNG[1] - 2*P[15][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[15][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[15][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[15][3]*SH_RNG[1]*SH_RNG[2]*q3);
Kfusion[16] = -SK_RNG[0]*(P[16][9]*SK_RNG[1] - 2*P[16][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[16][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[16][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[16][3]*SH_RNG[1]*SH_RNG[2]*q3);
Kfusion[17] = -SK_RNG[0]*(P[17][9]*SK_RNG[1] - 2*P[17][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[17][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[17][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[17][3]*SH_RNG[1]*SH_RNG[2]*q3);
Kfusion[18] = -SK_RNG[0]*(P[18][9]*SK_RNG[1] - 2*P[18][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[18][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[18][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[18][3]*SH_RNG[1]*SH_RNG[2]*q3);
Kfusion[19] = -SK_RNG[0]*(P[19][9]*SK_RNG[1] - 2*P[19][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[19][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[19][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[19][3]*SH_RNG[1]*SH_RNG[2]*q3);
Kfusion[20] = -SK_RNG[0]*(P[20][9]*SK_RNG[1] - 2*P[20][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[20][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[20][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[20][3]*SH_RNG[1]*SH_RNG[2]*q3);
Kfusion[21] = -SK_RNG[0]*(P[21][9]*SK_RNG[1] - 2*P[21][0]*SH_RNG[1]*SH_RNG[2]*q0 + 2*P[21][1]*SH_RNG[1]*SH_RNG[2]*q1 + 2*P[21][2]*SH_RNG[1]*SH_RNG[2]*q2 - 2*P[21][3]*SH_RNG[1]*SH_RNG[2]*q3);
float SH_MAGS[23][1];
SH_MAGS[0] = magN*q0^4 + magN*q1^4 + magN*q2^4 + magN*q3^4 + magX*sq(q0) + magX*sq(q1) - magX*sq(q2) - magX*sq(q3) + 2*magN*sq(q0)*sq(q1) + 2*magN*sq(q0)*sq(q2) + 2*magN*sq(q0)*sq(q3) + 2*magN*sq(q1)*sq(q2) + 2*magN*sq(q1)*sq(q3) + 2*magN*sq(q2)*sq(q3) - 2*magY*q0*q3 + 2*magY*q1*q2 + 2*magZ*q0*q2 + 2*magZ*q1*q3;
SH_MAGS[1] = magE*q0^4 + magE*q1^4 + magE*q2^4 + magE*q3^4 + magY*sq(q0) - magY*sq(q1) + magY*sq(q2) - magY*sq(q3) + 2*magE*sq(q0)*sq(q1) + 2*magE*sq(q0)*sq(q2) + 2*magE*sq(q0)*sq(q3) + 2*magE*sq(q1)*sq(q2) + 2*magE*sq(q1)*sq(q3) + 2*magE*sq(q2)*sq(q3) + 2*magX*q0*q3 + 2*magX*q1*q2 - 2*magZ*q0*q1 + 2*magZ*q2*q3;
SH_MAGS[2] = tansq(SH_MAGS[1]/SH_MAGS[0]) + 1;
SH_MAGS[3] = sq(q0) + sq(q1) + sq(q2) + sq(q3);
SH_MAGS[4] = sq(q3);
SH_MAGS[5] = sq(q2);
SH_MAGS[6] = sq(q1);
SH_MAGS[7] = sq(q0);
SH_MAGS[8] = 1/sq(SH_MAGS[0]);
SH_MAGS[9] = 1/SH_MAGS[0];
SH_MAGS[10] = 2*magZ*q2;
SH_MAGS[11] = 2*magX*q0;
SH_MAGS[12] = 2*magZ*q3;
SH_MAGS[13] = 2*magY*q2;
SH_MAGS[14] = 2*magX*q1;
SH_MAGS[15] = sq(SH_MAGS[7]);
SH_MAGS[16] = sq(SH_MAGS[6]);
SH_MAGS[17] = sq(SH_MAGS[5]);
SH_MAGS[18] = sq(SH_MAGS[4]);
SH_MAGS[19] = sq(SH_MAGS[3]);
SH_MAGS[20] = 2*magX*q3;
SH_MAGS[21] = 2*magY*q0;
SH_MAGS[22] = 2*magX*q2;
float H_MAGS[1][22];
H_MAGS[0] = SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[20] + SH_MAGS[21] - 2*magZ*q1 + 4*SH_MAGS[4]*magE*q0 + 4*SH_MAGS[5]*magE*q0 + 4*SH_MAGS[6]*magE*q0 + 4*SH_MAGS[7]*magE*q0) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magN*q0 + 4*SH_MAGS[5]*magN*q0 + 4*SH_MAGS[6]*magN*q0 + 4*SH_MAGS[7]*magN*q0));
H_MAGS[1] = SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[22] - 2*magY*q1 - 2*magZ*q0 + 4*SH_MAGS[4]*magE*q1 + 4*SH_MAGS[5]*magE*q1 + 4*SH_MAGS[6]*magE*q1 + 4*SH_MAGS[7]*magE*q1) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magN*q1 + 4*SH_MAGS[5]*magN*q1 + 4*SH_MAGS[6]*magN*q1 + 4*SH_MAGS[7]*magN*q1));
H_MAGS[2] = SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magE*q2 + 4*SH_MAGS[5]*magE*q2 + 4*SH_MAGS[6]*magE*q2 + 4*SH_MAGS[7]*magE*q2) - SH_MAGS[1]*SH_MAGS[8]*(2*magY*q1 - SH_MAGS[22] + 2*magZ*q0 + 4*SH_MAGS[4]*magN*q2 + 4*SH_MAGS[5]*magN*q2 + 4*SH_MAGS[6]*magN*q2 + 4*SH_MAGS[7]*magN*q2));
H_MAGS[3] = SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magE*q3 + 4*SH_MAGS[5]*magE*q3 + 4*SH_MAGS[6]*magE*q3 + 4*SH_MAGS[7]*magE*q3) - SH_MAGS[1]*SH_MAGS[8]*(2*magZ*q1 - SH_MAGS[21] - SH_MAGS[20] + 4*SH_MAGS[4]*magN*q3 + 4*SH_MAGS[5]*magN*q3 + 4*SH_MAGS[6]*magN*q3 + 4*SH_MAGS[7]*magN*q3));
H_MAGS[16] = -SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19];
H_MAGS[17] = SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19];
H_MAGS[19] = SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(SH_MAGS[17]*magE - SH_MAGS[16]*magE - SH_MAGS[15]*magE + SH_MAGS[18]*magE - SH_MAGS[4]*magY + SH_MAGS[5]*magY + SH_MAGS[6]*magY - SH_MAGS[7]*magY + SH_MAGS[10]*q3 + 2*SH_MAGS[4]*SH_MAGS[5]*magE - 2*SH_MAGS[6]*SH_MAGS[7]*magE + 2*magZ*q0*q1 + 2*SH_MAGS[4]*magN*q0*q3 + 2*SH_MAGS[4]*magN*q1*q2 + 2*SH_MAGS[5]*magN*q0*q3 + 2*SH_MAGS[5]*magN*q1*q2 + 2*SH_MAGS[6]*magN*q0*q3 + 2*SH_MAGS[6]*magN*q1*q2 + 2*SH_MAGS[7]*magN*q0*q3 + 2*SH_MAGS[7]*magN*q1*q2);
H_MAGS[20] = SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(SH_MAGS[4]*magX - SH_MAGS[5]*magX + SH_MAGS[15]*magN - SH_MAGS[6]*magX - SH_MAGS[16]*magN + SH_MAGS[7]*magX + SH_MAGS[17]*magN - SH_MAGS[18]*magN + SH_MAGS[10]*q0 - 2*SH_MAGS[4]*SH_MAGS[6]*magN + 2*SH_MAGS[5]*SH_MAGS[7]*magN - 2*magZ*q1*q3 + 2*SH_MAGS[4]*magE*q0*q3 - 2*SH_MAGS[4]*magE*q1*q2 + 2*SH_MAGS[5]*magE*q0*q3 - 2*SH_MAGS[5]*magE*q1*q2 + 2*SH_MAGS[6]*magE*q0*q3 - 2*SH_MAGS[6]*magE*q1*q2 + 2*SH_MAGS[7]*magE*q0*q3 - 2*SH_MAGS[7]*magE*q1*q2);
H_MAGS[21] = -2*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(magX*q0*q1 + magY*q0*q2 + magX*q2*q3 - magY*q1*q3 + SH_MAGS[4]*magE*q0*q2 + SH_MAGS[5]*magE*q0*q2 + SH_MAGS[4]*magE*q1*q3 + SH_MAGS[6]*magE*q0*q2 + SH_MAGS[5]*magE*q1*q3 + SH_MAGS[7]*magE*q0*q2 + SH_MAGS[6]*magE*q1*q3 + SH_MAGS[7]*magE*q1*q3 + SH_MAGS[4]*magN*q0*q1 + SH_MAGS[5]*magN*q0*q1 + SH_MAGS[6]*magN*q0*q1 + SH_MAGS[7]*magN*q0*q1 - SH_MAGS[4]*magN*q2*q3 - SH_MAGS[5]*magN*q2*q3 - SH_MAGS[6]*magN*q2*q3 - SH_MAGS[7]*magN*q2*q3);
float SK_MAGS[8][1];
SK_MAGS[0] = 1/(R_MAGS + SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[20] + SH_MAGS[21] - 2*magZ*q1 + 4*SH_MAGS[4]*magE*q0 + 4*SH_MAGS[5]*magE*q0 + 4*SH_MAGS[6]*magE*q0 + 4*SH_MAGS[7]*magE*q0) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magN*q0 + 4*SH_MAGS[5]*magN*q0 + 4*SH_MAGS[6]*magN*q0 + 4*SH_MAGS[7]*magN*q0))*(P[0][0]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[20] + SH_MAGS[21] - 2*magZ*q1 + 4*SH_MAGS[4]*magE*q0 + 4*SH_MAGS[5]*magE*q0 + 4*SH_MAGS[6]*magE*q0 + 4*SH_MAGS[7]*magE*q0) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magN*q0 + 4*SH_MAGS[5]*magN*q0 + 4*SH_MAGS[6]*magN*q0 + 4*SH_MAGS[7]*magN*q0)) + P[1][0]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[22] - 2*magY*q1 - 2*magZ*q0 + 4*SH_MAGS[4]*magE*q1 + 4*SH_MAGS[5]*magE*q1 + 4*SH_MAGS[6]*magE*q1 + 4*SH_MAGS[7]*magE*q1) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magN*q1 + 4*SH_MAGS[5]*magN*q1 + 4*SH_MAGS[6]*magN*q1 + 4*SH_MAGS[7]*magN*q1)) + P[2][0]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magE*q2 + 4*SH_MAGS[5]*magE*q2 + 4*SH_MAGS[6]*magE*q2 + 4*SH_MAGS[7]*magE*q2) - SH_MAGS[1]*SH_MAGS[8]*(2*magY*q1 - SH_MAGS[22] + 2*magZ*q0 + 4*SH_MAGS[4]*magN*q2 + 4*SH_MAGS[5]*magN*q2 + 4*SH_MAGS[6]*magN*q2 + 4*SH_MAGS[7]*magN*q2)) + P[3][0]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magE*q3 + 4*SH_MAGS[5]*magE*q3 + 4*SH_MAGS[6]*magE*q3 + 4*SH_MAGS[7]*magE*q3) - SH_MAGS[1]*SH_MAGS[8]*(2*magZ*q1 - SH_MAGS[21] - SH_MAGS[20] + 4*SH_MAGS[4]*magN*q3 + 4*SH_MAGS[5]*magN*q3 + 4*SH_MAGS[6]*magN*q3 + 4*SH_MAGS[7]*magN*q3)) + P[17][0]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] + P[20][0]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(SH_MAGS[4]*magX - SH_MAGS[5]*magX + SH_MAGS[15]*magN - SH_MAGS[6]*magX - SH_MAGS[16]*magN + SH_MAGS[7]*magX + SH_MAGS[17]*magN - SH_MAGS[18]*magN + SH_MAGS[10]*q0 - 2*SH_MAGS[4]*SH_MAGS[6]*magN + 2*SH_MAGS[5]*SH_MAGS[7]*magN - 2*magZ*q1*q3 + 2*SH_MAGS[4]*magE*q0*q3 - 2*SH_MAGS[4]*magE*q1*q2 + 2*SH_MAGS[5]*magE*q0*q3 - 2*SH_MAGS[5]*magE*q1*q2 + 2*SH_MAGS[6]*magE*q0*q3 - 2*SH_MAGS[6]*magE*q1*q2 + 2*SH_MAGS[7]*magE*q0*q3 - 2*SH_MAGS[7]*magE*q1*q2) + P[19][0]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(SH_MAGS[17]*magE - SH_MAGS[16]*magE - SH_MAGS[15]*magE + SH_MAGS[18]*magE - SH_MAGS[4]*magY + SH_MAGS[5]*magY + SH_MAGS[6]*magY - SH_MAGS[7]*magY + SH_MAGS[10]*q3 + 2*SH_MAGS[4]*SH_MAGS[5]*magE - 2*SH_MAGS[6]*SH_MAGS[7]*magE + 2*magZ*q0*q1 + 2*SH_MAGS[4]*magN*q0*q3 + 2*SH_MAGS[4]*magN*q1*q2 + 2*SH_MAGS[5]*magN*q0*q3 + 2*SH_MAGS[5]*magN*q1*q2 + 2*SH_MAGS[6]*magN*q0*q3 + 2*SH_MAGS[6]*magN*q1*q2 + 2*SH_MAGS[7]*magN*q0*q3 + 2*SH_MAGS[7]*magN*q1*q2) - 2*P[21][0]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(magX*q0*q1 + magY*q0*q2 + magX*q2*q3 - magY*q1*q3 + SH_MAGS[4]*magE*q0*q2 + SH_MAGS[5]*magE*q0*q2 + SH_MAGS[4]*magE*q1*q3 + SH_MAGS[6]*magE*q0*q2 + SH_MAGS[5]*magE*q1*q3 + SH_MAGS[7]*magE*q0*q2 + SH_MAGS[6]*magE*q1*q3 + SH_MAGS[7]*magE*q1*q3 + SH_MAGS[4]*magN*q0*q1 + SH_MAGS[5]*magN*q0*q1 + SH_MAGS[6]*magN*q0*q1 + SH_MAGS[7]*magN*q0*q1 - SH_MAGS[4]*magN*q2*q3 - SH_MAGS[5]*magN*q2*q3 - SH_MAGS[6]*magN*q2*q3 - SH_MAGS[7]*magN*q2*q3) - P[16][0]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19]) + SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[22] - 2*magY*q1 - 2*magZ*q0 + 4*SH_MAGS[4]*magE*q1 + 4*SH_MAGS[5]*magE*q1 + 4*SH_MAGS[6]*magE*q1 + 4*SH_MAGS[7]*magE*q1) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magN*q1 + 4*SH_MAGS[5]*magN*q1 + 4*SH_MAGS[6]*magN*q1 + 4*SH_MAGS[7]*magN*q1))*(P[0][1]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[20] + SH_MAGS[21] - 2*magZ*q1 + 4*SH_MAGS[4]*magE*q0 + 4*SH_MAGS[5]*magE*q0 + 4*SH_MAGS[6]*magE*q0 + 4*SH_MAGS[7]*magE*q0) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magN*q0 + 4*SH_MAGS[5]*magN*q0 + 4*SH_MAGS[6]*magN*q0 + 4*SH_MAGS[7]*magN*q0)) + P[1][1]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[22] - 2*magY*q1 - 2*magZ*q0 + 4*SH_MAGS[4]*magE*q1 + 4*SH_MAGS[5]*magE*q1 + 4*SH_MAGS[6]*magE*q1 + 4*SH_MAGS[7]*magE*q1) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magN*q1 + 4*SH_MAGS[5]*magN*q1 + 4*SH_MAGS[6]*magN*q1 + 4*SH_MAGS[7]*magN*q1)) + P[2][1]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magE*q2 + 4*SH_MAGS[5]*magE*q2 + 4*SH_MAGS[6]*magE*q2 + 4*SH_MAGS[7]*magE*q2) - SH_MAGS[1]*SH_MAGS[8]*(2*magY*q1 - SH_MAGS[22] + 2*magZ*q0 + 4*SH_MAGS[4]*magN*q2 + 4*SH_MAGS[5]*magN*q2 + 4*SH_MAGS[6]*magN*q2 + 4*SH_MAGS[7]*magN*q2)) + P[3][1]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magE*q3 + 4*SH_MAGS[5]*magE*q3 + 4*SH_MAGS[6]*magE*q3 + 4*SH_MAGS[7]*magE*q3) - SH_MAGS[1]*SH_MAGS[8]*(2*magZ*q1 - SH_MAGS[21] - SH_MAGS[20] + 4*SH_MAGS[4]*magN*q3 + 4*SH_MAGS[5]*magN*q3 + 4*SH_MAGS[6]*magN*q3 + 4*SH_MAGS[7]*magN*q3)) + P[17][1]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] + P[20][1]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(SH_MAGS[4]*magX - SH_MAGS[5]*magX + SH_MAGS[15]*magN - SH_MAGS[6]*magX - SH_MAGS[16]*magN + SH_MAGS[7]*magX + SH_MAGS[17]*magN - SH_MAGS[18]*magN + SH_MAGS[10]*q0 - 2*SH_MAGS[4]*SH_MAGS[6]*magN + 2*SH_MAGS[5]*SH_MAGS[7]*magN - 2*magZ*q1*q3 + 2*SH_MAGS[4]*magE*q0*q3 - 2*SH_MAGS[4]*magE*q1*q2 + 2*SH_MAGS[5]*magE*q0*q3 - 2*SH_MAGS[5]*magE*q1*q2 + 2*SH_MAGS[6]*magE*q0*q3 - 2*SH_MAGS[6]*magE*q1*q2 + 2*SH_MAGS[7]*magE*q0*q3 - 2*SH_MAGS[7]*magE*q1*q2) + P[19][1]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(SH_MAGS[17]*magE - SH_MAGS[16]*magE - SH_MAGS[15]*magE + SH_MAGS[18]*magE - SH_MAGS[4]*magY + SH_MAGS[5]*magY + SH_MAGS[6]*magY - SH_MAGS[7]*magY + SH_MAGS[10]*q3 + 2*SH_MAGS[4]*SH_MAGS[5]*magE - 2*SH_MAGS[6]*SH_MAGS[7]*magE + 2*magZ*q0*q1 + 2*SH_MAGS[4]*magN*q0*q3 + 2*SH_MAGS[4]*magN*q1*q2 + 2*SH_MAGS[5]*magN*q0*q3 + 2*SH_MAGS[5]*magN*q1*q2 + 2*SH_MAGS[6]*magN*q0*q3 + 2*SH_MAGS[6]*magN*q1*q2 + 2*SH_MAGS[7]*magN*q0*q3 + 2*SH_MAGS[7]*magN*q1*q2) - 2*P[21][1]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(magX*q0*q1 + magY*q0*q2 + magX*q2*q3 - magY*q1*q3 + SH_MAGS[4]*magE*q0*q2 + SH_MAGS[5]*magE*q0*q2 + SH_MAGS[4]*magE*q1*q3 + SH_MAGS[6]*magE*q0*q2 + SH_MAGS[5]*magE*q1*q3 + SH_MAGS[7]*magE*q0*q2 + SH_MAGS[6]*magE*q1*q3 + SH_MAGS[7]*magE*q1*q3 + SH_MAGS[4]*magN*q0*q1 + SH_MAGS[5]*magN*q0*q1 + SH_MAGS[6]*magN*q0*q1 + SH_MAGS[7]*magN*q0*q1 - SH_MAGS[4]*magN*q2*q3 - SH_MAGS[5]*magN*q2*q3 - SH_MAGS[6]*magN*q2*q3 - SH_MAGS[7]*magN*q2*q3) - P[16][1]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19]) + SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magE*q2 + 4*SH_MAGS[5]*magE*q2 + 4*SH_MAGS[6]*magE*q2 + 4*SH_MAGS[7]*magE*q2) - SH_MAGS[1]*SH_MAGS[8]*(2*magY*q1 - SH_MAGS[22] + 2*magZ*q0 + 4*SH_MAGS[4]*magN*q2 + 4*SH_MAGS[5]*magN*q2 + 4*SH_MAGS[6]*magN*q2 + 4*SH_MAGS[7]*magN*q2))*(P[0][2]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[20] + SH_MAGS[21] - 2*magZ*q1 + 4*SH_MAGS[4]*magE*q0 + 4*SH_MAGS[5]*magE*q0 + 4*SH_MAGS[6]*magE*q0 + 4*SH_MAGS[7]*magE*q0) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magN*q0 + 4*SH_MAGS[5]*magN*q0 + 4*SH_MAGS[6]*magN*q0 + 4*SH_MAGS[7]*magN*q0)) + P[1][2]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[22] - 2*magY*q1 - 2*magZ*q0 + 4*SH_MAGS[4]*magE*q1 + 4*SH_MAGS[5]*magE*q1 + 4*SH_MAGS[6]*magE*q1 + 4*SH_MAGS[7]*magE*q1) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magN*q1 + 4*SH_MAGS[5]*magN*q1 + 4*SH_MAGS[6]*magN*q1 + 4*SH_MAGS[7]*magN*q1)) + P[2][2]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magE*q2 + 4*SH_MAGS[5]*magE*q2 + 4*SH_MAGS[6]*magE*q2 + 4*SH_MAGS[7]*magE*q2) - SH_MAGS[1]*SH_MAGS[8]*(2*magY*q1 - SH_MAGS[22] + 2*magZ*q0 + 4*SH_MAGS[4]*magN*q2 + 4*SH_MAGS[5]*magN*q2 + 4*SH_MAGS[6]*magN*q2 + 4*SH_MAGS[7]*magN*q2)) + P[3][2]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magE*q3 + 4*SH_MAGS[5]*magE*q3 + 4*SH_MAGS[6]*magE*q3 + 4*SH_MAGS[7]*magE*q3) - SH_MAGS[1]*SH_MAGS[8]*(2*magZ*q1 - SH_MAGS[21] - SH_MAGS[20] + 4*SH_MAGS[4]*magN*q3 + 4*SH_MAGS[5]*magN*q3 + 4*SH_MAGS[6]*magN*q3 + 4*SH_MAGS[7]*magN*q3)) + P[17][2]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] + P[20][2]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(SH_MAGS[4]*magX - SH_MAGS[5]*magX + SH_MAGS[15]*magN - SH_MAGS[6]*magX - SH_MAGS[16]*magN + SH_MAGS[7]*magX + SH_MAGS[17]*magN - SH_MAGS[18]*magN + SH_MAGS[10]*q0 - 2*SH_MAGS[4]*SH_MAGS[6]*magN + 2*SH_MAGS[5]*SH_MAGS[7]*magN - 2*magZ*q1*q3 + 2*SH_MAGS[4]*magE*q0*q3 - 2*SH_MAGS[4]*magE*q1*q2 + 2*SH_MAGS[5]*magE*q0*q3 - 2*SH_MAGS[5]*magE*q1*q2 + 2*SH_MAGS[6]*magE*q0*q3 - 2*SH_MAGS[6]*magE*q1*q2 + 2*SH_MAGS[7]*magE*q0*q3 - 2*SH_MAGS[7]*magE*q1*q2) + P[19][2]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(SH_MAGS[17]*magE - SH_MAGS[16]*magE - SH_MAGS[15]*magE + SH_MAGS[18]*magE - SH_MAGS[4]*magY + SH_MAGS[5]*magY + SH_MAGS[6]*magY - SH_MAGS[7]*magY + SH_MAGS[10]*q3 + 2*SH_MAGS[4]*SH_MAGS[5]*magE - 2*SH_MAGS[6]*SH_MAGS[7]*magE + 2*magZ*q0*q1 + 2*SH_MAGS[4]*magN*q0*q3 + 2*SH_MAGS[4]*magN*q1*q2 + 2*SH_MAGS[5]*magN*q0*q3 + 2*SH_MAGS[5]*magN*q1*q2 + 2*SH_MAGS[6]*magN*q0*q3 + 2*SH_MAGS[6]*magN*q1*q2 + 2*SH_MAGS[7]*magN*q0*q3 + 2*SH_MAGS[7]*magN*q1*q2) - 2*P[21][2]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(magX*q0*q1 + magY*q0*q2 + magX*q2*q3 - magY*q1*q3 + SH_MAGS[4]*magE*q0*q2 + SH_MAGS[5]*magE*q0*q2 + SH_MAGS[4]*magE*q1*q3 + SH_MAGS[6]*magE*q0*q2 + SH_MAGS[5]*magE*q1*q3 + SH_MAGS[7]*magE*q0*q2 + SH_MAGS[6]*magE*q1*q3 + SH_MAGS[7]*magE*q1*q3 + SH_MAGS[4]*magN*q0*q1 + SH_MAGS[5]*magN*q0*q1 + SH_MAGS[6]*magN*q0*q1 + SH_MAGS[7]*magN*q0*q1 - SH_MAGS[4]*magN*q2*q3 - SH_MAGS[5]*magN*q2*q3 - SH_MAGS[6]*magN*q2*q3 - SH_MAGS[7]*magN*q2*q3) - P[16][2]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19]) + SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magE*q3 + 4*SH_MAGS[5]*magE*q3 + 4*SH_MAGS[6]*magE*q3 + 4*SH_MAGS[7]*magE*q3) - SH_MAGS[1]*SH_MAGS[8]*(2*magZ*q1 - SH_MAGS[21] - SH_MAGS[20] + 4*SH_MAGS[4]*magN*q3 + 4*SH_MAGS[5]*magN*q3 + 4*SH_MAGS[6]*magN*q3 + 4*SH_MAGS[7]*magN*q3))*(P[0][3]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[20] + SH_MAGS[21] - 2*magZ*q1 + 4*SH_MAGS[4]*magE*q0 + 4*SH_MAGS[5]*magE*q0 + 4*SH_MAGS[6]*magE*q0 + 4*SH_MAGS[7]*magE*q0) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magN*q0 + 4*SH_MAGS[5]*magN*q0 + 4*SH_MAGS[6]*magN*q0 + 4*SH_MAGS[7]*magN*q0)) + P[1][3]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[22] - 2*magY*q1 - 2*magZ*q0 + 4*SH_MAGS[4]*magE*q1 + 4*SH_MAGS[5]*magE*q1 + 4*SH_MAGS[6]*magE*q1 + 4*SH_MAGS[7]*magE*q1) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magN*q1 + 4*SH_MAGS[5]*magN*q1 + 4*SH_MAGS[6]*magN*q1 + 4*SH_MAGS[7]*magN*q1)) + P[2][3]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magE*q2 + 4*SH_MAGS[5]*magE*q2 + 4*SH_MAGS[6]*magE*q2 + 4*SH_MAGS[7]*magE*q2) - SH_MAGS[1]*SH_MAGS[8]*(2*magY*q1 - SH_MAGS[22] + 2*magZ*q0 + 4*SH_MAGS[4]*magN*q2 + 4*SH_MAGS[5]*magN*q2 + 4*SH_MAGS[6]*magN*q2 + 4*SH_MAGS[7]*magN*q2)) + P[3][3]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magE*q3 + 4*SH_MAGS[5]*magE*q3 + 4*SH_MAGS[6]*magE*q3 + 4*SH_MAGS[7]*magE*q3) - SH_MAGS[1]*SH_MAGS[8]*(2*magZ*q1 - SH_MAGS[21] - SH_MAGS[20] + 4*SH_MAGS[4]*magN*q3 + 4*SH_MAGS[5]*magN*q3 + 4*SH_MAGS[6]*magN*q3 + 4*SH_MAGS[7]*magN*q3)) + P[17][3]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] + P[20][3]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(SH_MAGS[4]*magX - SH_MAGS[5]*magX + SH_MAGS[15]*magN - SH_MAGS[6]*magX - SH_MAGS[16]*magN + SH_MAGS[7]*magX + SH_MAGS[17]*magN - SH_MAGS[18]*magN + SH_MAGS[10]*q0 - 2*SH_MAGS[4]*SH_MAGS[6]*magN + 2*SH_MAGS[5]*SH_MAGS[7]*magN - 2*magZ*q1*q3 + 2*SH_MAGS[4]*magE*q0*q3 - 2*SH_MAGS[4]*magE*q1*q2 + 2*SH_MAGS[5]*magE*q0*q3 - 2*SH_MAGS[5]*magE*q1*q2 + 2*SH_MAGS[6]*magE*q0*q3 - 2*SH_MAGS[6]*magE*q1*q2 + 2*SH_MAGS[7]*magE*q0*q3 - 2*SH_MAGS[7]*magE*q1*q2) + P[19][3]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(SH_MAGS[17]*magE - SH_MAGS[16]*magE - SH_MAGS[15]*magE + SH_MAGS[18]*magE - SH_MAGS[4]*magY + SH_MAGS[5]*magY + SH_MAGS[6]*magY - SH_MAGS[7]*magY + SH_MAGS[10]*q3 + 2*SH_MAGS[4]*SH_MAGS[5]*magE - 2*SH_MAGS[6]*SH_MAGS[7]*magE + 2*magZ*q0*q1 + 2*SH_MAGS[4]*magN*q0*q3 + 2*SH_MAGS[4]*magN*q1*q2 + 2*SH_MAGS[5]*magN*q0*q3 + 2*SH_MAGS[5]*magN*q1*q2 + 2*SH_MAGS[6]*magN*q0*q3 + 2*SH_MAGS[6]*magN*q1*q2 + 2*SH_MAGS[7]*magN*q0*q3 + 2*SH_MAGS[7]*magN*q1*q2) - 2*P[21][3]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(magX*q0*q1 + magY*q0*q2 + magX*q2*q3 - magY*q1*q3 + SH_MAGS[4]*magE*q0*q2 + SH_MAGS[5]*magE*q0*q2 + SH_MAGS[4]*magE*q1*q3 + SH_MAGS[6]*magE*q0*q2 + SH_MAGS[5]*magE*q1*q3 + SH_MAGS[7]*magE*q0*q2 + SH_MAGS[6]*magE*q1*q3 + SH_MAGS[7]*magE*q1*q3 + SH_MAGS[4]*magN*q0*q1 + SH_MAGS[5]*magN*q0*q1 + SH_MAGS[6]*magN*q0*q1 + SH_MAGS[7]*magN*q0*q1 - SH_MAGS[4]*magN*q2*q3 - SH_MAGS[5]*magN*q2*q3 - SH_MAGS[6]*magN*q2*q3 - SH_MAGS[7]*magN*q2*q3) - P[16][3]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19]) + SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19]*(P[0][17]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[20] + SH_MAGS[21] - 2*magZ*q1 + 4*SH_MAGS[4]*magE*q0 + 4*SH_MAGS[5]*magE*q0 + 4*SH_MAGS[6]*magE*q0 + 4*SH_MAGS[7]*magE*q0) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magN*q0 + 4*SH_MAGS[5]*magN*q0 + 4*SH_MAGS[6]*magN*q0 + 4*SH_MAGS[7]*magN*q0)) + P[1][17]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[22] - 2*magY*q1 - 2*magZ*q0 + 4*SH_MAGS[4]*magE*q1 + 4*SH_MAGS[5]*magE*q1 + 4*SH_MAGS[6]*magE*q1 + 4*SH_MAGS[7]*magE*q1) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magN*q1 + 4*SH_MAGS[5]*magN*q1 + 4*SH_MAGS[6]*magN*q1 + 4*SH_MAGS[7]*magN*q1)) + P[2][17]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magE*q2 + 4*SH_MAGS[5]*magE*q2 + 4*SH_MAGS[6]*magE*q2 + 4*SH_MAGS[7]*magE*q2) - SH_MAGS[1]*SH_MAGS[8]*(2*magY*q1 - SH_MAGS[22] + 2*magZ*q0 + 4*SH_MAGS[4]*magN*q2 + 4*SH_MAGS[5]*magN*q2 + 4*SH_MAGS[6]*magN*q2 + 4*SH_MAGS[7]*magN*q2)) + P[3][17]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magE*q3 + 4*SH_MAGS[5]*magE*q3 + 4*SH_MAGS[6]*magE*q3 + 4*SH_MAGS[7]*magE*q3) - SH_MAGS[1]*SH_MAGS[8]*(2*magZ*q1 - SH_MAGS[21] - SH_MAGS[20] + 4*SH_MAGS[4]*magN*q3 + 4*SH_MAGS[5]*magN*q3 + 4*SH_MAGS[6]*magN*q3 + 4*SH_MAGS[7]*magN*q3)) + P[17][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] + P[19][17]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(SH_MAGS[17]*magE - SH_MAGS[16]*magE - SH_MAGS[15]*magE + SH_MAGS[18]*magE - SH_MAGS[4]*magY + SH_MAGS[5]*magY + SH_MAGS[6]*magY - SH_MAGS[7]*magY + SH_MAGS[10]*q3 + 2*SH_MAGS[4]*SH_MAGS[5]*magE - 2*SH_MAGS[6]*SH_MAGS[7]*magE + 2*magZ*q0*q1 + 2*SH_MAGS[4]*magN*q0*q3 + 2*SH_MAGS[4]*magN*q1*q2 + 2*SH_MAGS[5]*magN*q0*q3 + 2*SH_MAGS[5]*magN*q1*q2 + 2*SH_MAGS[6]*magN*q0*q3 + 2*SH_MAGS[6]*magN*q1*q2 + 2*SH_MAGS[7]*magN*q0*q3 + 2*SH_MAGS[7]*magN*q1*q2) + P[20][17]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(SH_MAGS[4]*magX - SH_MAGS[5]*magX + SH_MAGS[15]*magN - SH_MAGS[6]*magX - SH_MAGS[16]*magN + SH_MAGS[7]*magX + SH_MAGS[17]*magN - SH_MAGS[18]*magN + SH_MAGS[10]*q0 - 2*SH_MAGS[4]*SH_MAGS[6]*magN + 2*SH_MAGS[5]*SH_MAGS[7]*magN - 2*magZ*q1*q3 + 2*SH_MAGS[4]*magE*q0*q3 - 2*SH_MAGS[4]*magE*q1*q2 + 2*SH_MAGS[5]*magE*q0*q3 - 2*SH_MAGS[5]*magE*q1*q2 + 2*SH_MAGS[6]*magE*q0*q3 - 2*SH_MAGS[6]*magE*q1*q2 + 2*SH_MAGS[7]*magE*q0*q3 - 2*SH_MAGS[7]*magE*q1*q2) - 2*P[21][17]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(magX*q0*q1 + magY*q0*q2 + magX*q2*q3 - magY*q1*q3 + SH_MAGS[4]*magE*q0*q2 + SH_MAGS[5]*magE*q0*q2 + SH_MAGS[4]*magE*q1*q3 + SH_MAGS[6]*magE*q0*q2 + SH_MAGS[5]*magE*q1*q3 + SH_MAGS[7]*magE*q0*q2 + SH_MAGS[6]*magE*q1*q3 + SH_MAGS[7]*magE*q1*q3 + SH_MAGS[4]*magN*q0*q1 + SH_MAGS[5]*magN*q0*q1 + SH_MAGS[6]*magN*q0*q1 + SH_MAGS[7]*magN*q0*q1 - SH_MAGS[4]*magN*q2*q3 - SH_MAGS[5]*magN*q2*q3 - SH_MAGS[6]*magN*q2*q3 - SH_MAGS[7]*magN*q2*q3) - P[16][17]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19]) - SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19]*(P[0][16]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[20] + SH_MAGS[21] - 2*magZ*q1 + 4*SH_MAGS[4]*magE*q0 + 4*SH_MAGS[5]*magE*q0 + 4*SH_MAGS[6]*magE*q0 + 4*SH_MAGS[7]*magE*q0) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magN*q0 + 4*SH_MAGS[5]*magN*q0 + 4*SH_MAGS[6]*magN*q0 + 4*SH_MAGS[7]*magN*q0)) + P[1][16]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[22] - 2*magY*q1 - 2*magZ*q0 + 4*SH_MAGS[4]*magE*q1 + 4*SH_MAGS[5]*magE*q1 + 4*SH_MAGS[6]*magE*q1 + 4*SH_MAGS[7]*magE*q1) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magN*q1 + 4*SH_MAGS[5]*magN*q1 + 4*SH_MAGS[6]*magN*q1 + 4*SH_MAGS[7]*magN*q1)) + P[2][16]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magE*q2 + 4*SH_MAGS[5]*magE*q2 + 4*SH_MAGS[6]*magE*q2 + 4*SH_MAGS[7]*magE*q2) - SH_MAGS[1]*SH_MAGS[8]*(2*magY*q1 - SH_MAGS[22] + 2*magZ*q0 + 4*SH_MAGS[4]*magN*q2 + 4*SH_MAGS[5]*magN*q2 + 4*SH_MAGS[6]*magN*q2 + 4*SH_MAGS[7]*magN*q2)) + P[3][16]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magE*q3 + 4*SH_MAGS[5]*magE*q3 + 4*SH_MAGS[6]*magE*q3 + 4*SH_MAGS[7]*magE*q3) - SH_MAGS[1]*SH_MAGS[8]*(2*magZ*q1 - SH_MAGS[21] - SH_MAGS[20] + 4*SH_MAGS[4]*magN*q3 + 4*SH_MAGS[5]*magN*q3 + 4*SH_MAGS[6]*magN*q3 + 4*SH_MAGS[7]*magN*q3)) + P[17][16]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] + P[19][16]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(SH_MAGS[17]*magE - SH_MAGS[16]*magE - SH_MAGS[15]*magE + SH_MAGS[18]*magE - SH_MAGS[4]*magY + SH_MAGS[5]*magY + SH_MAGS[6]*magY - SH_MAGS[7]*magY + SH_MAGS[10]*q3 + 2*SH_MAGS[4]*SH_MAGS[5]*magE - 2*SH_MAGS[6]*SH_MAGS[7]*magE + 2*magZ*q0*q1 + 2*SH_MAGS[4]*magN*q0*q3 + 2*SH_MAGS[4]*magN*q1*q2 + 2*SH_MAGS[5]*magN*q0*q3 + 2*SH_MAGS[5]*magN*q1*q2 + 2*SH_MAGS[6]*magN*q0*q3 + 2*SH_MAGS[6]*magN*q1*q2 + 2*SH_MAGS[7]*magN*q0*q3 + 2*SH_MAGS[7]*magN*q1*q2) + P[20][16]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(SH_MAGS[4]*magX - SH_MAGS[5]*magX + SH_MAGS[15]*magN - SH_MAGS[6]*magX - SH_MAGS[16]*magN + SH_MAGS[7]*magX + SH_MAGS[17]*magN - SH_MAGS[18]*magN + SH_MAGS[10]*q0 - 2*SH_MAGS[4]*SH_MAGS[6]*magN + 2*SH_MAGS[5]*SH_MAGS[7]*magN - 2*magZ*q1*q3 + 2*SH_MAGS[4]*magE*q0*q3 - 2*SH_MAGS[4]*magE*q1*q2 + 2*SH_MAGS[5]*magE*q0*q3 - 2*SH_MAGS[5]*magE*q1*q2 + 2*SH_MAGS[6]*magE*q0*q3 - 2*SH_MAGS[6]*magE*q1*q2 + 2*SH_MAGS[7]*magE*q0*q3 - 2*SH_MAGS[7]*magE*q1*q2) - 2*P[21][16]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(magX*q0*q1 + magY*q0*q2 + magX*q2*q3 - magY*q1*q3 + SH_MAGS[4]*magE*q0*q2 + SH_MAGS[5]*magE*q0*q2 + SH_MAGS[4]*magE*q1*q3 + SH_MAGS[6]*magE*q0*q2 + SH_MAGS[5]*magE*q1*q3 + SH_MAGS[7]*magE*q0*q2 + SH_MAGS[6]*magE*q1*q3 + SH_MAGS[7]*magE*q1*q3 + SH_MAGS[4]*magN*q0*q1 + SH_MAGS[5]*magN*q0*q1 + SH_MAGS[6]*magN*q0*q1 + SH_MAGS[7]*magN*q0*q1 - SH_MAGS[4]*magN*q2*q3 - SH_MAGS[5]*magN*q2*q3 - SH_MAGS[6]*magN*q2*q3 - SH_MAGS[7]*magN*q2*q3) - P[16][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19]) + SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(P[0][20]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[20] + SH_MAGS[21] - 2*magZ*q1 + 4*SH_MAGS[4]*magE*q0 + 4*SH_MAGS[5]*magE*q0 + 4*SH_MAGS[6]*magE*q0 + 4*SH_MAGS[7]*magE*q0) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magN*q0 + 4*SH_MAGS[5]*magN*q0 + 4*SH_MAGS[6]*magN*q0 + 4*SH_MAGS[7]*magN*q0)) + P[1][20]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[22] - 2*magY*q1 - 2*magZ*q0 + 4*SH_MAGS[4]*magE*q1 + 4*SH_MAGS[5]*magE*q1 + 4*SH_MAGS[6]*magE*q1 + 4*SH_MAGS[7]*magE*q1) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magN*q1 + 4*SH_MAGS[5]*magN*q1 + 4*SH_MAGS[6]*magN*q1 + 4*SH_MAGS[7]*magN*q1)) + P[2][20]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magE*q2 + 4*SH_MAGS[5]*magE*q2 + 4*SH_MAGS[6]*magE*q2 + 4*SH_MAGS[7]*magE*q2) - SH_MAGS[1]*SH_MAGS[8]*(2*magY*q1 - SH_MAGS[22] + 2*magZ*q0 + 4*SH_MAGS[4]*magN*q2 + 4*SH_MAGS[5]*magN*q2 + 4*SH_MAGS[6]*magN*q2 + 4*SH_MAGS[7]*magN*q2)) + P[3][20]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magE*q3 + 4*SH_MAGS[5]*magE*q3 + 4*SH_MAGS[6]*magE*q3 + 4*SH_MAGS[7]*magE*q3) - SH_MAGS[1]*SH_MAGS[8]*(2*magZ*q1 - SH_MAGS[21] - SH_MAGS[20] + 4*SH_MAGS[4]*magN*q3 + 4*SH_MAGS[5]*magN*q3 + 4*SH_MAGS[6]*magN*q3 + 4*SH_MAGS[7]*magN*q3)) + P[17][20]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] + P[19][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(SH_MAGS[17]*magE - SH_MAGS[16]*magE - SH_MAGS[15]*magE + SH_MAGS[18]*magE - SH_MAGS[4]*magY + SH_MAGS[5]*magY + SH_MAGS[6]*magY - SH_MAGS[7]*magY + SH_MAGS[10]*q3 + 2*SH_MAGS[4]*SH_MAGS[5]*magE - 2*SH_MAGS[6]*SH_MAGS[7]*magE + 2*magZ*q0*q1 + 2*SH_MAGS[4]*magN*q0*q3 + 2*SH_MAGS[4]*magN*q1*q2 + 2*SH_MAGS[5]*magN*q0*q3 + 2*SH_MAGS[5]*magN*q1*q2 + 2*SH_MAGS[6]*magN*q0*q3 + 2*SH_MAGS[6]*magN*q1*q2 + 2*SH_MAGS[7]*magN*q0*q3 + 2*SH_MAGS[7]*magN*q1*q2) + P[20][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(SH_MAGS[4]*magX - SH_MAGS[5]*magX + SH_MAGS[15]*magN - SH_MAGS[6]*magX - SH_MAGS[16]*magN + SH_MAGS[7]*magX + SH_MAGS[17]*magN - SH_MAGS[18]*magN + SH_MAGS[10]*q0 - 2*SH_MAGS[4]*SH_MAGS[6]*magN + 2*SH_MAGS[5]*SH_MAGS[7]*magN - 2*magZ*q1*q3 + 2*SH_MAGS[4]*magE*q0*q3 - 2*SH_MAGS[4]*magE*q1*q2 + 2*SH_MAGS[5]*magE*q0*q3 - 2*SH_MAGS[5]*magE*q1*q2 + 2*SH_MAGS[6]*magE*q0*q3 - 2*SH_MAGS[6]*magE*q1*q2 + 2*SH_MAGS[7]*magE*q0*q3 - 2*SH_MAGS[7]*magE*q1*q2) - 2*P[21][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(magX*q0*q1 + magY*q0*q2 + magX*q2*q3 - magY*q1*q3 + SH_MAGS[4]*magE*q0*q2 + SH_MAGS[5]*magE*q0*q2 + SH_MAGS[4]*magE*q1*q3 + SH_MAGS[6]*magE*q0*q2 + SH_MAGS[5]*magE*q1*q3 + SH_MAGS[7]*magE*q0*q2 + SH_MAGS[6]*magE*q1*q3 + SH_MAGS[7]*magE*q1*q3 + SH_MAGS[4]*magN*q0*q1 + SH_MAGS[5]*magN*q0*q1 + SH_MAGS[6]*magN*q0*q1 + SH_MAGS[7]*magN*q0*q1 - SH_MAGS[4]*magN*q2*q3 - SH_MAGS[5]*magN*q2*q3 - SH_MAGS[6]*magN*q2*q3 - SH_MAGS[7]*magN*q2*q3) - P[16][20]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19])*(SH_MAGS[4]*magX - SH_MAGS[5]*magX + SH_MAGS[15]*magN - SH_MAGS[6]*magX - SH_MAGS[16]*magN + SH_MAGS[7]*magX + SH_MAGS[17]*magN - SH_MAGS[18]*magN + SH_MAGS[10]*q0 - 2*SH_MAGS[4]*SH_MAGS[6]*magN + 2*SH_MAGS[5]*SH_MAGS[7]*magN - 2*magZ*q1*q3 + 2*SH_MAGS[4]*magE*q0*q3 - 2*SH_MAGS[4]*magE*q1*q2 + 2*SH_MAGS[5]*magE*q0*q3 - 2*SH_MAGS[5]*magE*q1*q2 + 2*SH_MAGS[6]*magE*q0*q3 - 2*SH_MAGS[6]*magE*q1*q2 + 2*SH_MAGS[7]*magE*q0*q3 - 2*SH_MAGS[7]*magE*q1*q2) + SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(P[0][19]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[20] + SH_MAGS[21] - 2*magZ*q1 + 4*SH_MAGS[4]*magE*q0 + 4*SH_MAGS[5]*magE*q0 + 4*SH_MAGS[6]*magE*q0 + 4*SH_MAGS[7]*magE*q0) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magN*q0 + 4*SH_MAGS[5]*magN*q0 + 4*SH_MAGS[6]*magN*q0 + 4*SH_MAGS[7]*magN*q0)) + P[1][19]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[22] - 2*magY*q1 - 2*magZ*q0 + 4*SH_MAGS[4]*magE*q1 + 4*SH_MAGS[5]*magE*q1 + 4*SH_MAGS[6]*magE*q1 + 4*SH_MAGS[7]*magE*q1) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magN*q1 + 4*SH_MAGS[5]*magN*q1 + 4*SH_MAGS[6]*magN*q1 + 4*SH_MAGS[7]*magN*q1)) + P[2][19]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magE*q2 + 4*SH_MAGS[5]*magE*q2 + 4*SH_MAGS[6]*magE*q2 + 4*SH_MAGS[7]*magE*q2) - SH_MAGS[1]*SH_MAGS[8]*(2*magY*q1 - SH_MAGS[22] + 2*magZ*q0 + 4*SH_MAGS[4]*magN*q2 + 4*SH_MAGS[5]*magN*q2 + 4*SH_MAGS[6]*magN*q2 + 4*SH_MAGS[7]*magN*q2)) + P[3][19]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magE*q3 + 4*SH_MAGS[5]*magE*q3 + 4*SH_MAGS[6]*magE*q3 + 4*SH_MAGS[7]*magE*q3) - SH_MAGS[1]*SH_MAGS[8]*(2*magZ*q1 - SH_MAGS[21] - SH_MAGS[20] + 4*SH_MAGS[4]*magN*q3 + 4*SH_MAGS[5]*magN*q3 + 4*SH_MAGS[6]*magN*q3 + 4*SH_MAGS[7]*magN*q3)) + P[17][19]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] + P[19][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(SH_MAGS[17]*magE - SH_MAGS[16]*magE - SH_MAGS[15]*magE + SH_MAGS[18]*magE - SH_MAGS[4]*magY + SH_MAGS[5]*magY + SH_MAGS[6]*magY - SH_MAGS[7]*magY + SH_MAGS[10]*q3 + 2*SH_MAGS[4]*SH_MAGS[5]*magE - 2*SH_MAGS[6]*SH_MAGS[7]*magE + 2*magZ*q0*q1 + 2*SH_MAGS[4]*magN*q0*q3 + 2*SH_MAGS[4]*magN*q1*q2 + 2*SH_MAGS[5]*magN*q0*q3 + 2*SH_MAGS[5]*magN*q1*q2 + 2*SH_MAGS[6]*magN*q0*q3 + 2*SH_MAGS[6]*magN*q1*q2 + 2*SH_MAGS[7]*magN*q0*q3 + 2*SH_MAGS[7]*magN*q1*q2) + P[20][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(SH_MAGS[4]*magX - SH_MAGS[5]*magX + SH_MAGS[15]*magN - SH_MAGS[6]*magX - SH_MAGS[16]*magN + SH_MAGS[7]*magX + SH_MAGS[17]*magN - SH_MAGS[18]*magN + SH_MAGS[10]*q0 - 2*SH_MAGS[4]*SH_MAGS[6]*magN + 2*SH_MAGS[5]*SH_MAGS[7]*magN - 2*magZ*q1*q3 + 2*SH_MAGS[4]*magE*q0*q3 - 2*SH_MAGS[4]*magE*q1*q2 + 2*SH_MAGS[5]*magE*q0*q3 - 2*SH_MAGS[5]*magE*q1*q2 + 2*SH_MAGS[6]*magE*q0*q3 - 2*SH_MAGS[6]*magE*q1*q2 + 2*SH_MAGS[7]*magE*q0*q3 - 2*SH_MAGS[7]*magE*q1*q2) - 2*P[21][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(magX*q0*q1 + magY*q0*q2 + magX*q2*q3 - magY*q1*q3 + SH_MAGS[4]*magE*q0*q2 + SH_MAGS[5]*magE*q0*q2 + SH_MAGS[4]*magE*q1*q3 + SH_MAGS[6]*magE*q0*q2 + SH_MAGS[5]*magE*q1*q3 + SH_MAGS[7]*magE*q0*q2 + SH_MAGS[6]*magE*q1*q3 + SH_MAGS[7]*magE*q1*q3 + SH_MAGS[4]*magN*q0*q1 + SH_MAGS[5]*magN*q0*q1 + SH_MAGS[6]*magN*q0*q1 + SH_MAGS[7]*magN*q0*q1 - SH_MAGS[4]*magN*q2*q3 - SH_MAGS[5]*magN*q2*q3 - SH_MAGS[6]*magN*q2*q3 - SH_MAGS[7]*magN*q2*q3) - P[16][19]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19])*(SH_MAGS[17]*magE - SH_MAGS[16]*magE - SH_MAGS[15]*magE + SH_MAGS[18]*magE - SH_MAGS[4]*magY + SH_MAGS[5]*magY + SH_MAGS[6]*magY - SH_MAGS[7]*magY + SH_MAGS[10]*q3 + 2*SH_MAGS[4]*SH_MAGS[5]*magE - 2*SH_MAGS[6]*SH_MAGS[7]*magE + 2*magZ*q0*q1 + 2*SH_MAGS[4]*magN*q0*q3 + 2*SH_MAGS[4]*magN*q1*q2 + 2*SH_MAGS[5]*magN*q0*q3 + 2*SH_MAGS[5]*magN*q1*q2 + 2*SH_MAGS[6]*magN*q0*q3 + 2*SH_MAGS[6]*magN*q1*q2 + 2*SH_MAGS[7]*magN*q0*q3 + 2*SH_MAGS[7]*magN*q1*q2) - 2*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(P[0][21]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[20] + SH_MAGS[21] - 2*magZ*q1 + 4*SH_MAGS[4]*magE*q0 + 4*SH_MAGS[5]*magE*q0 + 4*SH_MAGS[6]*magE*q0 + 4*SH_MAGS[7]*magE*q0) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magN*q0 + 4*SH_MAGS[5]*magN*q0 + 4*SH_MAGS[6]*magN*q0 + 4*SH_MAGS[7]*magN*q0)) + P[1][21]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[22] - 2*magY*q1 - 2*magZ*q0 + 4*SH_MAGS[4]*magE*q1 + 4*SH_MAGS[5]*magE*q1 + 4*SH_MAGS[6]*magE*q1 + 4*SH_MAGS[7]*magE*q1) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magN*q1 + 4*SH_MAGS[5]*magN*q1 + 4*SH_MAGS[6]*magN*q1 + 4*SH_MAGS[7]*magN*q1)) + P[2][21]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magE*q2 + 4*SH_MAGS[5]*magE*q2 + 4*SH_MAGS[6]*magE*q2 + 4*SH_MAGS[7]*magE*q2) - SH_MAGS[1]*SH_MAGS[8]*(2*magY*q1 - SH_MAGS[22] + 2*magZ*q0 + 4*SH_MAGS[4]*magN*q2 + 4*SH_MAGS[5]*magN*q2 + 4*SH_MAGS[6]*magN*q2 + 4*SH_MAGS[7]*magN*q2)) + P[3][21]*SH_MAGS[2]*(SH_MAGS[9]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magE*q3 + 4*SH_MAGS[5]*magE*q3 + 4*SH_MAGS[6]*magE*q3 + 4*SH_MAGS[7]*magE*q3) - SH_MAGS[1]*SH_MAGS[8]*(2*magZ*q1 - SH_MAGS[21] - SH_MAGS[20] + 4*SH_MAGS[4]*magN*q3 + 4*SH_MAGS[5]*magN*q3 + 4*SH_MAGS[6]*magN*q3 + 4*SH_MAGS[7]*magN*q3)) + P[17][21]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] + P[19][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(SH_MAGS[17]*magE - SH_MAGS[16]*magE - SH_MAGS[15]*magE + SH_MAGS[18]*magE - SH_MAGS[4]*magY + SH_MAGS[5]*magY + SH_MAGS[6]*magY - SH_MAGS[7]*magY + SH_MAGS[10]*q3 + 2*SH_MAGS[4]*SH_MAGS[5]*magE - 2*SH_MAGS[6]*SH_MAGS[7]*magE + 2*magZ*q0*q1 + 2*SH_MAGS[4]*magN*q0*q3 + 2*SH_MAGS[4]*magN*q1*q2 + 2*SH_MAGS[5]*magN*q0*q3 + 2*SH_MAGS[5]*magN*q1*q2 + 2*SH_MAGS[6]*magN*q0*q3 + 2*SH_MAGS[6]*magN*q1*q2 + 2*SH_MAGS[7]*magN*q0*q3 + 2*SH_MAGS[7]*magN*q1*q2) + P[20][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(SH_MAGS[4]*magX - SH_MAGS[5]*magX + SH_MAGS[15]*magN - SH_MAGS[6]*magX - SH_MAGS[16]*magN + SH_MAGS[7]*magX + SH_MAGS[17]*magN - SH_MAGS[18]*magN + SH_MAGS[10]*q0 - 2*SH_MAGS[4]*SH_MAGS[6]*magN + 2*SH_MAGS[5]*SH_MAGS[7]*magN - 2*magZ*q1*q3 + 2*SH_MAGS[4]*magE*q0*q3 - 2*SH_MAGS[4]*magE*q1*q2 + 2*SH_MAGS[5]*magE*q0*q3 - 2*SH_MAGS[5]*magE*q1*q2 + 2*SH_MAGS[6]*magE*q0*q3 - 2*SH_MAGS[6]*magE*q1*q2 + 2*SH_MAGS[7]*magE*q0*q3 - 2*SH_MAGS[7]*magE*q1*q2) - 2*P[21][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*(magX*q0*q1 + magY*q0*q2 + magX*q2*q3 - magY*q1*q3 + SH_MAGS[4]*magE*q0*q2 + SH_MAGS[5]*magE*q0*q2 + SH_MAGS[4]*magE*q1*q3 + SH_MAGS[6]*magE*q0*q2 + SH_MAGS[5]*magE*q1*q3 + SH_MAGS[7]*magE*q0*q2 + SH_MAGS[6]*magE*q1*q3 + SH_MAGS[7]*magE*q1*q3 + SH_MAGS[4]*magN*q0*q1 + SH_MAGS[5]*magN*q0*q1 + SH_MAGS[6]*magN*q0*q1 + SH_MAGS[7]*magN*q0*q1 - SH_MAGS[4]*magN*q2*q3 - SH_MAGS[5]*magN*q2*q3 - SH_MAGS[6]*magN*q2*q3 - SH_MAGS[7]*magN*q2*q3) - P[16][21]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19])*(magX*q0*q1 + magY*q0*q2 + magX*q2*q3 - magY*q1*q3 + SH_MAGS[4]*magE*q0*q2 + SH_MAGS[5]*magE*q0*q2 + SH_MAGS[4]*magE*q1*q3 + SH_MAGS[6]*magE*q0*q2 + SH_MAGS[5]*magE*q1*q3 + SH_MAGS[7]*magE*q0*q2 + SH_MAGS[6]*magE*q1*q3 + SH_MAGS[7]*magE*q1*q3 + SH_MAGS[4]*magN*q0*q1 + SH_MAGS[5]*magN*q0*q1 + SH_MAGS[6]*magN*q0*q1 + SH_MAGS[7]*magN*q0*q1 - SH_MAGS[4]*magN*q2*q3 - SH_MAGS[5]*magN*q2*q3 - SH_MAGS[6]*magN*q2*q3 - SH_MAGS[7]*magN*q2*q3));
SK_MAGS[1] = magX*q0*q1 + magY*q0*q2 + magX*q2*q3 - magY*q1*q3 + SH_MAGS[4]*magE*q0*q2 + SH_MAGS[5]*magE*q0*q2 + SH_MAGS[4]*magE*q1*q3 + SH_MAGS[6]*magE*q0*q2 + SH_MAGS[5]*magE*q1*q3 + SH_MAGS[7]*magE*q0*q2 + SH_MAGS[6]*magE*q1*q3 + SH_MAGS[7]*magE*q1*q3 + SH_MAGS[4]*magN*q0*q1 + SH_MAGS[5]*magN*q0*q1 + SH_MAGS[6]*magN*q0*q1 + SH_MAGS[7]*magN*q0*q1 - SH_MAGS[4]*magN*q2*q3 - SH_MAGS[5]*magN*q2*q3 - SH_MAGS[6]*magN*q2*q3 - SH_MAGS[7]*magN*q2*q3;
SK_MAGS[2] = SH_MAGS[4]*magX - SH_MAGS[5]*magX + SH_MAGS[15]*magN - SH_MAGS[6]*magX - SH_MAGS[16]*magN + SH_MAGS[7]*magX + SH_MAGS[17]*magN - SH_MAGS[18]*magN + SH_MAGS[10]*q0 - 2*SH_MAGS[4]*SH_MAGS[6]*magN + 2*SH_MAGS[5]*SH_MAGS[7]*magN - 2*magZ*q1*q3 + 2*SH_MAGS[4]*magE*q0*q3 - 2*SH_MAGS[4]*magE*q1*q2 + 2*SH_MAGS[5]*magE*q0*q3 - 2*SH_MAGS[5]*magE*q1*q2 + 2*SH_MAGS[6]*magE*q0*q3 - 2*SH_MAGS[6]*magE*q1*q2 + 2*SH_MAGS[7]*magE*q0*q3 - 2*SH_MAGS[7]*magE*q1*q2;
SK_MAGS[3] = SH_MAGS[17]*magE - SH_MAGS[16]*magE - SH_MAGS[15]*magE + SH_MAGS[18]*magE - SH_MAGS[4]*magY + SH_MAGS[5]*magY + SH_MAGS[6]*magY - SH_MAGS[7]*magY + SH_MAGS[10]*q3 + 2*SH_MAGS[4]*SH_MAGS[5]*magE - 2*SH_MAGS[6]*SH_MAGS[7]*magE + 2*magZ*q0*q1 + 2*SH_MAGS[4]*magN*q0*q3 + 2*SH_MAGS[4]*magN*q1*q2 + 2*SH_MAGS[5]*magN*q0*q3 + 2*SH_MAGS[5]*magN*q1*q2 + 2*SH_MAGS[6]*magN*q0*q3 + 2*SH_MAGS[6]*magN*q1*q2 + 2*SH_MAGS[7]*magN*q0*q3 + 2*SH_MAGS[7]*magN*q1*q2;
SK_MAGS[4] = SH_MAGS[9]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magE*q3 + 4*SH_MAGS[5]*magE*q3 + 4*SH_MAGS[6]*magE*q3 + 4*SH_MAGS[7]*magE*q3) - SH_MAGS[1]*SH_MAGS[8]*(2*magZ*q1 - SH_MAGS[21] - SH_MAGS[20] + 4*SH_MAGS[4]*magN*q3 + 4*SH_MAGS[5]*magN*q3 + 4*SH_MAGS[6]*magN*q3 + 4*SH_MAGS[7]*magN*q3);
SK_MAGS[5] = SH_MAGS[9]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magE*q2 + 4*SH_MAGS[5]*magE*q2 + 4*SH_MAGS[6]*magE*q2 + 4*SH_MAGS[7]*magE*q2) - SH_MAGS[1]*SH_MAGS[8]*(2*magY*q1 - SH_MAGS[22] + 2*magZ*q0 + 4*SH_MAGS[4]*magN*q2 + 4*SH_MAGS[5]*magN*q2 + 4*SH_MAGS[6]*magN*q2 + 4*SH_MAGS[7]*magN*q2);
SK_MAGS[6] = SH_MAGS[9]*(SH_MAGS[22] - 2*magY*q1 - 2*magZ*q0 + 4*SH_MAGS[4]*magE*q1 + 4*SH_MAGS[5]*magE*q1 + 4*SH_MAGS[6]*magE*q1 + 4*SH_MAGS[7]*magE*q1) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[12] + SH_MAGS[13] + SH_MAGS[14] + 4*SH_MAGS[4]*magN*q1 + 4*SH_MAGS[5]*magN*q1 + 4*SH_MAGS[6]*magN*q1 + 4*SH_MAGS[7]*magN*q1);
SK_MAGS[7] = SH_MAGS[9]*(SH_MAGS[20] + SH_MAGS[21] - 2*magZ*q1 + 4*SH_MAGS[4]*magE*q0 + 4*SH_MAGS[5]*magE*q0 + 4*SH_MAGS[6]*magE*q0 + 4*SH_MAGS[7]*magE*q0) - SH_MAGS[1]*SH_MAGS[8]*(SH_MAGS[10] + SH_MAGS[11] - 2*magY*q3 + 4*SH_MAGS[4]*magN*q0 + 4*SH_MAGS[5]*magN*q0 + 4*SH_MAGS[6]*magN*q0 + 4*SH_MAGS[7]*magN*q0);
float Kfusion[22][1];
float Kfusion[1][1];
Kfusion[0] = SK_MAGS[0]*(P[0][0]*SH_MAGS[2]*SK_MAGS[7] + P[0][1]*SH_MAGS[2]*SK_MAGS[6] + P[0][2]*SH_MAGS[2]*SK_MAGS[5] + P[0][3]*SH_MAGS[2]*SK_MAGS[4] + P[0][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[0][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[0][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[0][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[0][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
Kfusion[1] = SK_MAGS[0]*(P[1][0]*SH_MAGS[2]*SK_MAGS[7] + P[1][1]*SH_MAGS[2]*SK_MAGS[6] + P[1][2]*SH_MAGS[2]*SK_MAGS[5] + P[1][3]*SH_MAGS[2]*SK_MAGS[4] + P[1][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[1][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[1][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[1][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[1][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
Kfusion[2] = SK_MAGS[0]*(P[2][0]*SH_MAGS[2]*SK_MAGS[7] + P[2][1]*SH_MAGS[2]*SK_MAGS[6] + P[2][2]*SH_MAGS[2]*SK_MAGS[5] + P[2][3]*SH_MAGS[2]*SK_MAGS[4] + P[2][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[2][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[2][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[2][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[2][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
Kfusion[3] = SK_MAGS[0]*(P[3][0]*SH_MAGS[2]*SK_MAGS[7] + P[3][1]*SH_MAGS[2]*SK_MAGS[6] + P[3][2]*SH_MAGS[2]*SK_MAGS[5] + P[3][3]*SH_MAGS[2]*SK_MAGS[4] + P[3][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[3][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[3][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[3][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[3][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
Kfusion[4] = SK_MAGS[0]*(P[4][0]*SH_MAGS[2]*SK_MAGS[7] + P[4][1]*SH_MAGS[2]*SK_MAGS[6] + P[4][2]*SH_MAGS[2]*SK_MAGS[5] + P[4][3]*SH_MAGS[2]*SK_MAGS[4] + P[4][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[4][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[4][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[4][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[4][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
Kfusion[5] = SK_MAGS[0]*(P[5][0]*SH_MAGS[2]*SK_MAGS[7] + P[5][1]*SH_MAGS[2]*SK_MAGS[6] + P[5][2]*SH_MAGS[2]*SK_MAGS[5] + P[5][3]*SH_MAGS[2]*SK_MAGS[4] + P[5][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[5][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[5][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[5][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[5][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
Kfusion[6] = SK_MAGS[0]*(P[6][0]*SH_MAGS[2]*SK_MAGS[7] + P[6][1]*SH_MAGS[2]*SK_MAGS[6] + P[6][2]*SH_MAGS[2]*SK_MAGS[5] + P[6][3]*SH_MAGS[2]*SK_MAGS[4] + P[6][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[6][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[6][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[6][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[6][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
Kfusion[7] = SK_MAGS[0]*(P[7][0]*SH_MAGS[2]*SK_MAGS[7] + P[7][1]*SH_MAGS[2]*SK_MAGS[6] + P[7][2]*SH_MAGS[2]*SK_MAGS[5] + P[7][3]*SH_MAGS[2]*SK_MAGS[4] + P[7][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[7][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[7][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[7][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[7][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
Kfusion[8] = SK_MAGS[0]*(P[8][0]*SH_MAGS[2]*SK_MAGS[7] + P[8][1]*SH_MAGS[2]*SK_MAGS[6] + P[8][2]*SH_MAGS[2]*SK_MAGS[5] + P[8][3]*SH_MAGS[2]*SK_MAGS[4] + P[8][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[8][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[8][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[8][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[8][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
Kfusion[9] = SK_MAGS[0]*(P[9][0]*SH_MAGS[2]*SK_MAGS[7] + P[9][1]*SH_MAGS[2]*SK_MAGS[6] + P[9][2]*SH_MAGS[2]*SK_MAGS[5] + P[9][3]*SH_MAGS[2]*SK_MAGS[4] + P[9][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[9][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[9][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[9][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[9][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
Kfusion[10] = SK_MAGS[0]*(P[10][0]*SH_MAGS[2]*SK_MAGS[7] + P[10][1]*SH_MAGS[2]*SK_MAGS[6] + P[10][2]*SH_MAGS[2]*SK_MAGS[5] + P[10][3]*SH_MAGS[2]*SK_MAGS[4] + P[10][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[10][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[10][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[10][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[10][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
Kfusion[11] = SK_MAGS[0]*(P[11][0]*SH_MAGS[2]*SK_MAGS[7] + P[11][1]*SH_MAGS[2]*SK_MAGS[6] + P[11][2]*SH_MAGS[2]*SK_MAGS[5] + P[11][3]*SH_MAGS[2]*SK_MAGS[4] + P[11][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[11][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[11][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[11][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[11][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
Kfusion[12] = SK_MAGS[0]*(P[12][0]*SH_MAGS[2]*SK_MAGS[7] + P[12][1]*SH_MAGS[2]*SK_MAGS[6] + P[12][2]*SH_MAGS[2]*SK_MAGS[5] + P[12][3]*SH_MAGS[2]*SK_MAGS[4] + P[12][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[12][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[12][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[12][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[12][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
Kfusion[13] = SK_MAGS[0]*(P[13][0]*SH_MAGS[2]*SK_MAGS[7] + P[13][1]*SH_MAGS[2]*SK_MAGS[6] + P[13][2]*SH_MAGS[2]*SK_MAGS[5] + P[13][3]*SH_MAGS[2]*SK_MAGS[4] + P[13][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[13][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[13][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[13][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[13][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
Kfusion[14] = SK_MAGS[0]*(P[14][0]*SH_MAGS[2]*SK_MAGS[7] + P[14][1]*SH_MAGS[2]*SK_MAGS[6] + P[14][2]*SH_MAGS[2]*SK_MAGS[5] + P[14][3]*SH_MAGS[2]*SK_MAGS[4] + P[14][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[14][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[14][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[14][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[14][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
Kfusion[15] = SK_MAGS[0]*(P[15][0]*SH_MAGS[2]*SK_MAGS[7] + P[15][1]*SH_MAGS[2]*SK_MAGS[6] + P[15][2]*SH_MAGS[2]*SK_MAGS[5] + P[15][3]*SH_MAGS[2]*SK_MAGS[4] + P[15][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[15][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[15][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[15][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[15][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
Kfusion[16] = SK_MAGS[0]*(P[16][0]*SH_MAGS[2]*SK_MAGS[7] + P[16][1]*SH_MAGS[2]*SK_MAGS[6] + P[16][2]*SH_MAGS[2]*SK_MAGS[5] + P[16][3]*SH_MAGS[2]*SK_MAGS[4] + P[16][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[16][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[16][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[16][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[16][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
Kfusion[17] = SK_MAGS[0]*(P[17][0]*SH_MAGS[2]*SK_MAGS[7] + P[17][1]*SH_MAGS[2]*SK_MAGS[6] + P[17][2]*SH_MAGS[2]*SK_MAGS[5] + P[17][3]*SH_MAGS[2]*SK_MAGS[4] + P[17][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[17][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[17][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[17][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[17][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
Kfusion[18] = SK_MAGS[0]*(P[18][0]*SH_MAGS[2]*SK_MAGS[7] + P[18][1]*SH_MAGS[2]*SK_MAGS[6] + P[18][2]*SH_MAGS[2]*SK_MAGS[5] + P[18][3]*SH_MAGS[2]*SK_MAGS[4] + P[18][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[18][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[18][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[18][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[18][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
Kfusion[19] = SK_MAGS[0]*(P[19][0]*SH_MAGS[2]*SK_MAGS[7] + P[19][1]*SH_MAGS[2]*SK_MAGS[6] + P[19][2]*SH_MAGS[2]*SK_MAGS[5] + P[19][3]*SH_MAGS[2]*SK_MAGS[4] + P[19][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[19][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[19][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[19][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[19][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
Kfusion[20] = SK_MAGS[0]*(P[20][0]*SH_MAGS[2]*SK_MAGS[7] + P[20][1]*SH_MAGS[2]*SK_MAGS[6] + P[20][2]*SH_MAGS[2]*SK_MAGS[5] + P[20][3]*SH_MAGS[2]*SK_MAGS[4] + P[20][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[20][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[20][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[20][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[20][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
Kfusion[21] = SK_MAGS[0]*(P[21][0]*SH_MAGS[2]*SK_MAGS[7] + P[21][1]*SH_MAGS[2]*SK_MAGS[6] + P[21][2]*SH_MAGS[2]*SK_MAGS[5] + P[21][3]*SH_MAGS[2]*SK_MAGS[4] + P[21][17]*SH_MAGS[2]*SH_MAGS[9]*SH_MAGS[19] - P[21][16]*SH_MAGS[1]*SH_MAGS[2]*SH_MAGS[8]*SH_MAGS[19] + P[21][19]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[3] + P[21][20]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[2] - 2*P[21][21]*SH_MAGS[2]*SH_MAGS[3]*SH_MAGS[8]*SK_MAGS[1]);
float SH_ACCX[4][1];
SH_ACCX[0] = sq(q0) + sq(q1) - sq(q2) - sq(q3);
SH_ACCX[1] = vn - vwn;
SH_ACCX[2] = ve - vwe;
SH_ACCX[3] = 2*q0*q3 + 2*q1*q2;
float H_ACCX[1][22];
H_ACCX[0][0] = -Kacc*(2*SH_ACCX[1]*q0 + 2*SH_ACCX[2]*q3 - 2*q2*vd);
H_ACCX[0][1] = -Kacc*(2*SH_ACCX[1]*q1 + 2*SH_ACCX[2]*q2 + 2*q3*vd);
H_ACCX[0][2] = Kacc*(2*SH_ACCX[1]*q2 - 2*SH_ACCX[2]*q1 + 2*q0*vd);
H_ACCX[0][3] = -Kacc*(2*SH_ACCX[2]*q0 - 2*SH_ACCX[1]*q3 + 2*q1*vd);
H_ACCX[0][4] = -Kacc*SH_ACCX[0];
H_ACCX[0][5] = -Kacc*SH_ACCX[3];
H_ACCX[0][6] = Kacc*(2*q0*q2 - 2*q1*q3);
H_ACCX[0][14] = Kacc*SH_ACCX[0];
H_ACCX[0][15] = Kacc*SH_ACCX[3];
float SK_ACCX[6][1];
SK_ACCX[0] = 1/(R_ACC + Kacc*SH_ACCX[0]*(Kacc*P[4][4]*SH_ACCX[0] + Kacc*P[5][4]*SH_ACCX[3] - Kacc*P[14][4]*SH_ACCX[0] - Kacc*P[15][4]*SH_ACCX[3] - Kacc*P[6][4]*(2*q0*q2 - 2*q1*q3) + Kacc*P[0][4]*(2*SH_ACCX[1]*q0 + 2*SH_ACCX[2]*q3 - 2*q2*vd) + Kacc*P[1][4]*(2*SH_ACCX[1]*q1 + 2*SH_ACCX[2]*q2 + 2*q3*vd) - Kacc*P[2][4]*(2*SH_ACCX[1]*q2 - 2*SH_ACCX[2]*q1 + 2*q0*vd) + Kacc*P[3][4]*(2*SH_ACCX[2]*q0 - 2*SH_ACCX[1]*q3 + 2*q1*vd)) + Kacc*SH_ACCX[3]*(Kacc*P[4][5]*SH_ACCX[0] + Kacc*P[5][5]*SH_ACCX[3] - Kacc*P[14][5]*SH_ACCX[0] - Kacc*P[15][5]*SH_ACCX[3] - Kacc*P[6][5]*(2*q0*q2 - 2*q1*q3) + Kacc*P[0][5]*(2*SH_ACCX[1]*q0 + 2*SH_ACCX[2]*q3 - 2*q2*vd) + Kacc*P[1][5]*(2*SH_ACCX[1]*q1 + 2*SH_ACCX[2]*q2 + 2*q3*vd) - Kacc*P[2][5]*(2*SH_ACCX[1]*q2 - 2*SH_ACCX[2]*q1 + 2*q0*vd) + Kacc*P[3][5]*(2*SH_ACCX[2]*q0 - 2*SH_ACCX[1]*q3 + 2*q1*vd)) - Kacc*SH_ACCX[0]*(Kacc*P[4][14]*SH_ACCX[0] + Kacc*P[5][14]*SH_ACCX[3] - Kacc*P[14][14]*SH_ACCX[0] - Kacc*P[15][14]*SH_ACCX[3] - Kacc*P[6][14]*(2*q0*q2 - 2*q1*q3) + Kacc*P[0][14]*(2*SH_ACCX[1]*q0 + 2*SH_ACCX[2]*q3 - 2*q2*vd) + Kacc*P[1][14]*(2*SH_ACCX[1]*q1 + 2*SH_ACCX[2]*q2 + 2*q3*vd) - Kacc*P[2][14]*(2*SH_ACCX[1]*q2 - 2*SH_ACCX[2]*q1 + 2*q0*vd) + Kacc*P[3][14]*(2*SH_ACCX[2]*q0 - 2*SH_ACCX[1]*q3 + 2*q1*vd)) - Kacc*SH_ACCX[3]*(Kacc*P[4][15]*SH_ACCX[0] + Kacc*P[5][15]*SH_ACCX[3] - Kacc*P[14][15]*SH_ACCX[0] - Kacc*P[15][15]*SH_ACCX[3] - Kacc*P[6][15]*(2*q0*q2 - 2*q1*q3) + Kacc*P[0][15]*(2*SH_ACCX[1]*q0 + 2*SH_ACCX[2]*q3 - 2*q2*vd) + Kacc*P[1][15]*(2*SH_ACCX[1]*q1 + 2*SH_ACCX[2]*q2 + 2*q3*vd) - Kacc*P[2][15]*(2*SH_ACCX[1]*q2 - 2*SH_ACCX[2]*q1 + 2*q0*vd) + Kacc*P[3][15]*(2*SH_ACCX[2]*q0 - 2*SH_ACCX[1]*q3 + 2*q1*vd)) - Kacc*(2*q0*q2 - 2*q1*q3)*(Kacc*P[4][6]*SH_ACCX[0] + Kacc*P[5][6]*SH_ACCX[3] - Kacc*P[14][6]*SH_ACCX[0] - Kacc*P[15][6]*SH_ACCX[3] - Kacc*P[6][6]*(2*q0*q2 - 2*q1*q3) + Kacc*P[0][6]*(2*SH_ACCX[1]*q0 + 2*SH_ACCX[2]*q3 - 2*q2*vd) + Kacc*P[1][6]*(2*SH_ACCX[1]*q1 + 2*SH_ACCX[2]*q2 + 2*q3*vd) - Kacc*P[2][6]*(2*SH_ACCX[1]*q2 - 2*SH_ACCX[2]*q1 + 2*q0*vd) + Kacc*P[3][6]*(2*SH_ACCX[2]*q0 - 2*SH_ACCX[1]*q3 + 2*q1*vd)) + Kacc*(2*SH_ACCX[1]*q0 + 2*SH_ACCX[2]*q3 - 2*q2*vd)*(Kacc*P[4][0]*SH_ACCX[0] + Kacc*P[5][0]*SH_ACCX[3] - Kacc*P[14][0]*SH_ACCX[0] - Kacc*P[15][0]*SH_ACCX[3] - Kacc*P[6][0]*(2*q0*q2 - 2*q1*q3) + Kacc*P[0][0]*(2*SH_ACCX[1]*q0 + 2*SH_ACCX[2]*q3 - 2*q2*vd) + Kacc*P[1][0]*(2*SH_ACCX[1]*q1 + 2*SH_ACCX[2]*q2 + 2*q3*vd) - Kacc*P[2][0]*(2*SH_ACCX[1]*q2 - 2*SH_ACCX[2]*q1 + 2*q0*vd) + Kacc*P[3][0]*(2*SH_ACCX[2]*q0 - 2*SH_ACCX[1]*q3 + 2*q1*vd)) + Kacc*(2*SH_ACCX[1]*q1 + 2*SH_ACCX[2]*q2 + 2*q3*vd)*(Kacc*P[4][1]*SH_ACCX[0] + Kacc*P[5][1]*SH_ACCX[3] - Kacc*P[14][1]*SH_ACCX[0] - Kacc*P[15][1]*SH_ACCX[3] - Kacc*P[6][1]*(2*q0*q2 - 2*q1*q3) + Kacc*P[0][1]*(2*SH_ACCX[1]*q0 + 2*SH_ACCX[2]*q3 - 2*q2*vd) + Kacc*P[1][1]*(2*SH_ACCX[1]*q1 + 2*SH_ACCX[2]*q2 + 2*q3*vd) - Kacc*P[2][1]*(2*SH_ACCX[1]*q2 - 2*SH_ACCX[2]*q1 + 2*q0*vd) + Kacc*P[3][1]*(2*SH_ACCX[2]*q0 - 2*SH_ACCX[1]*q3 + 2*q1*vd)) - Kacc*(2*SH_ACCX[1]*q2 - 2*SH_ACCX[2]*q1 + 2*q0*vd)*(Kacc*P[4][2]*SH_ACCX[0] + Kacc*P[5][2]*SH_ACCX[3] - Kacc*P[14][2]*SH_ACCX[0] - Kacc*P[15][2]*SH_ACCX[3] - Kacc*P[6][2]*(2*q0*q2 - 2*q1*q3) + Kacc*P[0][2]*(2*SH_ACCX[1]*q0 + 2*SH_ACCX[2]*q3 - 2*q2*vd) + Kacc*P[1][2]*(2*SH_ACCX[1]*q1 + 2*SH_ACCX[2]*q2 + 2*q3*vd) - Kacc*P[2][2]*(2*SH_ACCX[1]*q2 - 2*SH_ACCX[2]*q1 + 2*q0*vd) + Kacc*P[3][2]*(2*SH_ACCX[2]*q0 - 2*SH_ACCX[1]*q3 + 2*q1*vd)) + Kacc*(2*SH_ACCX[2]*q0 - 2*SH_ACCX[1]*q3 + 2*q1*vd)*(Kacc*P[4][3]*SH_ACCX[0] + Kacc*P[5][3]*SH_ACCX[3] - Kacc*P[14][3]*SH_ACCX[0] - Kacc*P[15][3]*SH_ACCX[3] - Kacc*P[6][3]*(2*q0*q2 - 2*q1*q3) + Kacc*P[0][3]*(2*SH_ACCX[1]*q0 + 2*SH_ACCX[2]*q3 - 2*q2*vd) + Kacc*P[1][3]*(2*SH_ACCX[1]*q1 + 2*SH_ACCX[2]*q2 + 2*q3*vd) - Kacc*P[2][3]*(2*SH_ACCX[1]*q2 - 2*SH_ACCX[2]*q1 + 2*q0*vd) + Kacc*P[3][3]*(2*SH_ACCX[2]*q0 - 2*SH_ACCX[1]*q3 + 2*q1*vd)));
SK_ACCX[1] = 2*SH_ACCX[2]*q0 - 2*SH_ACCX[1]*q3 + 2*q1*vd;
SK_ACCX[2] = 2*SH_ACCX[1]*q2 - 2*SH_ACCX[2]*q1 + 2*q0*vd;
SK_ACCX[3] = 2*SH_ACCX[1]*q0 + 2*SH_ACCX[2]*q3 - 2*q2*vd;
SK_ACCX[4] = 2*SH_ACCX[1]*q1 + 2*SH_ACCX[2]*q2 + 2*q3*vd;
SK_ACCX[5] = 2*q0*q2 - 2*q1*q3;
float Kfusion[22][1];
float Kfusion[1][1];
Kfusion[0] = -SK_ACCX[0]*(Kacc*P[0][4]*SH_ACCX[0] + Kacc*P[0][5]*SH_ACCX[3] - Kacc*P[0][14]*SH_ACCX[0] - Kacc*P[0][15]*SH_ACCX[3] + Kacc*P[0][0]*SK_ACCX[3] - Kacc*P[0][2]*SK_ACCX[2] + Kacc*P[0][3]*SK_ACCX[1] + Kacc*P[0][1]*SK_ACCX[4] - Kacc*P[0][6]*SK_ACCX[5]);
Kfusion[1] = -SK_ACCX[0]*(Kacc*P[1][4]*SH_ACCX[0] + Kacc*P[1][5]*SH_ACCX[3] - Kacc*P[1][14]*SH_ACCX[0] - Kacc*P[1][15]*SH_ACCX[3] + Kacc*P[1][0]*SK_ACCX[3] - Kacc*P[1][2]*SK_ACCX[2] + Kacc*P[1][3]*SK_ACCX[1] + Kacc*P[1][1]*SK_ACCX[4] - Kacc*P[1][6]*SK_ACCX[5]);
Kfusion[2] = -SK_ACCX[0]*(Kacc*P[2][4]*SH_ACCX[0] + Kacc*P[2][5]*SH_ACCX[3] - Kacc*P[2][14]*SH_ACCX[0] - Kacc*P[2][15]*SH_ACCX[3] + Kacc*P[2][0]*SK_ACCX[3] - Kacc*P[2][2]*SK_ACCX[2] + Kacc*P[2][3]*SK_ACCX[1] + Kacc*P[2][1]*SK_ACCX[4] - Kacc*P[2][6]*SK_ACCX[5]);
Kfusion[3] = -SK_ACCX[0]*(Kacc*P[3][4]*SH_ACCX[0] + Kacc*P[3][5]*SH_ACCX[3] - Kacc*P[3][14]*SH_ACCX[0] - Kacc*P[3][15]*SH_ACCX[3] + Kacc*P[3][0]*SK_ACCX[3] - Kacc*P[3][2]*SK_ACCX[2] + Kacc*P[3][3]*SK_ACCX[1] + Kacc*P[3][1]*SK_ACCX[4] - Kacc*P[3][6]*SK_ACCX[5]);
Kfusion[4] = -SK_ACCX[0]*(Kacc*P[4][4]*SH_ACCX[0] + Kacc*P[4][5]*SH_ACCX[3] - Kacc*P[4][14]*SH_ACCX[0] - Kacc*P[4][15]*SH_ACCX[3] + Kacc*P[4][0]*SK_ACCX[3] - Kacc*P[4][2]*SK_ACCX[2] + Kacc*P[4][3]*SK_ACCX[1] + Kacc*P[4][1]*SK_ACCX[4] - Kacc*P[4][6]*SK_ACCX[5]);
Kfusion[5] = -SK_ACCX[0]*(Kacc*P[5][4]*SH_ACCX[0] + Kacc*P[5][5]*SH_ACCX[3] - Kacc*P[5][14]*SH_ACCX[0] - Kacc*P[5][15]*SH_ACCX[3] + Kacc*P[5][0]*SK_ACCX[3] - Kacc*P[5][2]*SK_ACCX[2] + Kacc*P[5][3]*SK_ACCX[1] + Kacc*P[5][1]*SK_ACCX[4] - Kacc*P[5][6]*SK_ACCX[5]);
Kfusion[6] = -SK_ACCX[0]*(Kacc*P[6][4]*SH_ACCX[0] + Kacc*P[6][5]*SH_ACCX[3] - Kacc*P[6][14]*SH_ACCX[0] - Kacc*P[6][15]*SH_ACCX[3] + Kacc*P[6][0]*SK_ACCX[3] - Kacc*P[6][2]*SK_ACCX[2] + Kacc*P[6][3]*SK_ACCX[1] + Kacc*P[6][1]*SK_ACCX[4] - Kacc*P[6][6]*SK_ACCX[5]);
Kfusion[7] = -SK_ACCX[0]*(Kacc*P[7][4]*SH_ACCX[0] + Kacc*P[7][5]*SH_ACCX[3] - Kacc*P[7][14]*SH_ACCX[0] - Kacc*P[7][15]*SH_ACCX[3] + Kacc*P[7][0]*SK_ACCX[3] - Kacc*P[7][2]*SK_ACCX[2] + Kacc*P[7][3]*SK_ACCX[1] + Kacc*P[7][1]*SK_ACCX[4] - Kacc*P[7][6]*SK_ACCX[5]);
Kfusion[8] = -SK_ACCX[0]*(Kacc*P[8][4]*SH_ACCX[0] + Kacc*P[8][5]*SH_ACCX[3] - Kacc*P[8][14]*SH_ACCX[0] - Kacc*P[8][15]*SH_ACCX[3] + Kacc*P[8][0]*SK_ACCX[3] - Kacc*P[8][2]*SK_ACCX[2] + Kacc*P[8][3]*SK_ACCX[1] + Kacc*P[8][1]*SK_ACCX[4] - Kacc*P[8][6]*SK_ACCX[5]);
Kfusion[9] = -SK_ACCX[0]*(Kacc*P[9][4]*SH_ACCX[0] + Kacc*P[9][5]*SH_ACCX[3] - Kacc*P[9][14]*SH_ACCX[0] - Kacc*P[9][15]*SH_ACCX[3] + Kacc*P[9][0]*SK_ACCX[3] - Kacc*P[9][2]*SK_ACCX[2] + Kacc*P[9][3]*SK_ACCX[1] + Kacc*P[9][1]*SK_ACCX[4] - Kacc*P[9][6]*SK_ACCX[5]);
Kfusion[10] = -SK_ACCX[0]*(Kacc*P[10][4]*SH_ACCX[0] + Kacc*P[10][5]*SH_ACCX[3] - Kacc*P[10][14]*SH_ACCX[0] - Kacc*P[10][15]*SH_ACCX[3] + Kacc*P[10][0]*SK_ACCX[3] - Kacc*P[10][2]*SK_ACCX[2] + Kacc*P[10][3]*SK_ACCX[1] + Kacc*P[10][1]*SK_ACCX[4] - Kacc*P[10][6]*SK_ACCX[5]);
Kfusion[11] = -SK_ACCX[0]*(Kacc*P[11][4]*SH_ACCX[0] + Kacc*P[11][5]*SH_ACCX[3] - Kacc*P[11][14]*SH_ACCX[0] - Kacc*P[11][15]*SH_ACCX[3] + Kacc*P[11][0]*SK_ACCX[3] - Kacc*P[11][2]*SK_ACCX[2] + Kacc*P[11][3]*SK_ACCX[1] + Kacc*P[11][1]*SK_ACCX[4] - Kacc*P[11][6]*SK_ACCX[5]);
Kfusion[12] = -SK_ACCX[0]*(Kacc*P[12][4]*SH_ACCX[0] + Kacc*P[12][5]*SH_ACCX[3] - Kacc*P[12][14]*SH_ACCX[0] - Kacc*P[12][15]*SH_ACCX[3] + Kacc*P[12][0]*SK_ACCX[3] - Kacc*P[12][2]*SK_ACCX[2] + Kacc*P[12][3]*SK_ACCX[1] + Kacc*P[12][1]*SK_ACCX[4] - Kacc*P[12][6]*SK_ACCX[5]);
Kfusion[13] = -SK_ACCX[0]*(Kacc*P[13][4]*SH_ACCX[0] + Kacc*P[13][5]*SH_ACCX[3] - Kacc*P[13][14]*SH_ACCX[0] - Kacc*P[13][15]*SH_ACCX[3] + Kacc*P[13][0]*SK_ACCX[3] - Kacc*P[13][2]*SK_ACCX[2] + Kacc*P[13][3]*SK_ACCX[1] + Kacc*P[13][1]*SK_ACCX[4] - Kacc*P[13][6]*SK_ACCX[5]);
Kfusion[14] = -SK_ACCX[0]*(Kacc*P[14][4]*SH_ACCX[0] + Kacc*P[14][5]*SH_ACCX[3] - Kacc*P[14][14]*SH_ACCX[0] - Kacc*P[14][15]*SH_ACCX[3] + Kacc*P[14][0]*SK_ACCX[3] - Kacc*P[14][2]*SK_ACCX[2] + Kacc*P[14][3]*SK_ACCX[1] + Kacc*P[14][1]*SK_ACCX[4] - Kacc*P[14][6]*SK_ACCX[5]);
Kfusion[15] = -SK_ACCX[0]*(Kacc*P[15][4]*SH_ACCX[0] + Kacc*P[15][5]*SH_ACCX[3] - Kacc*P[15][14]*SH_ACCX[0] - Kacc*P[15][15]*SH_ACCX[3] + Kacc*P[15][0]*SK_ACCX[3] - Kacc*P[15][2]*SK_ACCX[2] + Kacc*P[15][3]*SK_ACCX[1] + Kacc*P[15][1]*SK_ACCX[4] - Kacc*P[15][6]*SK_ACCX[5]);
Kfusion[16] = -SK_ACCX[0]*(Kacc*P[16][4]*SH_ACCX[0] + Kacc*P[16][5]*SH_ACCX[3] - Kacc*P[16][14]*SH_ACCX[0] - Kacc*P[16][15]*SH_ACCX[3] + Kacc*P[16][0]*SK_ACCX[3] - Kacc*P[16][2]*SK_ACCX[2] + Kacc*P[16][3]*SK_ACCX[1] + Kacc*P[16][1]*SK_ACCX[4] - Kacc*P[16][6]*SK_ACCX[5]);
Kfusion[17] = -SK_ACCX[0]*(Kacc*P[17][4]*SH_ACCX[0] + Kacc*P[17][5]*SH_ACCX[3] - Kacc*P[17][14]*SH_ACCX[0] - Kacc*P[17][15]*SH_ACCX[3] + Kacc*P[17][0]*SK_ACCX[3] - Kacc*P[17][2]*SK_ACCX[2] + Kacc*P[17][3]*SK_ACCX[1] + Kacc*P[17][1]*SK_ACCX[4] - Kacc*P[17][6]*SK_ACCX[5]);
Kfusion[18] = -SK_ACCX[0]*(Kacc*P[18][4]*SH_ACCX[0] + Kacc*P[18][5]*SH_ACCX[3] - Kacc*P[18][14]*SH_ACCX[0] - Kacc*P[18][15]*SH_ACCX[3] + Kacc*P[18][0]*SK_ACCX[3] - Kacc*P[18][2]*SK_ACCX[2] + Kacc*P[18][3]*SK_ACCX[1] + Kacc*P[18][1]*SK_ACCX[4] - Kacc*P[18][6]*SK_ACCX[5]);
Kfusion[19] = -SK_ACCX[0]*(Kacc*P[19][4]*SH_ACCX[0] + Kacc*P[19][5]*SH_ACCX[3] - Kacc*P[19][14]*SH_ACCX[0] - Kacc*P[19][15]*SH_ACCX[3] + Kacc*P[19][0]*SK_ACCX[3] - Kacc*P[19][2]*SK_ACCX[2] + Kacc*P[19][3]*SK_ACCX[1] + Kacc*P[19][1]*SK_ACCX[4] - Kacc*P[19][6]*SK_ACCX[5]);
Kfusion[20] = -SK_ACCX[0]*(Kacc*P[20][4]*SH_ACCX[0] + Kacc*P[20][5]*SH_ACCX[3] - Kacc*P[20][14]*SH_ACCX[0] - Kacc*P[20][15]*SH_ACCX[3] + Kacc*P[20][0]*SK_ACCX[3] - Kacc*P[20][2]*SK_ACCX[2] + Kacc*P[20][3]*SK_ACCX[1] + Kacc*P[20][1]*SK_ACCX[4] - Kacc*P[20][6]*SK_ACCX[5]);
Kfusion[21] = -SK_ACCX[0]*(Kacc*P[21][4]*SH_ACCX[0] + Kacc*P[21][5]*SH_ACCX[3] - Kacc*P[21][14]*SH_ACCX[0] - Kacc*P[21][15]*SH_ACCX[3] + Kacc*P[21][0]*SK_ACCX[3] - Kacc*P[21][2]*SK_ACCX[2] + Kacc*P[21][3]*SK_ACCX[1] + Kacc*P[21][1]*SK_ACCX[4] - Kacc*P[21][6]*SK_ACCX[5]);
float SH_ACCY[4][1];
SH_ACCY[0] = sq(q0) - sq(q1) + sq(q2) - sq(q3);
SH_ACCY[1] = vn - vwn;
SH_ACCY[2] = ve - vwe;
SH_ACCY[3] = Kacc*(2*q0*q3 - 2*q1*q2);
float H_ACCY[1][22];
H_ACCY[0][0] = -Kacc*(2*SH_ACCY[2]*q0 - 2*SH_ACCY[1]*q3 + 2*q1*vd);
H_ACCY[0][1] = -Kacc*(2*SH_ACCY[1]*q2 - 2*SH_ACCY[2]*q1 + 2*q0*vd);
H_ACCY[0][2] = -Kacc*(2*SH_ACCY[1]*q1 + 2*SH_ACCY[2]*q2 + 2*q3*vd);
H_ACCY[0][3] = Kacc*(2*SH_ACCY[1]*q0 + 2*SH_ACCY[2]*q3 - 2*q2*vd);
H_ACCY[0][4] = SH_ACCY[3];
H_ACCY[0][5] = -Kacc*SH_ACCY[0];
H_ACCY[0][6] = -Kacc*(2*q0*q1 + 2*q2*q3);
H_ACCY[0][14] = -SH_ACCY[3];
H_ACCY[0][15] = Kacc*SH_ACCY[0];
float SK_ACCY[6][1];
SK_ACCY[0] = 1/(R_ACC - SH_ACCY[3]*(P[14][4]*SH_ACCY[3] - P[4][4]*SH_ACCY[3] + Kacc*P[5][4]*SH_ACCY[0] - Kacc*P[15][4]*SH_ACCY[0] + Kacc*P[6][4]*(2*q0*q1 + 2*q2*q3) + Kacc*P[0][4]*(2*SH_ACCY[2]*q0 - 2*SH_ACCY[1]*q3 + 2*q1*vd) + Kacc*P[1][4]*(2*SH_ACCY[1]*q2 - 2*SH_ACCY[2]*q1 + 2*q0*vd) + Kacc*P[2][4]*(2*SH_ACCY[1]*q1 + 2*SH_ACCY[2]*q2 + 2*q3*vd) - Kacc*P[3][4]*(2*SH_ACCY[1]*q0 + 2*SH_ACCY[2]*q3 - 2*q2*vd)) + SH_ACCY[3]*(P[14][14]*SH_ACCY[3] - P[4][14]*SH_ACCY[3] + Kacc*P[5][14]*SH_ACCY[0] - Kacc*P[15][14]*SH_ACCY[0] + Kacc*P[6][14]*(2*q0*q1 + 2*q2*q3) + Kacc*P[0][14]*(2*SH_ACCY[2]*q0 - 2*SH_ACCY[1]*q3 + 2*q1*vd) + Kacc*P[1][14]*(2*SH_ACCY[1]*q2 - 2*SH_ACCY[2]*q1 + 2*q0*vd) + Kacc*P[2][14]*(2*SH_ACCY[1]*q1 + 2*SH_ACCY[2]*q2 + 2*q3*vd) - Kacc*P[3][14]*(2*SH_ACCY[1]*q0 + 2*SH_ACCY[2]*q3 - 2*q2*vd)) + Kacc*(2*q0*q1 + 2*q2*q3)*(P[14][6]*SH_ACCY[3] - P[4][6]*SH_ACCY[3] + Kacc*P[5][6]*SH_ACCY[0] - Kacc*P[15][6]*SH_ACCY[0] + Kacc*P[6][6]*(2*q0*q1 + 2*q2*q3) + Kacc*P[0][6]*(2*SH_ACCY[2]*q0 - 2*SH_ACCY[1]*q3 + 2*q1*vd) + Kacc*P[1][6]*(2*SH_ACCY[1]*q2 - 2*SH_ACCY[2]*q1 + 2*q0*vd) + Kacc*P[2][6]*(2*SH_ACCY[1]*q1 + 2*SH_ACCY[2]*q2 + 2*q3*vd) - Kacc*P[3][6]*(2*SH_ACCY[1]*q0 + 2*SH_ACCY[2]*q3 - 2*q2*vd)) + Kacc*(2*SH_ACCY[2]*q0 - 2*SH_ACCY[1]*q3 + 2*q1*vd)*(P[14][0]*SH_ACCY[3] - P[4][0]*SH_ACCY[3] + Kacc*P[5][0]*SH_ACCY[0] - Kacc*P[15][0]*SH_ACCY[0] + Kacc*P[6][0]*(2*q0*q1 + 2*q2*q3) + Kacc*P[0][0]*(2*SH_ACCY[2]*q0 - 2*SH_ACCY[1]*q3 + 2*q1*vd) + Kacc*P[1][0]*(2*SH_ACCY[1]*q2 - 2*SH_ACCY[2]*q1 + 2*q0*vd) + Kacc*P[2][0]*(2*SH_ACCY[1]*q1 + 2*SH_ACCY[2]*q2 + 2*q3*vd) - Kacc*P[3][0]*(2*SH_ACCY[1]*q0 + 2*SH_ACCY[2]*q3 - 2*q2*vd)) + Kacc*(2*SH_ACCY[1]*q2 - 2*SH_ACCY[2]*q1 + 2*q0*vd)*(P[14][1]*SH_ACCY[3] - P[4][1]*SH_ACCY[3] + Kacc*P[5][1]*SH_ACCY[0] - Kacc*P[15][1]*SH_ACCY[0] + Kacc*P[6][1]*(2*q0*q1 + 2*q2*q3) + Kacc*P[0][1]*(2*SH_ACCY[2]*q0 - 2*SH_ACCY[1]*q3 + 2*q1*vd) + Kacc*P[1][1]*(2*SH_ACCY[1]*q2 - 2*SH_ACCY[2]*q1 + 2*q0*vd) + Kacc*P[2][1]*(2*SH_ACCY[1]*q1 + 2*SH_ACCY[2]*q2 + 2*q3*vd) - Kacc*P[3][1]*(2*SH_ACCY[1]*q0 + 2*SH_ACCY[2]*q3 - 2*q2*vd)) + Kacc*(2*SH_ACCY[1]*q1 + 2*SH_ACCY[2]*q2 + 2*q3*vd)*(P[14][2]*SH_ACCY[3] - P[4][2]*SH_ACCY[3] + Kacc*P[5][2]*SH_ACCY[0] - Kacc*P[15][2]*SH_ACCY[0] + Kacc*P[6][2]*(2*q0*q1 + 2*q2*q3) + Kacc*P[0][2]*(2*SH_ACCY[2]*q0 - 2*SH_ACCY[1]*q3 + 2*q1*vd) + Kacc*P[1][2]*(2*SH_ACCY[1]*q2 - 2*SH_ACCY[2]*q1 + 2*q0*vd) + Kacc*P[2][2]*(2*SH_ACCY[1]*q1 + 2*SH_ACCY[2]*q2 + 2*q3*vd) - Kacc*P[3][2]*(2*SH_ACCY[1]*q0 + 2*SH_ACCY[2]*q3 - 2*q2*vd)) - Kacc*(2*SH_ACCY[1]*q0 + 2*SH_ACCY[2]*q3 - 2*q2*vd)*(P[14][3]*SH_ACCY[3] - P[4][3]*SH_ACCY[3] + Kacc*P[5][3]*SH_ACCY[0] - Kacc*P[15][3]*SH_ACCY[0] + Kacc*P[6][3]*(2*q0*q1 + 2*q2*q3) + Kacc*P[0][3]*(2*SH_ACCY[2]*q0 - 2*SH_ACCY[1]*q3 + 2*q1*vd) + Kacc*P[1][3]*(2*SH_ACCY[1]*q2 - 2*SH_ACCY[2]*q1 + 2*q0*vd) + Kacc*P[2][3]*(2*SH_ACCY[1]*q1 + 2*SH_ACCY[2]*q2 + 2*q3*vd) - Kacc*P[3][3]*(2*SH_ACCY[1]*q0 + 2*SH_ACCY[2]*q3 - 2*q2*vd)) + Kacc*SH_ACCY[0]*(P[14][5]*SH_ACCY[3] - P[4][5]*SH_ACCY[3] + Kacc*P[5][5]*SH_ACCY[0] - Kacc*P[15][5]*SH_ACCY[0] + Kacc*P[6][5]*(2*q0*q1 + 2*q2*q3) + Kacc*P[0][5]*(2*SH_ACCY[2]*q0 - 2*SH_ACCY[1]*q3 + 2*q1*vd) + Kacc*P[1][5]*(2*SH_ACCY[1]*q2 - 2*SH_ACCY[2]*q1 + 2*q0*vd) + Kacc*P[2][5]*(2*SH_ACCY[1]*q1 + 2*SH_ACCY[2]*q2 + 2*q3*vd) - Kacc*P[3][5]*(2*SH_ACCY[1]*q0 + 2*SH_ACCY[2]*q3 - 2*q2*vd)) - Kacc*SH_ACCY[0]*(P[14][15]*SH_ACCY[3] - P[4][15]*SH_ACCY[3] + Kacc*P[5][15]*SH_ACCY[0] - Kacc*P[15][15]*SH_ACCY[0] + Kacc*P[6][15]*(2*q0*q1 + 2*q2*q3) + Kacc*P[0][15]*(2*SH_ACCY[2]*q0 - 2*SH_ACCY[1]*q3 + 2*q1*vd) + Kacc*P[1][15]*(2*SH_ACCY[1]*q2 - 2*SH_ACCY[2]*q1 + 2*q0*vd) + Kacc*P[2][15]*(2*SH_ACCY[1]*q1 + 2*SH_ACCY[2]*q2 + 2*q3*vd) - Kacc*P[3][15]*(2*SH_ACCY[1]*q0 + 2*SH_ACCY[2]*q3 - 2*q2*vd)));
SK_ACCY[1] = 2*SH_ACCY[1]*q0 + 2*SH_ACCY[2]*q3 - 2*q2*vd;
SK_ACCY[2] = 2*SH_ACCY[1]*q2 - 2*SH_ACCY[2]*q1 + 2*q0*vd;
SK_ACCY[3] = 2*SH_ACCY[2]*q0 - 2*SH_ACCY[1]*q3 + 2*q1*vd;
SK_ACCY[4] = 2*SH_ACCY[1]*q1 + 2*SH_ACCY[2]*q2 + 2*q3*vd;
SK_ACCY[5] = 2*q0*q1 + 2*q2*q3;
float Kfusion[22][1];
float Kfusion[1][1];
Kfusion[0] = -SK_ACCY[0]*(P[0][14]*SH_ACCY[3] - P[0][4]*SH_ACCY[3] + Kacc*P[0][5]*SH_ACCY[0] - Kacc*P[0][15]*SH_ACCY[0] + Kacc*P[0][0]*SK_ACCY[3] + Kacc*P[0][1]*SK_ACCY[2] - Kacc*P[0][3]*SK_ACCY[1] + Kacc*P[0][2]*SK_ACCY[4] + Kacc*P[0][6]*SK_ACCY[5]);
Kfusion[1] = -SK_ACCY[0]*(P[1][14]*SH_ACCY[3] - P[1][4]*SH_ACCY[3] + Kacc*P[1][5]*SH_ACCY[0] - Kacc*P[1][15]*SH_ACCY[0] + Kacc*P[1][0]*SK_ACCY[3] + Kacc*P[1][1]*SK_ACCY[2] - Kacc*P[1][3]*SK_ACCY[1] + Kacc*P[1][2]*SK_ACCY[4] + Kacc*P[1][6]*SK_ACCY[5]);
Kfusion[2] = -SK_ACCY[0]*(P[2][14]*SH_ACCY[3] - P[2][4]*SH_ACCY[3] + Kacc*P[2][5]*SH_ACCY[0] - Kacc*P[2][15]*SH_ACCY[0] + Kacc*P[2][0]*SK_ACCY[3] + Kacc*P[2][1]*SK_ACCY[2] - Kacc*P[2][3]*SK_ACCY[1] + Kacc*P[2][2]*SK_ACCY[4] + Kacc*P[2][6]*SK_ACCY[5]);
Kfusion[3] = -SK_ACCY[0]*(P[3][14]*SH_ACCY[3] - P[3][4]*SH_ACCY[3] + Kacc*P[3][5]*SH_ACCY[0] - Kacc*P[3][15]*SH_ACCY[0] + Kacc*P[3][0]*SK_ACCY[3] + Kacc*P[3][1]*SK_ACCY[2] - Kacc*P[3][3]*SK_ACCY[1] + Kacc*P[3][2]*SK_ACCY[4] + Kacc*P[3][6]*SK_ACCY[5]);
Kfusion[4] = -SK_ACCY[0]*(P[4][14]*SH_ACCY[3] - P[4][4]*SH_ACCY[3] + Kacc*P[4][5]*SH_ACCY[0] - Kacc*P[4][15]*SH_ACCY[0] + Kacc*P[4][0]*SK_ACCY[3] + Kacc*P[4][1]*SK_ACCY[2] - Kacc*P[4][3]*SK_ACCY[1] + Kacc*P[4][2]*SK_ACCY[4] + Kacc*P[4][6]*SK_ACCY[5]);
Kfusion[5] = -SK_ACCY[0]*(P[5][14]*SH_ACCY[3] - P[5][4]*SH_ACCY[3] + Kacc*P[5][5]*SH_ACCY[0] - Kacc*P[5][15]*SH_ACCY[0] + Kacc*P[5][0]*SK_ACCY[3] + Kacc*P[5][1]*SK_ACCY[2] - Kacc*P[5][3]*SK_ACCY[1] + Kacc*P[5][2]*SK_ACCY[4] + Kacc*P[5][6]*SK_ACCY[5]);
Kfusion[6] = -SK_ACCY[0]*(P[6][14]*SH_ACCY[3] - P[6][4]*SH_ACCY[3] + Kacc*P[6][5]*SH_ACCY[0] - Kacc*P[6][15]*SH_ACCY[0] + Kacc*P[6][0]*SK_ACCY[3] + Kacc*P[6][1]*SK_ACCY[2] - Kacc*P[6][3]*SK_ACCY[1] + Kacc*P[6][2]*SK_ACCY[4] + Kacc*P[6][6]*SK_ACCY[5]);
Kfusion[7] = -SK_ACCY[0]*(P[7][14]*SH_ACCY[3] - P[7][4]*SH_ACCY[3] + Kacc*P[7][5]*SH_ACCY[0] - Kacc*P[7][15]*SH_ACCY[0] + Kacc*P[7][0]*SK_ACCY[3] + Kacc*P[7][1]*SK_ACCY[2] - Kacc*P[7][3]*SK_ACCY[1] + Kacc*P[7][2]*SK_ACCY[4] + Kacc*P[7][6]*SK_ACCY[5]);
Kfusion[8] = -SK_ACCY[0]*(P[8][14]*SH_ACCY[3] - P[8][4]*SH_ACCY[3] + Kacc*P[8][5]*SH_ACCY[0] - Kacc*P[8][15]*SH_ACCY[0] + Kacc*P[8][0]*SK_ACCY[3] + Kacc*P[8][1]*SK_ACCY[2] - Kacc*P[8][3]*SK_ACCY[1] + Kacc*P[8][2]*SK_ACCY[4] + Kacc*P[8][6]*SK_ACCY[5]);
Kfusion[9] = -SK_ACCY[0]*(P[9][14]*SH_ACCY[3] - P[9][4]*SH_ACCY[3] + Kacc*P[9][5]*SH_ACCY[0] - Kacc*P[9][15]*SH_ACCY[0] + Kacc*P[9][0]*SK_ACCY[3] + Kacc*P[9][1]*SK_ACCY[2] - Kacc*P[9][3]*SK_ACCY[1] + Kacc*P[9][2]*SK_ACCY[4] + Kacc*P[9][6]*SK_ACCY[5]);
Kfusion[10] = -SK_ACCY[0]*(P[10][14]*SH_ACCY[3] - P[10][4]*SH_ACCY[3] + Kacc*P[10][5]*SH_ACCY[0] - Kacc*P[10][15]*SH_ACCY[0] + Kacc*P[10][0]*SK_ACCY[3] + Kacc*P[10][1]*SK_ACCY[2] - Kacc*P[10][3]*SK_ACCY[1] + Kacc*P[10][2]*SK_ACCY[4] + Kacc*P[10][6]*SK_ACCY[5]);
Kfusion[11] = -SK_ACCY[0]*(P[11][14]*SH_ACCY[3] - P[11][4]*SH_ACCY[3] + Kacc*P[11][5]*SH_ACCY[0] - Kacc*P[11][15]*SH_ACCY[0] + Kacc*P[11][0]*SK_ACCY[3] + Kacc*P[11][1]*SK_ACCY[2] - Kacc*P[11][3]*SK_ACCY[1] + Kacc*P[11][2]*SK_ACCY[4] + Kacc*P[11][6]*SK_ACCY[5]);
Kfusion[12] = -SK_ACCY[0]*(P[12][14]*SH_ACCY[3] - P[12][4]*SH_ACCY[3] + Kacc*P[12][5]*SH_ACCY[0] - Kacc*P[12][15]*SH_ACCY[0] + Kacc*P[12][0]*SK_ACCY[3] + Kacc*P[12][1]*SK_ACCY[2] - Kacc*P[12][3]*SK_ACCY[1] + Kacc*P[12][2]*SK_ACCY[4] + Kacc*P[12][6]*SK_ACCY[5]);
Kfusion[13] = -SK_ACCY[0]*(P[13][14]*SH_ACCY[3] - P[13][4]*SH_ACCY[3] + Kacc*P[13][5]*SH_ACCY[0] - Kacc*P[13][15]*SH_ACCY[0] + Kacc*P[13][0]*SK_ACCY[3] + Kacc*P[13][1]*SK_ACCY[2] - Kacc*P[13][3]*SK_ACCY[1] + Kacc*P[13][2]*SK_ACCY[4] + Kacc*P[13][6]*SK_ACCY[5]);
Kfusion[14] = -SK_ACCY[0]*(P[14][14]*SH_ACCY[3] - P[14][4]*SH_ACCY[3] + Kacc*P[14][5]*SH_ACCY[0] - Kacc*P[14][15]*SH_ACCY[0] + Kacc*P[14][0]*SK_ACCY[3] + Kacc*P[14][1]*SK_ACCY[2] - Kacc*P[14][3]*SK_ACCY[1] + Kacc*P[14][2]*SK_ACCY[4] + Kacc*P[14][6]*SK_ACCY[5]);
Kfusion[15] = -SK_ACCY[0]*(P[15][14]*SH_ACCY[3] - P[15][4]*SH_ACCY[3] + Kacc*P[15][5]*SH_ACCY[0] - Kacc*P[15][15]*SH_ACCY[0] + Kacc*P[15][0]*SK_ACCY[3] + Kacc*P[15][1]*SK_ACCY[2] - Kacc*P[15][3]*SK_ACCY[1] + Kacc*P[15][2]*SK_ACCY[4] + Kacc*P[15][6]*SK_ACCY[5]);
Kfusion[16] = -SK_ACCY[0]*(P[16][14]*SH_ACCY[3] - P[16][4]*SH_ACCY[3] + Kacc*P[16][5]*SH_ACCY[0] - Kacc*P[16][15]*SH_ACCY[0] + Kacc*P[16][0]*SK_ACCY[3] + Kacc*P[16][1]*SK_ACCY[2] - Kacc*P[16][3]*SK_ACCY[1] + Kacc*P[16][2]*SK_ACCY[4] + Kacc*P[16][6]*SK_ACCY[5]);
Kfusion[17] = -SK_ACCY[0]*(P[17][14]*SH_ACCY[3] - P[17][4]*SH_ACCY[3] + Kacc*P[17][5]*SH_ACCY[0] - Kacc*P[17][15]*SH_ACCY[0] + Kacc*P[17][0]*SK_ACCY[3] + Kacc*P[17][1]*SK_ACCY[2] - Kacc*P[17][3]*SK_ACCY[1] + Kacc*P[17][2]*SK_ACCY[4] + Kacc*P[17][6]*SK_ACCY[5]);
Kfusion[18] = -SK_ACCY[0]*(P[18][14]*SH_ACCY[3] - P[18][4]*SH_ACCY[3] + Kacc*P[18][5]*SH_ACCY[0] - Kacc*P[18][15]*SH_ACCY[0] + Kacc*P[18][0]*SK_ACCY[3] + Kacc*P[18][1]*SK_ACCY[2] - Kacc*P[18][3]*SK_ACCY[1] + Kacc*P[18][2]*SK_ACCY[4] + Kacc*P[18][6]*SK_ACCY[5]);
Kfusion[19] = -SK_ACCY[0]*(P[19][14]*SH_ACCY[3] - P[19][4]*SH_ACCY[3] + Kacc*P[19][5]*SH_ACCY[0] - Kacc*P[19][15]*SH_ACCY[0] + Kacc*P[19][0]*SK_ACCY[3] + Kacc*P[19][1]*SK_ACCY[2] - Kacc*P[19][3]*SK_ACCY[1] + Kacc*P[19][2]*SK_ACCY[4] + Kacc*P[19][6]*SK_ACCY[5]);
Kfusion[20] = -SK_ACCY[0]*(P[20][14]*SH_ACCY[3] - P[20][4]*SH_ACCY[3] + Kacc*P[20][5]*SH_ACCY[0] - Kacc*P[20][15]*SH_ACCY[0] + Kacc*P[20][0]*SK_ACCY[3] + Kacc*P[20][1]*SK_ACCY[2] - Kacc*P[20][3]*SK_ACCY[1] + Kacc*P[20][2]*SK_ACCY[4] + Kacc*P[20][6]*SK_ACCY[5]);
Kfusion[21] = -SK_ACCY[0]*(P[21][14]*SH_ACCY[3] - P[21][4]*SH_ACCY[3] + Kacc*P[21][5]*SH_ACCY[0] - Kacc*P[21][15]*SH_ACCY[0] + Kacc*P[21][0]*SK_ACCY[3] + Kacc*P[21][1]*SK_ACCY[2] - Kacc*P[21][3]*SK_ACCY[1] + Kacc*P[21][2]*SK_ACCY[4] + Kacc*P[21][6]*SK_ACCY[5]);
